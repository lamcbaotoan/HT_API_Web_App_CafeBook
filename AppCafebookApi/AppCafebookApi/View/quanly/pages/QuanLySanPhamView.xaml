<Page x:Class="AppCafebookApi.View.quanly.pages.QuanLySanPhamView"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
      xmlns:local="clr-namespace:AppCafebookApi.View.quanly.pages"
      mc:Ignorable="d" 
      d:DesignHeight="700" d:DesignWidth="1100"
      Title="QuanLySanPhamView"
      FontFamily="Segoe UI"
      Background="#FFF8E1"
      Loaded="Page_Loaded">

    <Page.Resources>
        <SolidColorBrush x:Key="PrimaryBrownBrush" Color="#6F4E37"/>
        <SolidColorBrush x:Key="DarkBrownBrush" Color="#4E342E"/>
        <SolidColorBrush x:Key="TextGrayBrush" Color="#757575"/>
        <SolidColorBrush x:Key="SuccessBrush" Color="#66BB6A"/>
        <SolidColorBrush x:Key="ErrorBrush" Color="#EF5350"/>
        <SolidColorBrush x:Key="BorderGrayBrush" Color="#BDBDBD"/>
        <SolidColorBrush x:Key="BackgroundHoverBrush" Color="#F5F5F5"/>
        <SolidColorBrush x:Key="BackgroundSelectedBrush" Color="#EFEBE9"/>
        <SolidColorBrush x:Key="SubtleGrayBrush" Color="#F5F5F5"/>
        <SolidColorBrush x:Key="WhiteTextBrush" Color="#FFFFFF"/>
        <SolidColorBrush x:Key="ActionGreenBrush" Color="#66BB6A"/>

        <Geometry x:Key="IconAdd">M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z</Geometry>
        <Geometry x:Key="IconSave">M17,3H5C3.89,3 3,3.9 3,5V19C3,20.1 3.9,21 5,21H19C20.1,21 21,20.1 21,19V7L17,3M15,9H5V5H15V9M12,19C10.34,19 9,17.66 9,16C9,14.34 10.34,13 12,13C13.66,13 15,14.34 15,16C15,17.66 13.66,19 12,19Z</Geometry>
        <Geometry x:Key="IconDelete">M19,4H15.5L14.5,3H9.5L8.5,4H5V6H19V4M6,19C6,20.1 6.9,21 8,21H16C17.1,21 18,20.1 18,19V7H6V19Z</Geometry>
        <Geometry x:Key="IconNew">M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20,12C20,16.41 16.41,20 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z</Geometry>
        <Geometry x:Key="IconClearFilter">M14.12,12.5L19.31,7.31L17.89,5.89L12.71,11.08L7.5,5.89L6.09,7.31L11.28,12.5L6.09,17.69L7.5,19.11L12.71,13.92L17.89,19.11L19.31,17.69L14.12,12.5M3,5H21V3H3V5Z</Geometry>
        <Geometry x:Key="IconUpload">M9,16V10H5L12,3L19,10H15V16H9M5,20V18H19V20H5Z</Geometry>
        <Geometry x:Key="IconExcel">M21.17 3.25Q21.5 3.25 21.76 3.5 22 3.74 22 4.08V19.92Q22 20.26 21.76 20.5 21.5 20.75 21.17 20.75H7.83Q7.5 20.75 7.24 20.5 7 20.26 7 19.92V4.08Q7 3.74 7.24 3.5 7.5 3.25 7.83 3.25H21.17M13.83 18.25V15.7H11.5V14.05L13.72 10.63H11.6V9H16.33V10.65L14.12 14.07H16.25V15.7H13.83V18.25M6.25 15.5Q6.25 15.15 6.04 14.88 5.82 14.6 5.5 14.6H3.5Q3.18 14.6 2.96 14.88 2.75 15.15 2.75 15.5V17.5Q2.75 17.82 2.96 18.1 3.18 18.38 3.5 18.38H5.5Q5.82 18.38 6.04 18.1 6.25 17.82 6.25 17.5V15.5M6.25 9.5Q6.25 9.18 6.04 8.9 5.82 8.62 5.5 8.62H3.5Q3.18 8.62 2.96 8.9 2.75 9.18 2.75 9.5V11.5Q2.75 11.82 2.96 12.1 3.18 12.38 3.5 12.38H5.5Q5.82 12.38 6.04 12.1 6.25 11.82 6.25 11.5V9.5Z</Geometry>

        <Style x:Key="ActionButton" TargetType="Button">
            <Setter Property="Background" Value="{StaticResource PrimaryBrownBrush}"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="Padding" Value="15,10"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border" Background="{TemplateBinding Background}" CornerRadius="4" Padding="{TemplateBinding Padding}">
                            <Border.Effect>
                                <DropShadowEffect ShadowDepth="1" Color="#000" Opacity="0.1" BlurRadius="10"/>
                            </Border.Effect>
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Opacity" Value="0.9"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="border" Property="Opacity" Value="0.8"/>
                                <Setter TargetName="border" Property="Effect" Value="{x:Null}"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <Style x:Key="DeleteButton" TargetType="Button" BasedOn="{StaticResource ActionButton}">
            <Setter Property="Background" Value="{StaticResource ErrorBrush}"/>
        </Style>
        <Style x:Key="MaterialIconButton" TargetType="Button">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Width" Value="40"/>
            <Setter Property="Height" Value="40"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border" Background="{TemplateBinding Background}" CornerRadius="20">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Background" Value="{StaticResource BackgroundHoverBrush}"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="border" Property="Background" Value="{StaticResource BorderGrayBrush}"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <Style TargetType="Label">
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Foreground" Value="{StaticResource DarkBrownBrush}"/>
            <Setter Property="Margin" Value="0,15,0,5"/>
        </Style>
        <Style x:Key="MaterialInput" TargetType="Control">
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Padding" Value="8,5"/>
            <Setter Property="BorderBrush" Value="{StaticResource BorderGrayBrush}"/>
            <Setter Property="BorderThickness" Value="0,0,0,1"/>
            <Setter Property="Background" Value="Transparent"/>
            <Style.Triggers>
                <Trigger Property="IsKeyboardFocused" Value="True">
                    <Setter Property="BorderBrush" Value="{StaticResource PrimaryBrownBrush}"/>
                    <Setter Property="BorderThickness" Value="0,0,0,2"/>
                </Trigger>
            </Style.Triggers>
        </Style>
        <Style TargetType="TextBox" BasedOn="{StaticResource MaterialInput}"/>
        <Style TargetType="ComboBox" BasedOn="{StaticResource MaterialInput}"/>
        <Style TargetType="DatePicker" BasedOn="{StaticResource MaterialInput}"/>

        <Style x:Key="SearchTextBox" TargetType="TextBox" BasedOn="{StaticResource MaterialInput}">
            <Setter Property="Padding" Value="8,8"/>
        </Style>
        <Style x:Key="FilterComboBox" TargetType="ComboBox" BasedOn="{StaticResource MaterialInput}">
            <Setter Property="Padding" Value="8,8"/>
        </Style>
        <Style TargetType="TabControl">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderThickness" Value="0"/>
        </Style>
        <Style TargetType="TabItem">
            <Setter Property="Background" Value="#E0E0E0"/>
            <Setter Property="Foreground" Value="{StaticResource TextGrayBrush}"/>
            <Setter Property="Padding" Value="10,5"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TabItem">
                        <Border x:Name="border" BorderThickness="0,0,0,3" BorderBrush="Transparent" Background="{TemplateBinding Background}" Padding="{TemplateBinding Padding}" Margin="0,0,5,0">
                            <ContentPresenter ContentSource="Header" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsSelected" Value="True">
                                <Setter Property="Foreground" Value="{StaticResource PrimaryBrownBrush}"/>
                                <Setter TargetName="border" Property="BorderBrush" Value="{StaticResource PrimaryBrownBrush}"/>
                                <Setter TargetName="border" Property="Background" Value="White"/>
                            </Trigger>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Foreground" Value="{StaticResource DarkBrownBrush}"/>
                                <Setter TargetName="border" Property="Background" Value="#F5F5F5"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <Style x:Key="ProductImage" TargetType="Image">
            <Setter Property="Width" Value="140"/>
            <Setter Property="Height" Value="140"/>
            <Setter Property="Stretch" Value="Uniform"/>
            <Setter Property="HorizontalAlignment" Value="Left"/>
        </Style>
        <Style x:Key="HeaderTextBlock" TargetType="TextBlock">
            <Setter Property="FontSize" Value="20"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Foreground" Value="{StaticResource DarkBrownBrush}"/>
            <Setter Property="Margin" Value="0,0,0,15"/>
        </Style>
        <Style x:Key="CardBorder" TargetType="Border">
            <Setter Property="Background" Value="{StaticResource WhiteTextBrush}"/>
            <Setter Property="CornerRadius" Value="8"/>
            <Setter Property="Padding" Value="20"/>
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect ShadowDepth="1" Color="#000000" Opacity="0.08" BlurRadius="20"/>
                </Setter.Value>
            </Setter>
        </Style>
        <Style x:Key="PrimaryButton" TargetType="Button">
            <Setter Property="Background" Value="{StaticResource PrimaryBrownBrush}"/>
            <Setter Property="Foreground" Value="{StaticResource WhiteTextBrush}"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Padding" Value="12,8"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border" CornerRadius="4" Background="{TemplateBinding Background}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Background" Value="{StaticResource DarkBrownBrush}"/>
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter Property="Opacity" Value="0.5"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

    </Page.Resources>

    <Grid Opacity="1" x:Name="MainGrid">
        <Grid.RenderTransform>
            <TranslateTransform Y="20"/>
        </Grid.RenderTransform>
        <Grid.Triggers>
            <EventTrigger RoutedEvent="Loaded">
                <BeginStoryboard>
                    <Storyboard>
                        <DoubleAnimation Storyboard.TargetProperty="Opacity" From="0" To="1" Duration="0:0:0.5"/>
                        <DoubleAnimation Storyboard.TargetProperty="(UIElement.RenderTransform).(TranslateTransform.Y)" To="0" Duration="0:0:0.5">
                            <DoubleAnimation.EasingFunction>
                                <BackEase EasingMode="EaseOut" Amplitude="0.2"/>
                            </DoubleAnimation.EasingFunction>
                        </DoubleAnimation>
                    </Storyboard>
                </BeginStoryboard>
            </EventTrigger>
        </Grid.Triggers>

        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="420"/>
        </Grid.ColumnDefinitions>

        <Border Grid.Column="0" Background="White" CornerRadius="8" Margin="10">
            <Border.Effect>
                <DropShadowEffect ShadowDepth="1" Color="#000" Opacity="0.08" BlurRadius="15"/>
            </Border.Effect>

            <TabControl x:Name="MainTabControl" Margin="5">

                <TabItem Header="Quản lý Sản phẩm">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        <WrapPanel Grid.Row="0" Orientation="Horizontal" Margin="10,5,10,10">
                            <TextBlock Text="Tìm kiếm:" VerticalAlignment="Center" Margin="0,0,5,0" Foreground="{StaticResource DarkBrownBrush}"/>
                            <TextBox x:Name="txtSearchSanPham" Width="200" TextChanged="TxtSearchSanPham_TextChanged"/>
                            <TextBlock Text="Danh mục:" VerticalAlignment="Center" Margin="15,0,5,0" Foreground="{StaticResource DarkBrownBrush}"/>
                            <ComboBox x:Name="cmbFilterDanhMuc" Width="180" DisplayMemberPath="Ten" SelectedValuePath="Id"
                                      SelectionChanged="Filter_SelectionChanged"/>
                            <TextBlock Text="Trạng thái:" VerticalAlignment="Center" Margin="15,0,5,0" Foreground="{StaticResource DarkBrownBrush}"/>
                            <ComboBox x:Name="cmbFilterTrangThai" Width="120" SelectionChanged="Filter_SelectionChanged">
                                <ComboBoxItem Content="Tất cả" Tag="{x:Null}"/>
                                <ComboBoxItem Content="Đang bán" Tag="True"/>
                                <ComboBoxItem Content="Tạm ngưng" Tag="False"/>
                            </ComboBox>
                            <Button x:Name="btnClearFilter" ToolTip="Xóa Lọc" Style="{StaticResource MaterialIconButton}" 
                                    Click="BtnClearFilter_Click" Margin="5,0,0,0">
                                <Path Data="{StaticResource IconClearFilter}" Fill="{StaticResource TextGrayBrush}" Width="23" Height="23"/>
                            </Button>
                        </WrapPanel>
                        <DataGrid Grid.Row="1" x:Name="dgSanPham" AutoGenerateColumns="False" IsReadOnly="True"
                                  SelectionMode="Single" SelectionChanged="DgSanPham_SelectionChanged"
                                  BorderThickness="0" RowHeaderWidth="0" Margin="10,0,10,10">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="ID" Binding="{Binding IdSanPham}" Width="50"/>
                                <DataGridTextColumn Header="Tên Sản Phẩm" Binding="{Binding TenSanPham}" Width="*"/>
                                <DataGridTextColumn Header="Đơn Giá" Binding="{Binding GiaBan, StringFormat=N0}" Width="100"/>
                                <DataGridTextColumn Header="Danh Mục" Binding="{Binding TenDanhMuc}" Width="150"/>
                                <DataGridCheckBoxColumn Header="Đang Bán" Binding="{Binding TrangThaiKinhDoanh}" Width="80"/>
                            </DataGrid.Columns>
                        </DataGrid>

                        <Button Grid.Row="2" x:Name="btnExportToExcel" HorizontalAlignment="Left" Margin="10,0,0,10"
                                Style="{StaticResource PrimaryButton}" Background="#00724C"
                                Click="BtnExportToExcel_Click">
                            <StackPanel Orientation="Horizontal">
                                <Path Data="{StaticResource IconExcel}" Fill="White" Width="23" Height="23" Margin="0,0,8,0"/>
                                <TextBlock Text="Xuất Excel" VerticalAlignment="Center"/>
                            </StackPanel>
                        </Button>
                    </Grid>
                </TabItem>

                <TabItem Header="Quản lý Danh mục">
                    <Grid Margin="10">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="380"/>
                        </Grid.ColumnDefinitions>
                        <Border Grid.Column="0" Margin="0,0,10,0" Padding="15" Background="{StaticResource SubtleGrayBrush}" CornerRadius="8">
                            <StackPanel>
                                <TextBlock Text="Danh Mục (Loại Sản Phẩm)" FontSize="16" FontWeight="Bold" Foreground="{StaticResource DarkBrownBrush}" Margin="0,0,0,10"/>
                                <ListBox x:Name="lbDanhMuc" DisplayMemberPath="Ten" SelectedValuePath="Id" Height="400" Margin="0,0,0,10" SelectionChanged="LbDanhMuc_SelectionChanged"/>
                            </StackPanel>
                        </Border>
                        <Border Grid.Column="1" Margin="10,0,0,0" Padding="15" Background="{StaticResource SubtleGrayBrush}" CornerRadius="8">
                            <StackPanel>
                                <TextBlock Text="Chi tiết Danh Mục" FontSize="16" FontWeight="Bold" Foreground="{StaticResource DarkBrownBrush}" Margin="0,0,0,10"/>
                                <Label Content="Tên Danh Mục"/>
                                <TextBox x:Name="txtTenDanhMuc" Margin="0,0,0,10"/>
                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                                    <Button x:Name="btnThemDanhMuc" Content="Thêm Mới" Click="BtnThemDanhMuc_Click" Style="{StaticResource PrimaryButton}" Background="{StaticResource SuccessBrush}" Padding="10,5" Margin="0,0,5,0"/>
                                    <Button x:Name="btnLuuDanhMuc" Content="Lưu" Click="BtnLuuDanhMuc_Click" Style="{StaticResource PrimaryButton}" Padding="10,5" Margin="0,0,5,0"/>
                                    <Button x:Name="btnXoaDanhMuc" Content="Xóa" Click="BtnXoaDanhMuc_Click" Style="{StaticResource DeleteButton}" Padding="10,5"/>
                                </StackPanel>
                            </StackPanel>
                        </Border>
                    </Grid>
                </TabItem>

                <TabItem Header="Định lượng Nguyên Liệu">
                    <Grid Margin="10">
                        <TextBlock x:Name="lblDinhLuongInfo" Text="Chọn một sản phẩm ở Tab 'Quản lý Sản phẩm' để xem và sửa định lượng." 
                                   VerticalAlignment="Center" HorizontalAlignment="Center"
                                   Foreground="{StaticResource TextGrayBrush}" FontSize="16" TextWrapping="Wrap" TextAlignment="Center"/>

                        <Grid x:Name="panelDinhLuong" Visibility="Collapsed">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <TextBlock Grid.Row="0" x:Name="lblDinhLuongTitle" Text="Định lượng cho: [Tên Sản Phẩm]" FontSize="18" FontWeight="Bold" Foreground="{StaticResource DarkBrownBrush}" Margin="0,0,0,15"/>

                            <DataGrid Grid.Row="1" x:Name="dgDinhLuong" AutoGenerateColumns="False" IsReadOnly="True" MaxHeight="300" RowHeaderWidth="0"
                                      SelectionChanged="DgDinhLuong_SelectionChanged">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="Nguyên liệu" Binding="{Binding TenNguyenLieu}" Width="*"/>
                                    <DataGridTextColumn Header="Số Lượng" Binding="{Binding SoLuong}" Width="100"/>
                                    <DataGridTextColumn Header="Đơn Vị Tính" Binding="{Binding TenDonViSuDung}" Width="100"/>
                                </DataGrid.Columns>
                            </DataGrid>

                            <Grid Grid.Row="2" Margin="0,15,0,0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="100"/>
                                    <ColumnDefinition Width="120"/>
                                </Grid.ColumnDefinitions>

                                <ComboBox Grid.Column="0" x:Name="cmbNguyenLieu" DisplayMemberPath="Ten" SelectedValuePath="Id" Margin="0,0,10,0" VerticalAlignment="Center"
                                          SelectionChanged="CmbNguyenLieu_SelectionChanged"
                                          IsEditable="True" IsTextSearchEnabled="True"/>

                                <TextBox Grid.Column="1" x:Name="txtSoLuongNL" Margin="0,0,10,0" VerticalAlignment="Center"/>

                                <ComboBox Grid.Column="2" x:Name="cmbDonViTinhNL" DisplayMemberPath="Ten" SelectedValuePath="Id" VerticalAlignment="Center"/>
                            </Grid>

                            <StackPanel Grid.Row="3" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,15,0,0">
                                <Button x:Name="btnLuuDinhLuong" Style="{StaticResource ActionButton}" Content="Thêm / Cập nhật NL" Click="BtnLuuDinhLuong_Click" Padding="10,5" Margin="0,0,8,0"/>
                                <Button x:Name="btnXoaDinhLuong" Style="{StaticResource DeleteButton}" Content="Xóa NL" Click="BtnXoaDinhLuong_Click" Padding="10,5"/>
                            </StackPanel>
                        </Grid>
                    </Grid>
                </TabItem>
            </TabControl>
        </Border>

        <Border Grid.Column="1" Background="White" CornerRadius="8" Padding="25" Margin="0,10,10,10">
            <Border.Effect>
                <DropShadowEffect ShadowDepth="1" Color="#000" Opacity="0.08" BlurRadius="15"/>
            </Border.Effect>
            <ScrollViewer VerticalScrollBarVisibility="Auto">
                <StackPanel>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock x:Name="lblFormTitle" Text="Thông tin Sản phẩm" FontSize="18" FontWeight="Bold" Foreground="{StaticResource DarkBrownBrush}" Margin="0,5,0,15" VerticalAlignment="Center"/>
                        <Button x:Name="btnLamMoiForm" Grid.Column="1" ToolTip="Tạo sản phẩm mới" Click="BtnLamMoiForm_Click" 
                                Style="{StaticResource MaterialIconButton}">
                            <Path Data="{StaticResource IconNew}" Fill="{StaticResource TextGrayBrush}" Width="23" Height="23"/>
                        </Button>
                    </Grid>
                    <Grid x:Name="formChiTietSP" IsEnabled="False">
                        <StackPanel>
                            <Grid Margin="0,0,0,15">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>

                                <Border Grid.Column="0" BorderBrush="{StaticResource BorderGrayBrush}" BorderThickness="1" Width="140" Height="140" Background="{StaticResource SubtleGrayBrush}">
                                    <Image x:Name="AnhSanPhamPreview" Style="{StaticResource ProductImage}"/>
                                </Border>

                                <StackPanel Grid.Column="1" VerticalAlignment="Bottom" Orientation="Horizontal" Margin="15,0,0,0">
                                    <Button x:Name="btnChonAnh" 
                                            Style="{StaticResource ActionButton}" Background="#F5F5F5" 
                                            BorderBrush="#E0E0E0" Foreground="{StaticResource DarkBrownBrush}"
                                            Click="BtnChonAnh_Click">
                                        <StackPanel Orientation="Horizontal">
                                            <Path Data="{StaticResource IconUpload}" Fill="{StaticResource DarkBrownBrush}" Width="23" Height="23" Margin="0,0,8,0"/>
                                            <TextBlock Text="Chọn ảnh" VerticalAlignment="Center"/>
                                        </StackPanel>
                                    </Button>

                                    <Button x:Name="btnXoaAnh" 
                                            Style="{StaticResource DeleteButton}" 
                                            Margin="10,0,0,0" 
                                            Click="BtnXoaAnh_Click">
                                        <StackPanel Orientation="Horizontal">
                                            <Path Data="{StaticResource IconDelete}" Fill="White" Width="20" Height="20" Margin="0,0,8,0"/>
                                            <TextBlock Text="Xóa ảnh" VerticalAlignment="Center"/>
                                        </StackPanel>
                                    </Button>
                                </StackPanel>
                            </Grid>

                            <Label Content="Tên Sản Phẩm (*)"/>
                            <TextBox x:Name="txtTenSanPham"/>
                            <Label Content="Danh Mục (*)"/>
                            <ComboBox x:Name="cmbDanhMuc" DisplayMemberPath="Ten" SelectedValuePath="Id" 
                                      IsEditable="True" IsTextSearchEnabled="True"/>
                            <Label Content="Đơn Giá (*)"/>
                            <TextBox x:Name="txtDonGia"/>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <StackPanel Grid.Column="0" Margin="0,0,10,0">
                                    <Label Content="Nhóm In (Bar/Bếp)"/>
                                    <ComboBox x:Name="cmbNhomIn" IsEditable="True">
                                        <ComboBoxItem Content="Bar"/>
                                        <ComboBoxItem Content="Bếp"/>
                                        <ComboBoxItem Content="Khác"/>
                                    </ComboBox>
                                </StackPanel>
                                <StackPanel Grid.Column="1" Margin="10,0,0,0">
                                    <Label Content="Trạng thái"/>
                                    <ComboBox x:Name="cmbTrangThai">
                                        <ComboBoxItem Content="Đang bán" Tag="True" IsSelected="True"/>
                                        <ComboBoxItem Content="Tạm ngưng" Tag="False"/>
                                    </ComboBox>
                                </StackPanel>
                            </Grid>
                            <Label Content="Mô tả"/>
                            <TextBox x:Name="txtMoTa" Height="100" TextWrapping="Wrap" AcceptsReturn="True" VerticalScrollBarVisibility="Auto"/>
                        </StackPanel>
                    </Grid>
                    <StackPanel x:Name="panelActions" Orientation="Horizontal" Margin="0,25,0,0">
                        <Button x:Name="btnLuu" Click="BtnLuu_Click" Margin="0,0,10,0" Style="{StaticResource ActionButton}" Background="{StaticResource SuccessBrush}">
                            <StackPanel Orientation="Horizontal">
                                <Path Data="{StaticResource IconSave}" Fill="White" Width="23" Height="23" Margin="0,0,8,0"/>
                                <TextBlock Text="Lưu Sản Phẩm" VerticalAlignment="Center"/>
                            </StackPanel>
                        </Button>
                        <Button x:Name="btnXoa" Click="BtnXoa_Click" Margin="0,0,10,0" Style="{StaticResource DeleteButton}">
                            <StackPanel Orientation="Horizontal">
                                <Path Data="{StaticResource IconDelete}" Fill="White" Width="23" Height="23" Margin="0,0,8,0"/>
                                <TextBlock Text="Xóa" VerticalAlignment="Center"/>
                            </StackPanel>
                        </Button>
                    </StackPanel>
                    <Border x:Name="LoadingOverlay" Background="#80FFFFFF" Visibility="Collapsed"
                            Grid.RowSpan="2" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                        <TextBlock Text="Đang xử lý..." HorizontalAlignment="Center" VerticalAlignment="Center" FontSize="16" FontWeight="SemiBold" Foreground="{StaticResource DarkBrownBrush}"/>
                    </Border>
                </StackPanel>
            </ScrollViewer>
        </Border>
    </Grid>
</Page>