<Page x:Class="AppCafebookApi.View.nhanvien.pages.SoDoBanView"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
      xmlns:local="clr-namespace:AppCafebookApi.View.nhanvien.pages"
      xmlns:sys="clr-namespace:System;assembly=mscorlib"
      mc:Ignorable="d" 
      d:DesignHeight="700" d:DesignWidth="1100"
      Title="SoDoBanView" FontFamily="Segoe UI" Loaded="Page_Loaded">

    <Page.Resources>
        <Geometry x:Key="IconSelectTable">M12,2C8.13,2 5,5.13 5,9C5,14.25 12,22 12,22C12,22 19,14.25 19,9C19,5.13 15.87,2 12,2M12,11.5A2.5,2.5 0 0,1 9.5,9A2.5,2.5 0 0,1 12,6.5A2.5,2.5 0 0,1 14.5,9A2.5,2.5 0 0,1 12,11.5Z</Geometry>
        <Geometry x:Key="IconRefresh">M17.65,6.35C16.2,4.9 14.21,4 12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20C15.73,20 18.84,17.45 19.73,14H17.65C16.83,16.33 14.61,18 12,18A6,6 0 0,1 6,12A6,6 0 0,1 12,6C13.66,6 15.14,6.69 16.22,7.78L13,11H20V4L17.65,6.35Z</Geometry>
        <Geometry x:Key="IconMenu">M3,6H21V8H3V6M3,11H21V13H3V11M3,16H21V18H3V16Z</Geometry>

        <SolidColorBrush x:Key="PrimaryBrownBrush" Color="#6F4E37"/>
        <SolidColorBrush x:Key="DarkBrownBrush" Color="#4E342E"/>
        <SolidColorBrush x:Key="AccentOrangeBrush" Color="#D27D2D"/>
        <SolidColorBrush x:Key="LightCreamBrush" Color="#FFF8E1"/>
        <SolidColorBrush x:Key="WhiteTextBrush" Color="#FFFFFF"/>
        <SolidColorBrush x:Key="TextGrayBrush" Color="#757575"/>
        <SolidColorBrush x:Key="SubtleGrayBrush" Color="#EEEEEE"/>
        <SolidColorBrush x:Key="BorderGrayBrush" Color="#E0E0E0"/>
        <SolidColorBrush x:Key="StatusGreenBrush" Color="#66BB6A"/>
        <SolidColorBrush x:Key="StatusRedBrush" Color="#EF5350"/>
        <SolidColorBrush x:Key="StatusYellowBrush" Color="#FFA726"/>
        <SolidColorBrush x:Key="ActionBlueBrush" Color="#42A5F5"/>
        <SolidColorBrush x:Key="ActionGrayBrush" Color="#BDBDBD"/>
        <SolidColorBrush x:Key="StatusBlueBrush" Color="#42A5F5"/>
        <ExponentialEase x:Key="ExpoEaseOut" EasingMode="EaseOut"/>
        <FontFamily x:Key="FontAwesomeSolid">/Assets/Fonts/Font Awesome 6 Free-Solid-900.otf#Font Awesome 6 Free Solid</FontFamily>

        <Style x:Key="KhuVucToggleStyle" TargetType="ToggleButton">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="{StaticResource DarkBrownBrush}"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="HorizontalContentAlignment" Value="Left"/>
            <Setter Property="Padding" Value="20,14"/>
            <Setter Property="Margin" Value="15,0,15,5"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ToggleButton">
                        <Border x:Name="border" 
                                Background="{TemplateBinding Background}" 
                                CornerRadius="8">
                            <ContentPresenter HorizontalAlignment="Left" VerticalAlignment="Center" Margin="{TemplateBinding Padding}"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Background" Value="{StaticResource SubtleGrayBrush}"/>
                            </Trigger>
                            <Trigger Property="IsChecked" Value="True">
                                <Setter TargetName="border" Property="Background" Value="{StaticResource PrimaryBrownBrush}"/>
                                <Setter Property="Foreground" Value="{StaticResource WhiteTextBrush}"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="TableCardStyle" TargetType="Button">
            <Setter Property="Width" Value="150"/>
            <Setter Property="Height" Value="130"/>
            <Setter Property="Margin" Value="15"/>
            <Setter Property="Background" Value="White"/>
            <Setter Property="BorderThickness" Value="0,5,0,0"/>
            <Setter Property="BorderBrush" Value="{StaticResource StatusGreenBrush}"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="cardBorder" 
                                Background="{TemplateBinding Background}" 
                                BorderBrush="{TemplateBinding BorderBrush}" 
                                BorderThickness="{TemplateBinding BorderThickness}" 
                                CornerRadius="8"
                                RenderTransformOrigin="0.5,0.5">
                            <Border.RenderTransform>
                                <ScaleTransform ScaleX="1" ScaleY="1"/>
                            </Border.RenderTransform>
                            <Border.Effect>
                                <DropShadowEffect x:Name="shadow" ShadowDepth="1" Color="#000" Opacity="0.1" BlurRadius="10"/>
                            </Border.Effect>
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" Margin="5"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <DataTrigger Binding="{Binding TrangThai}" Value="Có khách">
                    <Setter Property="BorderBrush" Value="{StaticResource StatusRedBrush}"/>
                </DataTrigger>
                <DataTrigger Binding="{Binding TrangThai}" Value="Đã đặt">
                    <Setter Property="BorderBrush" Value="{StaticResource StatusYellowBrush}"/>
                </DataTrigger>
                <DataTrigger Binding="{Binding TrangThai}" Value="Bảo trì">
                    <Setter Property="BorderBrush" Value="{StaticResource TextGrayBrush}"/>
                    <Setter Property="Opacity" Value="0.7"/>
                </DataTrigger>
            </Style.Triggers>
        </Style>

        <Style x:Key="ActionButtonStyle" TargetType="Button">
            <Setter Property="Padding" Value="12,20"/>
            <Setter Property="Margin" Value="0,5"/>
            <Setter Property="FontSize" Value="15"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border" 
                                CornerRadius="4" 
                                Background="{TemplateBinding Background}" 
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Page.Resources>

    <Grid x:Name="MainPanel" Background="{StaticResource LightCreamBrush}">
        <Grid.RenderTransform>
            <TranslateTransform Y="20"/>
        </Grid.RenderTransform>
        <Grid.Triggers>
        </Grid.Triggers>

        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="220"/>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="320"/>
        </Grid.ColumnDefinitions>

        <Border Grid.Column="0" Background="{StaticResource WhiteTextBrush}">
            <ScrollViewer VerticalScrollBarVisibility="Auto">
                <StackPanel Margin="0,10">
                    <TextBlock Text="Lọc Khu Vực" FontWeight="Bold" FontSize="16" Foreground="{StaticResource DarkBrownBrush}" Margin="20,10,0,10"/>
                    <ToggleButton x:Name="btnKhuVucAll" Content="TẤT CẢ KHU VỰC" Style="{StaticResource KhuVucToggleStyle}" IsChecked="True" Click="BtnKhuVuc_Click"/>
                    <Separator Margin="15,5,15,10"/>
                    <ItemsControl x:Name="icKhuVuc">
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <ToggleButton Content="{Binding TenKhuVuc}" Style="{StaticResource KhuVucToggleStyle}" Click="BtnKhuVuc_Click" DataContext="{Binding}"/>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </StackPanel>
            </ScrollViewer>
        </Border>

        <ScrollViewer Grid.Column="1" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled">
            <StackPanel>
                <WrapPanel Margin="15,15,15,0">
                    <Button Style="{StaticResource TableCardStyle}" 
                            BorderBrush="{StaticResource AccentOrangeBrush}"
                            ToolTip="Tạo hóa đơn Tại Quầy / Mang Về"
                            Click="BtnDonMoi_Click">
                        <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                            <TextBlock Text="&#xf54e;" FontFamily="{StaticResource FontAwesomeSolid}" FontSize="28" Margin="0,0,0,8" HorizontalAlignment="Center" Foreground="{StaticResource AccentOrangeBrush}"/>
                            <TextBlock Text="Đơn Mới" FontSize="24" FontWeight="Bold" Foreground="{StaticResource DarkBrownBrush}" HorizontalAlignment="Center"/>
                            <TextBlock Text="Tại Quầy / Mang Về" FontSize="13" Foreground="{StaticResource TextGrayBrush}" HorizontalAlignment="Center"/>
                        </StackPanel>
                    </Button>
                </WrapPanel>

                <ItemsControl x:Name="icBan" Margin="15,0,15,15">
                    <ItemsControl.ItemsPanel>
                        <ItemsPanelTemplate>
                            <WrapPanel/>
                        </ItemsPanelTemplate>
                    </ItemsControl.ItemsPanel>
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <Button Style="{StaticResource TableCardStyle}" Click="BtnBan_Click">
                                <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                                    <TextBlock FontSize="28" Margin="0,0,0,8" HorizontalAlignment="Center">
                                        <TextBlock.Style>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="Text" Value="&#xf00c;"/>
                                                <Setter Property="FontFamily" Value="{StaticResource FontAwesomeSolid}"/>
                                                <Setter Property="Foreground" Value="{StaticResource StatusGreenBrush}"/>
                                                <Style.Triggers>
                                                    <DataTrigger Binding="{Binding TrangThai}" Value="Có khách">
                                                        <Setter Property="Text" Value="&#xf0c0;"/>
                                                        <Setter Property="Foreground" Value="{StaticResource StatusRedBrush}"/>
                                                    </DataTrigger>
                                                    <DataTrigger Binding="{Binding TrangThai}" Value="Đã đặt">
                                                        <Setter Property="Text" Value="&#xf017;"/>
                                                        <Setter Property="Foreground" Value="{StaticResource StatusYellowBrush}"/>
                                                    </DataTrigger>
                                                    <DataTrigger Binding="{Binding TrangThai}" Value="Bảo trì">
                                                        <Setter Property="Text" Value="&#xf0ad;"/>
                                                        <Setter Property="Foreground" Value="{StaticResource TextGrayBrush}"/>
                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </TextBlock.Style>
                                    </TextBlock>
                                    <TextBlock Text="{Binding SoBan}" FontSize="24" FontWeight="Bold" Foreground="{StaticResource DarkBrownBrush}" HorizontalAlignment="Center"/>
                                    <TextBlock Text="{Binding TrangThai}" FontSize="13" Foreground="{StaticResource TextGrayBrush}" HorizontalAlignment="Center"/>
                                    <TextBlock Text="{Binding TongTienHienTai, StringFormat={}{0:N0} đ}" FontSize="13" Foreground="{StaticResource StatusRedBrush}" FontWeight="SemiBold" HorizontalAlignment="Center" Margin="0,4,0,0">
                                        <TextBlock.Style>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="Visibility" Value="Collapsed"/>
                                                <Style.Triggers>
                                                    <DataTrigger Binding="{Binding TrangThai}" Value="Có khách">
                                                        <Setter Property="Visibility" Value="Visible"/>
                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </TextBlock.Style>
                                    </TextBlock>
                                </StackPanel>
                            </Button>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>
            </StackPanel>
        </ScrollViewer>

        <Border Grid.Column="2" Background="{StaticResource WhiteTextBrush}">
            <Border.Effect>
                <DropShadowEffect ShadowDepth="2" Direction="270" Color="Black" Opacity="0.05" BlurRadius="20"/>
            </Border.Effect>

            <Grid x:Name="panelThaoTac" Margin="25">

                <StackPanel x:Name="panelChuaChon" VerticalAlignment="Center" HorizontalAlignment="Center" Opacity="0.5">
                    <Path Data="{StaticResource IconSelectTable}" Fill="{StaticResource BorderGrayBrush}" Width="60" Height="60" Stretch="Uniform"/>
                    <TextBlock Text="Chọn một bàn để bắt đầu thao tác" FontSize="16" Foreground="{StaticResource TextGrayBrush}" TextWrapping="Wrap" TextAlignment="Center" Margin="0,20,0,0"/>
                </StackPanel>

                <StackPanel x:Name="panelDaChon" Visibility="Collapsed">
                    <TextBlock Text="Thông Tin Bàn" FontSize="22" FontWeight="Bold" Margin="0,0,0,15" Foreground="{StaticResource DarkBrownBrush}"/>
                    <Separator Background="#EEEEEE"/>
                    <TextBlock FontSize="40" FontWeight="Bold" Margin="0,20,0,0" Foreground="{StaticResource PrimaryBrownBrush}">Bàn <Run x:Name="runSoBan"/></TextBlock>
                    <TextBlock FontSize="16" Margin="0,5,0,0" Foreground="{StaticResource TextGrayBrush}">Trạng thái: <Run x:Name="runTrangThai" FontWeight="SemiBold"/></TextBlock>
                    <TextBlock x:Name="tbGhiChu" FontStyle="Italic" Foreground="{StaticResource TextGrayBrush}" Margin="0,5,0,0" TextWrapping="Wrap" Visibility="Collapsed"/>
                    <TextBlock x:Name="tbTongTienWrapper" FontSize="16" Margin="0,10,0,0" Foreground="{StaticResource DarkBrownBrush}">Tổng tiền tạm tính: <Run x:Name="runTongTien" FontWeight="Bold" Foreground="{StaticResource StatusRedBrush}"/></TextBlock>
                    <StackPanel Margin="0,30,0,0">
                        <Button x:Name="btnGoiMon" Padding="20,18" FontSize="16" FontWeight="Bold" Background="{StaticResource PrimaryBrownBrush}" Foreground="White" Click="BtnGoiMon_Click" Cursor="Hand">
                            <Button.Resources>
                                <Style TargetType="Border">
                                    <Setter Property="CornerRadius" Value="4"/>
                                </Style>
                            </Button.Resources>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Viewbox Grid.Column="0" Width="18" Height="18" Margin="0,0,12,0" VerticalAlignment="Center">
                                    <Path Data="{StaticResource IconMenu}" Fill="White"/>
                                </Viewbox>
                                <TextBlock Grid.Column="1" Text="Gọi Món / Thanh Toán" VerticalAlignment="Center" Margin="0,1,0,0"/>
                            </Grid>
                        </Button>
                        <Button x:Name="btnChuyenBan" Content="Chuyển Bàn" Style="{StaticResource ActionButtonStyle}" Click="BtnChuyenBan_Click" Background="#F5F5F5" BorderBrush="#E0E0E0" Foreground="{StaticResource DarkBrownBrush}"/>
                        <Button x:Name="btnGopBan" Content="Gộp Bàn" Style="{StaticResource ActionButtonStyle}" Click="BtnGopBan_Click" Background="#F5F5F5" BorderBrush="#E0E0E0" Foreground="{StaticResource DarkBrownBrush}"/>
                        <Button x:Name="btnBaoCaoSuCo" Content="Báo cáo Sự cố" Style="{StaticResource ActionButtonStyle}" Background="{StaticResource StatusYellowBrush}" BorderBrush="{StaticResource StatusYellowBrush}" Foreground="{StaticResource DarkBrownBrush}" Margin="0,20,0,0" Click="BtnBaoCaoSuCo_Click"/>
                    </StackPanel>
                    <Button x:Name="btnLamMoi" VerticalAlignment="Bottom" HorizontalAlignment="Stretch" Margin="0,50,0,0" Click="BtnLamMoi_Click" Style="{StaticResource ActionButtonStyle}" Background="Transparent" BorderBrush="#E0E0E0" Foreground="{StaticResource TextGrayBrush}" FontWeight="Normal">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Viewbox Grid.Column="0" Width="15" Height="15" Margin="0,0,10,0" VerticalAlignment="Center">
                                <Path Data="{StaticResource IconRefresh}" Fill="{StaticResource TextGrayBrush}"/>
                            </Viewbox>
                            <TextBlock Grid.Column="1" Text="Làm mới Sơ đồ" VerticalAlignment="Center" Margin="0,1,0,0"/>
                        </Grid>
                    </Button>
                </StackPanel>

                <StackPanel x:Name="panelChonBan" Visibility="Collapsed" VerticalAlignment="Center">
                    <TextBlock x:Name="selectionText" 
                               Text="Vui lòng chọn bàn..." 
                               Foreground="{StaticResource DarkBrownBrush}" 
                               FontSize="18" 
                               FontWeight="Bold"
                               TextWrapping="Wrap" TextAlignment="Center"/>
                    <TextBlock Text="Click vào bàn hợp lệ trên sơ đồ" 
                               Foreground="{StaticResource TextGrayBrush}" 
                               FontSize="14" 
                               TextAlignment="Center" Margin="0,5,0,0"/>

                    <Button Content="Hủy Thao Tác" 
                            x:Name="btnCancelSelect" 
                            Click="BtnCancelSelect_Click"
                            Style="{StaticResource ActionButtonStyle}"
                            Background="{StaticResource StatusRedBrush}"
                            BorderBrush="{StaticResource StatusRedBrush}"
                            Foreground="White"
                            Margin="0,20,0,0"/>

                </StackPanel>
            </Grid>
        </Border>
    </Grid>
</Page>