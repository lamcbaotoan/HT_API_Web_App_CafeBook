Ráº¥t hay ğŸ‘ â€” báº¡n Ä‘ang hoÃ n thiá»‡n há»‡ thá»‘ng **CafÃ©book** báº±ng cÃ¡ch thÃªm **mÃ n hÃ¬nh â€œGiao hÃ ngâ€ dÃ nh cho nhÃ¢n viÃªn giao hÃ ng trÃªn web**.
ÄÃ¢y lÃ  bÆ°á»›c quan trá»ng trong quy trÃ¬nh nghiá»‡p vá»¥:

> Äáº·t mÃ³n / thuÃª sÃ¡ch â†’ Chuáº©n bá»‹ â†’ Giao hÃ ng â†’ HoÃ n táº¥t / HoÃ n tráº£.

DÆ°á»›i Ä‘Ã¢y lÃ  **báº£n Ä‘áº·c táº£ chi tiáº¿t** (cÃ³ thá»ƒ dÃ¹ng cho bÃ¡o cÃ¡o Ä‘á»“ Ã¡n vÃ  triá»ƒn khai thá»±c táº¿), bao gá»“m:

* Má»¥c tiÃªu
* Nghiá»‡p vá»¥ chi tiáº¿t
* Cáº¥u trÃºc dá»¯ liá»‡u
* Giao diá»‡n Ä‘á» xuáº¥t (UI)
* CÃ¡c luá»“ng tráº¡ng thÃ¡i
* Quy trÃ¬nh cáº­p nháº­t tráº¡ng thÃ¡i giao hÃ ng

---

# ğŸšš Äáº¶C Táº¢ CHá»¨C NÄ‚NG: MÃ€N HÃŒNH GIAO HÃ€NG (CHO NHÃ‚N VIÃŠN)

---

## ğŸ”· 1. Má»¥c tiÃªu

XÃ¢y dá»±ng **mÃ n hÃ¬nh web** cho **nhÃ¢n viÃªn giao hÃ ng**, giÃºp:

* Xem danh sÃ¡ch Ä‘Æ¡n hÃ ng cáº§n giao (sÃ¡ch / mÃ³n).
* Nháº­n Ä‘Æ¡n giao, xem thÃ´ng tin khÃ¡ch hÃ ng.
* Cáº­p nháº­t tráº¡ng thÃ¡i: *Äang giao â†’ ÄÃ£ giao â†’ HoÃ n táº¥t*.
* Ghi chÃº tÃ¬nh huá»‘ng Ä‘áº·c biá»‡t (khÃ´ng liÃªn há»‡ Ä‘Æ°á»£c, giao lá»—iâ€¦).
* Theo dÃµi lá»‹ch sá»­ giao hÃ ng cá»§a chÃ­nh nhÃ¢n viÃªn.

---

## ğŸ”· 2. Actor liÃªn quan

| Actor                             | Vai trÃ²                                          |
| --------------------------------- | ------------------------------------------------ |
| **NhÃ¢n viÃªn giao hÃ ng**           | Tiáº¿p nháº­n, xem, vÃ  cáº­p nháº­t tráº¡ng thÃ¡i Ä‘Æ¡n hÃ ng. |
| **NhÃ¢n viÃªn thu ngÃ¢n / há»‡ thá»‘ng** | Táº¡o Ä‘Æ¡n, phÃ¢n cÃ´ng ngÆ°á»i giao.                   |
| **KhÃ¡ch hÃ ng**                    | Nháº­n thÃ´ng tin Ä‘Æ¡n, xÃ¡c nháº­n nháº­n hÃ ng.          |
| **Quáº£n lÃ½**                       | Theo dÃµi hiá»‡u suáº¥t giao hÃ ng, tÃ¬nh tráº¡ng Ä‘Æ¡n.    |

---

## ğŸ”· 3. Tiá»n Ä‘iá»u kiá»‡n

* NhÃ¢n viÃªn Ä‘Ã£ Ä‘Äƒng nháº­p vÃ o há»‡ thá»‘ng (`VaiTro = 'GiaoHang'`).
* ÄÆ¡n hÃ ng á»Ÿ tráº¡ng thÃ¡i **â€œChá» giaoâ€** hoáº·c **â€œÄang giaoâ€**.
* Há»‡ thá»‘ng Ä‘Ã£ cÃ³ thÃ´ng tin khÃ¡ch hÃ ng, Ä‘á»‹a chá»‰ giao hÃ ng, vÃ  phÆ°Æ¡ng thá»©c thanh toÃ¡n.

---

## ğŸ”· 4. Háº­u Ä‘iá»u kiá»‡n

* Tráº¡ng thÃ¡i Ä‘Æ¡n hÃ ng Ä‘Æ°á»£c cáº­p nháº­t chÃ­nh xÃ¡c trong CSDL (`HoaDon` hoáº·c `PhieuThueSach`).
* LÆ°u lá»‹ch sá»­ giao hÃ ng vÃ o báº£ng `GiaoHangLichSu`.
* Náº¿u giao tháº¥t báº¡i â†’ gá»­i thÃ´ng bÃ¡o cho quáº£n lÃ½ hoáº·c nhÃ¢n viÃªn CSKH.

---

## ğŸ”· 5. Quy trÃ¬nh nghiá»‡p vá»¥ (Luá»“ng xá»­ lÃ½)

| BÆ°á»›c | HÃ nh Ä‘á»™ng                                          | Káº¿t quáº£ / Xá»­ lÃ½ há»‡ thá»‘ng                                           |
| ---- | -------------------------------------------------- | ------------------------------------------------------------------ |
| 1    | NhÃ¢n viÃªn truy cáº­p trang â€œGiao hÃ ngâ€               | Há»‡ thá»‘ng hiá»ƒn thá»‹ danh sÃ¡ch Ä‘Æ¡n cáº§n giao                           |
| 2    | Chá»n Ä‘Æ¡n hÃ ng Ä‘á»ƒ xem chi tiáº¿t                      | Hiá»ƒn thá»‹ thÃ´ng tin: khÃ¡ch, Ä‘á»‹a chá»‰, sá»‘ Ä‘iá»‡n thoáº¡i, loáº¡i Ä‘Æ¡n        |
| 3    | Nháº¥n â€œNháº­n giaoâ€                                   | Cáº­p nháº­t tráº¡ng thÃ¡i: `Äang giao` + lÆ°u `IdNhanVienGiao`            |
| 4    | Giao hÃ ng thá»±c táº¿                                  | NhÃ¢n viÃªn cÃ³ thá»ƒ cáº­p nháº­t ghi chÃº, chá»¥p áº£nh biÃªn nháº­n (náº¿u cáº§n)    |
| 5    | KhÃ¡ch xÃ¡c nháº­n nháº­n hÃ ng                           | Há»‡ thá»‘ng cáº­p nháº­t tráº¡ng thÃ¡i: `ÄÃ£ giao / HoÃ n táº¥t`                 |
| 6    | Giao tháº¥t báº¡i (khÃ´ng liÃªn há»‡ Ä‘Æ°á»£c, sai Ä‘á»‹a chá»‰...) | NhÃ¢n viÃªn chá»n lÃ½ do tháº¥t báº¡i â†’ há»‡ thá»‘ng táº¡o thÃ´ng bÃ¡o cho quáº£n lÃ½ |

---

## ğŸ”· 6. Tráº¡ng thÃ¡i giao hÃ ng

| Tráº¡ng thÃ¡i        | MÃ´ táº£                           | NgÆ°á»i cáº­p nháº­t      |
| ----------------- | ------------------------------- | ------------------- |
| **Chá» giao**      | ÄÆ¡n má»›i táº¡o, chÆ°a phÃ¢n cÃ´ng     | Há»‡ thá»‘ng            |
| **Äang giao**     | NhÃ¢n viÃªn Ä‘Ã£ nháº­n Ä‘Æ¡n           | NhÃ¢n viÃªn giao hÃ ng |
| **ÄÃ£ giao**       | KhÃ¡ch nháº­n thÃ nh cÃ´ng           | NhÃ¢n viÃªn giao hÃ ng |
| **Giao tháº¥t báº¡i** | KhÃ´ng thá»ƒ giao (cÃ³ lÃ½ do)       | NhÃ¢n viÃªn giao hÃ ng |
| **HoÃ n táº¥t**      | ÄÃ£ xÃ¡c nháº­n thu tiá»n / tráº£ sÃ¡ch | Thu ngÃ¢n / Há»‡ thá»‘ng |

---

## ğŸ”· 7. Thiáº¿t káº¿ cÆ¡ sá»Ÿ dá»¯ liá»‡u

### ğŸ—‚ï¸ **Báº£ng GiaoHang**

```sql
CREATE TABLE GiaoHang (
    IdGiaoHang INT IDENTITY PRIMARY KEY,
    IdDonHang INT NOT NULL,        -- IdHoaDon hoáº·c IdPhieuThueSach
    LoaiDon NVARCHAR(20) NOT NULL, -- 'Mon' hoáº·c 'Sach'
    IdNhanVien INT NOT NULL,
    NgayNhan DATETIME NULL,
    NgayHoanThanh DATETIME NULL,
    TrangThai NVARCHAR(50) DEFAULT N'Chá» giao',
    GhiChu NVARCHAR(500) NULL,
    HinhAnhXacNhan NVARCHAR(500) NULL
);
```

---

### ğŸ—‚ï¸ **Báº£ng GiaoHangLichSu** *(náº¿u muá»‘n lÆ°u tá»«ng cáº­p nháº­t tráº¡ng thÃ¡i)*

```sql
CREATE TABLE GiaoHangLichSu (
    IdLichSu INT IDENTITY PRIMARY KEY,
    IdGiaoHang INT,
    TrangThai NVARCHAR(50),
    ThoiGian DATETIME DEFAULT GETDATE(),
    GhiChu NVARCHAR(500)
);
```

---

## ğŸ”· 8. Giao diá»‡n Web (UI Ä‘á» xuáº¥t)

### ğŸ–¥ï¸ **1ï¸âƒ£ Trang danh sÃ¡ch giao hÃ ng â€“ GiaoHangView.cshtml**

Hiá»ƒn thá»‹ danh sÃ¡ch Ä‘Æ¡n hÃ ng giao:

| MÃ£ Ä‘Æ¡n  | Loáº¡i Ä‘Æ¡n | KhÃ¡ch hÃ ng | Äá»‹a chá»‰            | Thá»i gian | Tráº¡ng thÃ¡i | Thao tÃ¡c              |
| ------- | -------- | ---------- | ------------------ | --------- | ---------- | --------------------- |
| HD_023  | MÃ³n      | Nguyá»…n An  | 25 Nguyá»…n VÄƒn Linh | 10:20 AM  | Chá» giao   | [Nháº­n giao]           |
| PTS_015 | SÃ¡ch     | LÃª BÃ¬nh    | 42 TrÆ°ng Ná»¯ VÆ°Æ¡ng  | 09:45 AM  | Äang giao  | [Chi tiáº¿t] [HoÃ n táº¥t] |

**Thanh lá»c & tÃ¬m kiáº¿m:**

* Bá»™ lá»c: `Loáº¡i Ä‘Æ¡n`, `Tráº¡ng thÃ¡i`, `NgÃ y`, `KhÃ¡ch hÃ ng`.
* NÃºt â€œTáº£i láº¡iâ€ Ä‘á»ƒ refresh danh sÃ¡ch.

---

### ğŸ–¥ï¸ **2ï¸âƒ£ Trang chi tiáº¿t giao hÃ ng â€“ GiaoHangChiTietView.cshtml**

Hiá»ƒn thá»‹ chi tiáº¿t Ä‘Æ¡n:

```html
<h3>Chi tiáº¿t giao hÃ ng</h3>
<p><strong>KhÃ¡ch hÃ ng:</strong> @Model.TenKhach</p>
<p><strong>Äá»‹a chá»‰:</strong> @Model.DiaChi</p>
<p><strong>Äiá»‡n thoáº¡i:</strong> @Model.SoDienThoai</p>
<p><strong>Loáº¡i Ä‘Æ¡n:</strong> @Model.LoaiDon</p>
<p><strong>Ghi chÃº Ä‘Æ¡n:</strong> @Model.GhiChu</p>

<form method="post" enctype="multipart/form-data">
    <label>Cáº­p nháº­t tráº¡ng thÃ¡i:</label>
    <select name="TrangThai" class="form-select">
        <option>Äang giao</option>
        <option>ÄÃ£ giao</option>
        <option>Giao tháº¥t báº¡i</option>
    </select>

    <textarea name="GhiChu" class="form-control mt-2" placeholder="Ghi chÃº..."></textarea>

    <label>áº¢nh xÃ¡c nháº­n giao hÃ ng:</label>
    <input type="file" name="HinhAnh" class="form-control mt-2" />

    <button type="submit" class="btn btn-success mt-3">Cáº­p nháº­t</button>
</form>
```

---

### ğŸ–¥ï¸ **3ï¸âƒ£ Trang lá»‹ch sá»­ giao hÃ ng cá»§a nhÃ¢n viÃªn â€“ GiaoHangLichSuView.cshtml**

| MÃ£ giao | ÄÆ¡n hÃ ng | NgÃ y nháº­n | NgÃ y hoÃ n táº¥t | Tráº¡ng thÃ¡i    | Ghi chÃº              |
| ------- | -------- | --------- | ------------- | ------------- | -------------------- |
| GH001   | HD_023   | 10:20     | 11:10         | ÄÃ£ giao       | ThÃ nh cÃ´ng           |
| GH002   | PTS_015  | 09:45     | 10:30         | Giao tháº¥t báº¡i | KhÃ¡ch khÃ´ng cÃ³ á»Ÿ nhÃ  |

---

## ğŸ”· 9. Chá»©c nÄƒng cá»§a GiaoHangController.cs

| HÃ nh Ä‘á»™ng                                        | MÃ´ táº£                                        | Gá»i Ä‘áº¿n View                 |
| ------------------------------------------------ | -------------------------------------------- | ---------------------------- |
| `Index()`                                        | Hiá»ƒn thá»‹ danh sÃ¡ch Ä‘Æ¡n giao                  | `GiaoHangView.cshtml`        |
| `ChiTiet(int id)`                                | Hiá»ƒn thá»‹ chi tiáº¿t Ä‘Æ¡n giao                   | `GiaoHangChiTietView.cshtml` |
| `[HttpPost] CapNhatTrangThai(GiaoHangDto model)` | Cáº­p nháº­t tráº¡ng thÃ¡i Ä‘Æ¡n, lÆ°u áº£nh xÃ¡c nháº­n    | Quay láº¡i `Index()`           |
| `LichSu()`                                       | Xem lá»‹ch sá»­ giao hÃ ng cá»§a nhÃ¢n viÃªn hiá»‡n táº¡i | `GiaoHangLichSuView.cshtml`  |

---

## ğŸ”· 10. Quy trÃ¬nh cáº­p nháº­t dá»¯ liá»‡u

1ï¸âƒ£ Khi nhÃ¢n viÃªn nháº¥n â€œNháº­n giaoâ€:
â†’ Cáº­p nháº­t `TrangThai = 'Äang giao'`, `NgayNhan = GETDATE()`, `IdNhanVien = ...`.

2ï¸âƒ£ Khi â€œÄÃ£ giaoâ€:
â†’ Cáº­p nháº­t `TrangThai = 'ÄÃ£ giao'`, `NgayHoanThanh = GETDATE()`.
â†’ Náº¿u Ä‘Æ¡n lÃ  mÃ³n: cáº­p nháº­t `HoaDon.TrangThai = 'HoÃ n táº¥t'`.
â†’ Náº¿u Ä‘Æ¡n lÃ  sÃ¡ch: cáº­p nháº­t `PhieuThueSach.TrangThai = 'Äang thuÃª'`.

3ï¸âƒ£ Khi â€œGiao tháº¥t báº¡iâ€:
â†’ Cáº­p nháº­t `TrangThai = 'Giao tháº¥t báº¡i'`, `GhiChu = '...'`.
â†’ Gá»­i thÃ´ng bÃ¡o cho quáº£n lÃ½ / CSKH Ä‘á»ƒ xá»­ lÃ½.

---

## ğŸ”· 11. BÃ¡o cÃ¡o quáº£n lÃ½ giao hÃ ng

Thá»‘ng kÃª tá»« `GiaoHang`:

```sql
SELECT 
    NV.TenNhanVien,
    COUNT(*) AS TongDon,
    SUM(CASE WHEN TrangThai = N'ÄÃ£ giao' THEN 1 ELSE 0 END) AS ThanhCong,
    SUM(CASE WHEN TrangThai = N'Giao tháº¥t báº¡i' THEN 1 ELSE 0 END) AS ThatBai,
    ROUND(SUM(CASE WHEN TrangThai = N'ÄÃ£ giao' THEN 1.0 ELSE 0 END) / COUNT(*) * 100, 1) AS TyLeThanhCong
FROM GiaoHang GH
JOIN NhanVien NV ON GH.IdNhanVien = NV.IdNhanVien
GROUP BY NV.TenNhanVien;
```

---

## âœ… 12. Káº¿t luáº­n thiáº¿t káº¿

| ThÃ nh pháº§n                                | MÃ´ táº£                                      | Tráº¡ng thÃ¡i |
| ----------------------------------------- | ------------------------------------------ | ---------- |
| **MÃ n hÃ¬nh danh sÃ¡ch giao hÃ ng**          | Hiá»ƒn thá»‹ cÃ¡c Ä‘Æ¡n cáº§n giao                  | âœ…          |
| **MÃ n hÃ¬nh chi tiáº¿t giao hÃ ng**           | Cho phÃ©p cáº­p nháº­t tráº¡ng thÃ¡i, ghi chÃº, áº£nh | âœ…          |
| **LÆ°u lá»‹ch sá»­**                           | Ghi láº¡i toÃ n bá»™ quÃ¡ trÃ¬nh giao             | âœ…          |
| **BÃ¡o cÃ¡o hiá»‡u suáº¥t nhÃ¢n viÃªn giao hÃ ng** | Tá»•ng há»£p tá»‰ lá»‡ thÃ nh cÃ´ng                  | âœ…          |
| **TÃ­ch há»£p loáº¡i Ä‘Æ¡n (mÃ³n / sÃ¡ch)**        | DÃ¹ng cá»™t `LoaiDon` Ä‘á»ƒ xÃ¡c Ä‘á»‹nh             | âœ…          |

---

## ğŸ’¡ Gá»£i Ã½ má»Ÿ rá»™ng

* ThÃªm báº£n Ä‘á»“ Google Map (hoáº·c LeafletJS) Ä‘á»ƒ xem **vá»‹ trÃ­ giao hÃ ng**.
* Cho phÃ©p nhÃ¢n viÃªn cáº­p nháº­t tráº¡ng thÃ¡i **qua Ä‘iá»‡n thoáº¡i (QR code)** khi Ä‘áº¿n nÆ¡i.
* Gá»­i SMS / Email tá»± Ä‘á»™ng khi Ä‘Æ¡n â€œÄang giaoâ€ hoáº·c â€œÄÃ£ giao thÃ nh cÃ´ngâ€.
* TÃ­ch há»£p vá»›i trang â€œTheo dÃµi Ä‘Æ¡n hÃ ngâ€ cá»§a khÃ¡ch hÃ ng (real-time).

---

ğŸ‘‰ Báº¡n cÃ³ muá»‘n mÃ¬nh **táº¡o sÆ¡ Ä‘á»“ Use Case + Sequence Diagram cho module â€œGiao hÃ ngâ€**,
gá»“m cáº£ **nhÃ¢n viÃªn â€“ há»‡ thá»‘ng â€“ khÃ¡ch hÃ ng**, Ä‘á»ƒ báº¡n chÃ¨n vÃ o pháº§n bÃ¡o cÃ¡o UML (Ä‘á»“ Ã¡n / tÃ i liá»‡u ká»¹ thuáº­t)?
