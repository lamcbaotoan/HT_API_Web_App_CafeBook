Backend: C#.
Frontend: cshtml.
Database: SQL Server Management Studio 21.
IDE: Visual Studio Insiders.
tÃªn projec: WebCafebookApi.
ná»n táº£ng: ASP.NET Core Web App (Razor Pages), Net Framework 8.0.
//////////////////////////
ğŸŒ³ Solution 'AppCafebookApi' (4 of 4 projects)
â”‚
â”œâ”€â”€ ğŸ™ GitHub Actions/
â”‚
â”œâ”€â”€ ğŸ”· AppCafebookApi/ (Dá»± Ã¡n WPF Desktop)
â”‚   â”œâ”€â”€ â¡ï¸ Dependencies/
â”‚   â”œâ”€â”€ ğŸ“‚ Assets/
â”‚   â”‚   â”œâ”€â”€ ğŸ“‚ images/
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ–¼ï¸ default-avatar.png
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ–¼ï¸ default-book-cover.png
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ–¼ï¸ default-food-icon.png
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ–¼ï¸ logo.ico
â”‚   â”‚   â”‚   â””â”€â”€ ğŸ–¼ï¸ logo.png
â”‚   â”‚   â””â”€â”€ ğŸ“‚ Fonts/
â”‚   â”‚       â””â”€â”€ ğŸ…°ï¸ Font Awesome 6 Free-Solid-900.otf
â”‚   â”œâ”€â”€ ğŸ“‚ Services/
â”‚   â”‚   â”œâ”€â”€ C# AuthService.cs
â”‚   â”‚   â””â”€â”€ C# HinhAnhHelpers.cs
â”‚   â”œâ”€â”€ ğŸ“‚ View/
â”‚   â”‚   â”œâ”€â”€ ğŸ“‚ Common/
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“„ BaocaodoanhthuPreviewWindow.xaml
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“„ BaoCaoHieuSuatNhanVientPreview.xaml
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“„ BaoCaoTonKhoNguyenLieuPreviewWindo...
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“„ BapCaoTonKhoSachPreviewWindow.xaml
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“„ InputDialogWindow.xaml
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“„ PhieuLuongPreviewWindow.xaml
â”‚   â”‚   â”‚   â””â”€â”€ ğŸ“„ WelcomeWindow.xaml
â”‚   â”‚   â”œâ”€â”€ ğŸ“‚ nhanvien/
â”‚   â”‚   â”‚    â”œâ”€â”€ ğŸ“‚ pages/
â”‚   â”‚   â”‚    â”‚     â”œâ”€â”€ ğŸ“„ SoDoBanView.xaml
â”‚   â”‚   â”‚    â”‚     â””â”€â”€ ğŸ“„ GoiMonView.xaml
â”‚   â”‚   â”‚    â””â”€â”€ ğŸ“„ ManHinhNhanVien.xaml
â”‚   â”‚   â””â”€â”€ ğŸ“‚ quanly/
â”‚   â”‚       â”œâ”€â”€ ğŸ“‚ pages/
â”‚   â”‚       â”‚   â”œâ”€â”€ ğŸ“„ BaoCaoNhanSuView.xaml
â”‚   â”‚       â”‚   â”œâ”€â”€ ğŸ“„ CaiDatNhanSuView.xaml
â”‚   â”‚       â”‚   â”œâ”€â”€ ğŸ“„ PhanQuyenView.xaml
â”‚   â”‚       â”‚   â”œâ”€â”€ ğŸ“„ QuanLyBanView.xaml
â”‚   â”‚       â”‚   â”œâ”€â”€ ğŸ“„ QuanLyDonHangView.xaml
â”‚   â”‚       â”‚   â”œâ”€â”€ ğŸ“„ QuanLyDonViChuyenDoiView.xaml
â”‚   â”‚       â”‚   â”œâ”€â”€ ğŸ“„ QuanLyDonXinNghiView.xaml
â”‚   â”‚       â”‚   â”œâ”€â”€ ğŸ“„ QuanLyKiemKhoView.xaml
â”‚   â”‚       â”‚   â”œâ”€â”€ ğŸ“„ QuanLyKhachHangView.xaml
â”‚   â”‚       â”‚   â”œâ”€â”€ ğŸ“„ QuanLyKhuyenMaiView.xaml
â”‚   â”‚       â”‚   â”œâ”€â”€ ğŸ“„ QuanLyLichLamViecView.xaml
â”‚   â”‚       â”‚   â”œâ”€â”€ ğŸ“„ QuanLyLuongView.xaml
â”‚   â”‚       â”‚   â”œâ”€â”€ ğŸ“„ QuanLyNguyenLieuView.xaml
â”‚   â”‚       â”‚   â”œâ”€â”€ ğŸ“„ QuanLyNhaCungCapView.xaml
â”‚   â”‚       â”‚   â”œâ”€â”€ ğŸ“„ QuanLyNhanVienView.xaml
â”‚   â”‚       â”‚   â”œâ”€â”€ ğŸ“„ QuanLyNhapKhoView.xaml
â”‚   â”‚       â”‚   â”œâ”€â”€ ğŸ“„ QuanLyPhatLuongView.xaml
â”‚   â”‚       â”‚   â”œâ”€â”€ ğŸ“„ QuanLySachView.xaml
â”‚   â”‚       â”‚   â”œâ”€â”€ ğŸ“„ QuanLySanPhamView.xaml
â”‚   â”‚       â”‚   â”œâ”€â”€ ğŸ“„ QuanLyVaiTroView.xaml
â”‚   â”‚       â”‚   â”œâ”€â”€ ğŸ“„ QuanLyXuatHuyView.xaml
â”‚   â”‚       â”‚   â””â”€â”€ ğŸ“„ TongQuanView.xaml
â”‚   â”‚       â”œâ”€â”€ ğŸ“„ ManHinhQuanly.xaml
â”‚   â”‚       â””â”€â”€ ğŸ“„ ManHinhDangNhap.xaml
â”‚   â”œâ”€â”€ âš™ï¸ App.xaml
â”‚   â””â”€â”€ ğŸ–¼ï¸ logo.ico
â”‚
â”œâ”€â”€ ğŸ”· CafebookApi/ (Dá»± Ã¡n ASP.NET Core API Backend)
â”‚   â”œâ”€â”€ â¡ï¸ Connected Services/
â”‚   â”œâ”€â”€ â¡ï¸ Dependencies/
â”‚   â”œâ”€â”€ ğŸ“‚ Properties/
â”‚   â”‚   â””â”€â”€ ğŸ“„ launchSettings.json
â”‚   â”œâ”€â”€ ğŸ“‚ wwwroot/
â”‚   â”‚   â””â”€â”€ ğŸ“‚ images/
â”‚   â”‚       â”œâ”€â”€ ğŸ“‚ avatars/
â”‚   â”‚       â”‚   â”œâ”€â”€ ğŸ“‚ avatarKH/
â”‚   â”‚       â”‚   â””â”€â”€ ğŸ“‚ avatarNV/
â”‚   â”‚       â”œâ”€â”€ ğŸ“‚ books/
â”‚   â”‚       â””â”€â”€ ğŸ“‚ foods/
â”‚   â”œâ”€â”€ ğŸ“‚ Controllers/
â”‚   â”‚   â”œâ”€â”€ ğŸ“‚ App/
â”‚   â”‚   â”‚   â””â”€â”€ ğŸ“‚ NhanVien/
â”‚   â”‚   â”‚   â”‚    â”œâ”€â”€ GoiMonController.cs
â”‚   â”‚   â”‚   â”‚    â”œâ”€â”€ GiaoHangController.cs
â”‚   â”‚   â”‚   â”‚    â”œâ”€â”€ SoDoBanController.cs
â”‚   â”‚   â”‚   â”œâ”€â”€ C# BanQuanLyController.cs
â”‚   â”‚   â”‚   â”œâ”€â”€ C# BaoCaoController.cs
â”‚   â”‚   â”‚   â”œâ”€â”€ C# BaoCaoHieuSuatController.cs
â”‚   â”‚   â”‚   â”œâ”€â”€ C# BaoCaoNhanSuController.cs
â”‚   â”‚   â”‚   â”œâ”€â”€ C# BaoCaoSachController.cs
â”‚   â”‚   â”‚   â”œâ”€â”€ C# BaoCaoTonKhoController.cs
â”‚   â”‚   â”‚   â”œâ”€â”€ C# CaiDatController.cs
â”‚   â”‚   â”‚   â”œâ”€â”€ C# CaiDatNhanSuController.cs
â”‚   â”‚   â”‚   â”œâ”€â”€ C# CalamViecController.cs
â”‚   â”‚   â”‚   â”œâ”€â”€ C# DashboardController.cs
â”‚   â”‚   â”‚   â”œâ”€â”€ C# DonHangController.cs
â”‚   â”‚   â”‚   â”œâ”€â”€ C# DonViChuyenDoiController.cs
â”‚   â”‚   â”‚   â”œâ”€â”€ C# DonXinNghiController.cs
â”‚   â”‚   â”‚   â”œâ”€â”€ C# KhachHangController.cs
â”‚   â”‚   â”‚   â”œâ”€â”€ C# KhoController.cs
â”‚   â”‚   â”‚   â”œâ”€â”€ C# KhuyenMaiController.cs
â”‚   â”‚   â”‚   â”œâ”€â”€ C# LichLamViecController.cs
â”‚   â”‚   â”‚   â”œâ”€â”€ C# LuongController.cs
â”‚   â”‚   â”‚   â”œâ”€â”€ C# NguyenLieuController.cs
â”‚   â”‚   â”‚   â”œâ”€â”€ C# NhaCungCapController.cs
â”‚   â”‚   â”‚   â”œâ”€â”€ C# NhanVienController.cs
â”‚   â”‚   â”‚   â”œâ”€â”€ C# PhanQuyenController.cs
â”‚   â”‚   â”‚   â”œâ”€â”€ C# PhatLuongController.cs
â”‚   â”‚   â”‚   â”œâ”€â”€ C# SachController.cs
â”‚   â”‚   â”‚   â”œâ”€â”€ C# SanPhamController.cs
â”‚   â”‚   â”‚   â”œâ”€â”€ C# SoDoBanController.cs
â”‚   â”‚   â”‚   â”œâ”€â”€ C# TaiKhoanController.cs
â”‚   â”‚   â”‚   â”œâ”€â”€ C# ThongBaoController.cs
â”‚   â”‚   â”‚   â”œâ”€â”€ C# ThuongPhatController.cs
â”‚   â”‚   â”‚   â””â”€â”€ C# VaiTroController.cs
â”‚   â”‚   â”œâ”€â”€ ğŸ“‚ Shared/
â”‚   â”‚   â””â”€â”€ ğŸ“‚ Web/
â”‚   â”‚       â”œâ”€â”€ C# KhachHangTaiKhoanController.cs
â”‚   â”‚       â”œâ”€â”€ C# NhanVienTaiKhoanController.cs
â”‚   â”‚       â”œâ”€â”€ C# TrangChuController.cs
â”‚   â”‚       â””â”€â”€ C# WebQuanLyController.cs
â”‚   â”œâ”€â”€ ğŸ“‚ Data/
â”‚   â”‚   â””â”€â”€ C# CafebookDbContext.cs
â”‚   â”œâ”€â”€ ğŸ“‚ Services/
â”‚   â”œâ”€â”€ ğŸ“„ appsettings.json
â”‚   â””â”€â”€ C# Program.cs
â”‚
â”œâ”€â”€ ğŸ”· WebCafebookApi/ (Dá»± Ã¡n ASP.NET Core Web App - Razor Pages)
â”‚   â”œâ”€â”€ â¡ï¸ Connected Services/
â”‚   â”œâ”€â”€ â¡ï¸ Dependencies/
â”‚   â”œâ”€â”€ ğŸ“‚ Properties/
â”‚   â”‚   â””â”€â”€ ğŸ“„ launchSettings.json
â”‚   â”œâ”€â”€ ğŸ“‚ wwwroot/
â”‚   â”‚   â”œâ”€â”€ ğŸ“‚ css/
â”‚   â”‚   â”‚   â””â”€â”€ ğŸ“„ site.css
â”‚   â”‚   â”œâ”€â”€ ğŸ“‚ images/
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ–¼ï¸ default-avatar.png
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ–¼ï¸ default-book-cover.png
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ–¼ï¸ default-food-icon.png
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ–¼ï¸ logo.ico
â”‚   â”‚   â”‚   â””â”€â”€ ğŸ–¼ï¸ logo.png
â”‚   â”‚   â”œâ”€â”€ ğŸ“‚ js/
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“„ profile.js
â”‚   â”‚   â”‚   â””â”€â”€ ğŸ“„ site.js
â”‚   â”‚   â”œâ”€â”€ ğŸ“‚ lib/
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“‚ bootstrap/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“‚ dist/
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“‚ css/
â”‚   â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“„ bootstrap.css
â”‚   â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“„ bootstrap-grid.css
â”‚   â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“„ bootstrap-reboot.css
â”‚   â”‚   â”‚   â”‚   â”‚   â”‚   â””â”€â”€ ğŸ“„ bootstrap-utilities.css
â”‚   â”‚   â”‚   â”‚   â”‚   â””â”€â”€ ğŸ“‚ js/
â”‚   â”‚   â”‚   â”‚   â”‚       â””â”€â”€ ğŸ“„ bootstrap.js
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ ğŸ“„ LICENSE
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“‚ jquery/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“‚ dist/
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“„ jquery.js
â”‚   â”‚   â”‚   â”‚   â”‚   â””â”€â”€ ğŸ“„ LICENSE.txt
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ ğŸ“„ LICENSE
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“‚ jquery-validation/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“‚ dist/
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“„ additional-methods.js
â”‚   â”‚   â”‚   â”‚   â”‚   â””â”€â”€ ğŸ“„ jquery.validate.js
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ ğŸ“„ LICENSE.md
â”‚   â”‚   â”‚   â””â”€â”€ ğŸ“‚ jquery-validation-unobtrusive/
â”‚   â”‚   â”‚       â”œâ”€â”€ ğŸ“‚ dist/
â”‚   â”‚   â”‚       â”‚   â””â”€â”€ ğŸ“„ jquery.validate.unobtrusive.js
â”‚   â”‚   â”‚       â””â”€â”€ ğŸ“„ LICENSE.txt  <-- (ÄÃ£ cáº­p nháº­t tá»« áº£nh má»›i)
â”‚   â”‚   â””â”€â”€ ğŸ–¼ï¸ favicon.ico
â”‚   â”œâ”€â”€ ğŸ“‚ Data/
â”‚   â”œâ”€â”€ ğŸ“‚ Pages/
â”‚   â”‚   â”œâ”€â”€ ğŸ“‚ Account/
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“„ DangKyView.cshtml
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“„ DangNhapView.cshtml
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“„ DangXuat.cshtml
â”‚   â”‚   â”‚   â””â”€â”€ ğŸ“„ QuenMatKhauView.cshtml
â”‚   â”‚   â”œâ”€â”€ ğŸ“‚ employee/
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“„ _Layout_Employee.cshtml
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“„ _ViewStart.cshtml
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“„ DangNhapEmployee.cshtml
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“„ DangXuat.cshtml
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“„ SoDoBanView.cshtml
â”‚   â”‚   â”‚   â””â”€â”€ ğŸ“„ WebQuanLyView.cshtml
â”‚   â”‚   â”œâ”€â”€ ğŸ“‚ Shared/
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“„ _ViewImports.cshtml
â”‚   â”‚   â”‚   â””â”€â”€ ğŸ“„ _ViewStart.cshtml
â”‚   â”‚   â””â”€â”€ ğŸ“„ TrangChuView.cshtml
â”‚   â”œâ”€â”€ ğŸ“‚ Services/
â”‚   â”œâ”€â”€ ğŸ“„ appsettings.json
â”‚   â”œâ”€â”€ ğŸ“„ appsettings.Development.json
â”‚   â””â”€â”€ C# Program.cs
â”‚
â””â”€â”€ ğŸ”· CafebookModel/ (Dá»± Ã¡n Class Library - Shared Models)
    â”œâ”€â”€ â¡ï¸ Dependencies/
   ğŸ“‚ Model
    â”œâ”€â”€ ğŸ“‚ Data/
    â”‚   â””â”€â”€ C# NhanVienDto.cs
    â”œâ”€â”€ ğŸ“‚ ModelApi/
    â”‚   â”œâ”€â”€ C# LoginRequestModel.cs
    â”‚   â””â”€â”€ C# LoginResponseModel.cs
    â”œâ”€â”€ ğŸ“‚ ModelApp/
    â”‚   â”œâ”€â”€ C# BanQuanLyDto.cs
    â”‚   â”œâ”€â”€ C# BaoCaoDto.cs
    â”‚   â”œâ”€â”€ C# BaoCaoHieuSuatDto.cs
    â”‚   â”œâ”€â”€ C# BaoCaoSachDto.cs
    â”‚   â”œâ”€â”€ C# BaoCaoTonKhoDto.cs
    â”‚   â”œâ”€â”€ C# CaiDatDto.cs
    â”‚   â”œâ”€â”€ C# CaiDatThongTinCuaHangDto.cs
    â”‚   â”œâ”€â”€ C# ChartDataPoint.cs
    â”‚   â”œâ”€â”€ C# DashboardSummaryDto.cs
    â”‚   â”œâ”€â”€ C# DonHangDto.cs
    â”‚   â”œâ”€â”€ C# DonViChuyenDoiDto.cs
    â”‚   â”œâ”€â”€ C# DonXinNghiDto.cs
    â”‚   â”œâ”€â”€ C# KhachHangDto.cs
    â”‚   â”œâ”€â”€ C# KhoDto.cs
    â”‚   â”œâ”€â”€ C# KhuyenMaiDto.cs
    â”‚   â”œâ”€â”€ C# NhanSuDto.cs
    â”‚   â”œâ”€â”€ C# PhatLuongDto.cs
    â”‚   â”œâ”€â”€ C# SachDto.cs
    â”‚   â”œâ”€â”€ C# SanPhamDto.cs
    â”‚   â”œâ”€â”€ C# SoDoBanDto.cs
    â”‚   â””â”€â”€ C# ThongBaoDto.cs
    â”œâ”€â”€ ğŸ“‚ ModelWeb/
    â”‚   â”œâ”€â”€ C# DangKyRequestModel.cs
    â”‚   â”œâ”€â”€ C# KhachHangDto.cs
    â”‚   â”œâ”€â”€ C# TrangChuDto.cs
    â”‚   â”œâ”€â”€ C# WebLoginResponseModel.cs
    â”‚   â””â”€â”€ C# WebQuanLyDashboardModel.cs
    â”œâ”€â”€ Entities.cs
    â””â”€â”€ ğŸ“‚ Utils/
        â”œâ”€â”€ C# HinhAnhPaths.cs
        â””â”€â”€ C# SlugifyUtil.cs
//////////////////////////
e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\Properties\
e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\Properties\launchSettings.json
{
  "$schema": "http://json.schemastore.org/launchsettings.json",
  "iisSettings": {
    "windowsAuthentication": false,
    "anonymousAuthentication": true,
    "iisExpress": {
      "applicationUrl": "http://localhost:20767",
      "sslPort": 0
    }
  },
  "profiles": {
    "http": {
      "commandName": "Project",
      "dotnetRunMessages": true,
      "launchBrowser": true,
      "applicationUrl": "http://localhost:5156",
      "environmentVariables": {
        "ASPNETCORE_ENVIRONMENT": "Development"
      }
    },
    "IIS Express": {
      "commandName": "IISExpress",
      "launchBrowser": true,
      "environmentVariables": {
        "ASPNETCORE_ENVIRONMENT": "Development"
      }
    }
  }
}
e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\wwwroot\
e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\wwwroot\css\
e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\wwwroot\css\site.css
/*
================================================
 CAFEBOOK WEB THEME (v1.2 - Sá»¬A Lá»–I RESPONSIVE)
================================================
*/
:root {
    --cf-brown: #6F4E37; /* PrimaryBrown */
    --cf-dark-brown: #4E342E; /* DarkText / DarkBrown */
    --cf-orange: #D27D2D; /* AccentOrange */
    --cf-cream: #FFF8E1; /* LightCream */
    --cf-white: #FFFFFF;
    --cf-text: #4E342E;
    --cf-gray: #BDBDBD; /* SubtleGray */
    --cf-light-gray: #f8f9fa; /* MÃ u ná»n xÃ¡m nháº¡t */
    --cf-shadow: rgba(78, 52, 46, 0.15); /* BÃ³ng Ä‘á»• mÃ u nÃ¢u má» */
    /* Ghi Ä‘Ã¨ mÃ u Bootstrap */
    --bs-primary: var(--cf-brown);
    --bs-secondary: var(--cf-gray);
    --bs-body-bg: var(--cf-cream);
    --bs-body-color: var(--cf-text);
    --bs-link-color: var(--cf-orange);
    --bs-link-hover-color: var(--cf-dark-brown);
}

html {
    font-size: 16px;
    position: relative;
    min-height: 100%;
}

body {
    font-family: 'Segoe UI', system-ui, -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", Arial, sans-serif;
    display: flex;
    flex-direction: column;
    min-height: 100vh;
}

.main-container {
    flex-grow: 1; /* Äáº©y footer xuá»‘ng dÆ°á»›i */
}

h1, h2, h3, h4, h5, h6, .navbar-brand, .fw-bold {
    font-weight: 600;
    color: var(--cf-dark-brown);
}

/* Header (Navbar) */
.navbar {
    background-color: var(--cf-white) !important;
    box-shadow: 0 4px 12px var(--cf-shadow);
}

.navbar-brand img {
    height: 30px;
    margin-right: 8px;
    transition: transform 0.3s ease;
}

.navbar-brand:hover img {
    transform: rotate(15deg);
}

/* Footer */
.footer {
    background-color: var(--cf-dark-brown);
    color: var(--cf-gray);
    border-top: none;
    padding-top: 1rem;
    padding-bottom: 1rem;
    flex-shrink: 0;
}

.footer-link {
    color: var(--cf-white);
    text-decoration: none;
    margin-left: 1rem;
    transition: color 0.3s ease;
}

    .footer-link:hover {
        color: var(--cf-orange);
    }


/*
================================================
 THIáº¾T Káº¾ TRANG LOGIN/REGISTER
================================================
*/
.login-page-body {
    background-color: var(--cf-cream);
    display: flex;
    align-items: center;
    justify-content: center;
    min-height: 100vh;
    padding-top: 0;
    padding-bottom: 0;
}

.login-wrapper {
    max-width: 850px;
    width: 100%;
    margin: 2rem;
}

.login-container {
    display: flex;
    border-radius: 12px;
    box-shadow: 0 15px 30px rgba(78, 52, 46, 0.2);
    overflow: hidden;
    animation: fadeIn 0.8s ease-out;
}

.login-brand-col {
    background-color: var(--cf-brown);
    color: var(--cf-white);
    padding: 4rem;
    width: 320px;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    text-align: center;
}

    .login-brand-col img {
        width: 100px;
        height: 100px;
        border-radius: 50%;
        margin-bottom: 1.5rem;
        box-shadow: 0 4px 10px rgba(0,0,0,0.2);
    }

    .login-brand-col h1 {
        color: var(--cf-white);
        font-size: 2.5rem;
        font-weight: 700;
    }

.login-form-col {
    background-color: var(--cf-white);
    padding: 3rem 4rem;
    flex-grow: 1;
    display: flex;
    flex-direction: column;
    justify-content: center;
}

    .login-form-col h2 {
        color: var(--cf-dark-brown);
        font-weight: 700;
        margin-bottom: 0.5rem;
    }

    .login-form-col .text-muted {
        margin-bottom: 2.5rem;
    }

/* Material Textbox */
.form-floating-material {
    position: relative;
    margin-bottom: 2rem;
}

    .form-floating-material .form-control {
        background-color: transparent;
        border: none;
        border-radius: 0;
        border-bottom: 1px solid var(--cf-gray);
        padding: 0.75rem 0.75rem 0.75rem 2.5rem;
        font-size: 1rem;
        transition: border-color 0.3s ease;
    }

        .form-floating-material .form-control:focus {
            box-shadow: none;
            border-bottom: 2px solid var(--cf-orange);
        }

    .form-floating-material .form-label {
        padding-left: 2.5rem;
        color: var(--cf-gray);
        transition: all 0.3s ease;
    }

    .form-floating-material .form-control:focus ~ .form-label,
    .form-floating-material .form-control:not(:placeholder-shown) ~ .form-label {
        color: var(--cf-orange);
        transform: scale(.85) translateY(-.75rem) translateX(-.15rem);
    }


    .form-floating-material .material-symbols-outlined {
        position: absolute;
        top: 0.75rem;
        left: 0.25rem;
        color: var(--cf-gray);
        transition: color 0.3s ease;
    }

    .form-floating-material .form-control:focus ~ .material-symbols-outlined {
        color: var(--cf-orange);
    }

.form-check-input:checked {
    background-color: var(--cf-orange);
    border-color: var(--cf-orange);
}

@keyframes fadeIn {
    from {
        opacity: 0;
        transform: scale(0.95);
    }

    to {
        opacity: 1;
        transform: scale(1);
    }
}

@media (max-width: 768px) {
    .login-container {
        flex-direction: column;
    }

    .login-brand-col {
        width: 100%;
        padding: 2rem;
    }

    .login-form-col {
        padding: 2rem;
    }
}

/*
========================================
 STYLES CHO EMPLOYEE (NHÃ‚N VIÃŠN)
========================================
*/

/* Layout chÃ­nh */
.employee-body {
    background-color: var(--cf-light-gray);
    min-height: 100vh;
    display: flex; /* Sá»­a lá»—i layout desktop */
}

/* Sidebar */
.sidebar-nav {
    background-color: var(--cf-dark-brown) !important;
    width: 250px;
    flex-shrink: 0;
    transition: none;
}

@media (min-width: 768px) {
    .sidebar-nav.offcanvas-md {
        position: sticky;
        top: 0;
        height: 100vh;
        transform: none !important;
        visibility: visible !important;
    }
}

/* Ná»™i dung chÃ­nh */
.main-content {
    flex-grow: 1;
    min-width: 0;
}

/* Header */
.header-nav {
    background-color: #fff;
    padding: 1rem 1.5rem;
    display: flex;
    justify-content: space-between;
    align-items: center;
    border-bottom: 1px solid #dee2e6;
    position: sticky;
    top: 0;
    z-index: 1020;
}

    .header-nav .nav-link {
        padding: 0;
    }

    /* Sá»­a lá»—i nÃºt hamburger trÃªn mobile */
    .header-nav .btn.btn-link {
        border-radius: 0;
        padding: 0.25rem 0.75rem;
        font-weight: 400;
        text-transform: none;
        letter-spacing: normal;
        border: none;
        transition: none;
        box-shadow: none;
        background-color: transparent !important;
    }

        .header-nav .btn.btn-link:hover {
            transform: none;
            box-shadow: none;
            opacity: 0.7;
        }

/* NÃºt menu sidebar */
.sidebar-header {
    padding: 0 1.5rem 1rem 1.5rem;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
}

.sidebar-nav .nav-link {
    color: rgba(255, 255, 255, 0.7);
    font-size: 1rem;
    padding: 12px 1.5rem;
    transition: all 0.2s ease;
    border-left: 4px solid transparent;
}

    .sidebar-nav .nav-link i {
        width: 20px;
        margin-right: 12px;
        text-align: center;
    }

    .sidebar-nav .nav-link:hover {
        color: #fff;
        background-color: var(--cf-brown);
        border-left-color: var(--cf-orange);
    }

    .sidebar-nav .nav-link.active {
        color: #fff;
        background-color: var(--cf-brown);
        font-weight: 600;
        border-left-color: var(--cf-orange);
    }


/*
========================================
 STYLES CHO SÆ  Äá»’ BÃ€N (WEB)
========================================
*/
#table-layout-container {
    gap: 20px;
}

.table-card {
    width: 150px;
    height: 130px;
    border-radius: 8px;
    border-top: 5px solid;
    background-color: #fff;
    box-shadow: 0 4px 12px var(--cf-shadow);
    padding: 15px;
    text-align: center;
    cursor: pointer;
    transition: all 0.3s ease;
}

    .table-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 20px rgba(78, 52, 46, 0.2);
    }

    .table-card.selected {
        transform: translateY(-5px);
        box-shadow: 0 8px 20px var(--cf-orange);
        border-color: var(--cf-orange) !important;
    }

.table-icon {
    font-size: 24px;
    margin-bottom: 5px;
}

.table-name {
    font-size: 1.5rem;
    font-weight: 700;
    margin: 0;
}

.table-status {
    font-size: 0.9rem;
    color: #757575;
}

.table-price {
    font-size: 1rem;
    font-weight: 700;
    color: var(--cf-orange);
    margin-top: 5px;
}

.table-card.status-trong {
    border-color: #66BB6A;
}

    .table-card.status-trong .table-icon {
        color: #66BB6A;
    }

.table-card.status-co-khach {
    border-color: #EF5350;
}

    .table-card.status-co-khach .table-icon {
        color: #EF5350;
    }

.table-card.status-da-dat {
    border-color: #FFA726;
}

    .table-card.status-da-dat .table-icon {
        color: #FFA726;
    }

.table-card.status-bao-tri {
    border-color: #757575;
    background-color: #f0f0f0;
    cursor: not-allowed;
    opacity: 0.7;
}

    .table-card.status-bao-tri .table-icon {
        color: #757575;
    }

.status-box {
    display: inline-block;
    width: 15px;
    height: 15px;
    border-radius: 3px;
    margin-right: 5px;
    vertical-align: middle;
}

    .status-box.status-trong {
        background-color: #66BB6A;
    }

    .status-box.status-co-khach {
        background-color: #EF5350;
    }

    .status-box.status-da-dat {
        background-color: #FFA726;
    }

    .status-box.status-bao-tri {
        background-color: #757575;
    }

/*
================================================
 NÃšT Báº¤M (BUTTONS) - GHI ÄÃˆ
================================================
*/
.btn {
    border-radius: 21px;
    padding: 0.6rem 1.5rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    border: none;
    transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
    box-shadow: 0 2px 4px var(--cf-shadow);
}

.btn-lg {
    padding: 0.8rem 2rem;
    font-size: 1.1rem;
}

.btn-primary {
    background-color: var(--cf-brown);
    color: var(--cf-white);
    border-color: var(--cf-brown);
}

    .btn-primary:hover, .btn-primary:focus {
        background-color: var(--cf-orange);
        color: var(--cf-white);
        border-color: var(--cf-orange);
        transform: translateY(-3px);
        box-shadow: 0 6px 12px rgba(78, 52, 46, 0.25);
    }

.btn-outline-light {
    border-radius: 21px;
    padding: 0.6rem 1.5rem;
    font-weight: 600;
    transition: all 0.3s ease;
    border-width: 2px;
}

    .btn-outline-light:hover {
        background-color: var(--cf-orange);
        color: var(--cf-white);
        border-color: var(--cf-orange);
        transform: translateY(-3px);
    }

.btn-outline-primary {
    border-radius: 21px;
    color: var(--cf-brown);
    border-color: var(--cf-brown);
}

    .btn-outline-primary:hover {
        background-color: var(--cf-brown);
        color: var(--cf-white);
        transform: translateY(-2px);
        box-shadow: 0 4px 8px var(--cf-shadow);
    }

.btn-success {
    background-color: var(--cf-orange);
    border-color: var(--cf-orange);
}

    .btn-success:hover {
        background-color: #a96323;
        border-color: #a96323;
        transform: translateY(-3px);
        box-shadow: 0 6px 12px rgba(78, 52, 46, 0.25);
    }

/*
================================================
 THáºº (CARDS) - GHI ÄÃˆ
================================================
*/
.card {
    border: none;
    border-radius: 12px;
    box-shadow: 0 4px 12px var(--cf-shadow);
    transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
}

    .card:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 20px rgba(78, 52, 46, 0.2);
    }

.card-title {
    color: var(--cf-dark-brown);
    font-weight: 600;
}

.card-img-top {
    border-top-left-radius: 12px;
    border-top-right-radius: 12px;
}

.card-footer {
    background-color: var(--cf-white);
    border-bottom-left-radius: 12px;
    border-bottom-right-radius: 12px;
}
e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\wwwroot\images\
e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\wwwroot\images\default-avatar.png
e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\wwwroot\images\default-book-cover.png
e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\wwwroot\images\default-food-icon.png
e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\wwwroot\images\logo.ico
e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\wwwroot\images\logo.png
e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\wwwroot\js\
e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\wwwroot\js\profile.js
// wwwroot/js/profile.js
document.addEventListener('DOMContentLoaded', function () {
    const avatarUploadInput = document.getElementById('avatarUploadInput');
    const avatarPreview = document.getElementById('avatarPreview');
    const avatarSizeError = document.getElementById('avatarSizeError');
    const avatarTypeError = document.getElementById('avatarTypeError');
    const maxSize = 3 * 1024 * 1024; // 3MB in bytes
    const allowedTypes = ['image/jpeg', 'image/png', 'image/gif'];

    if (avatarUploadInput && avatarPreview) {
        avatarUploadInput.addEventListener('change', function (event) {
            avatarSizeError.style.display = 'none'; // Reset errors
            avatarTypeError.style.display = 'none';

            const file = event.target.files[0];
            if (file) {
                // Check size
                if (file.size > maxSize) {
                    avatarSizeError.style.display = 'block';
                    avatarUploadInput.value = ''; // Clear selection
                    avatarPreview.src = avatarPreview.dataset.originalSrc || '/images/default-avatar.png'; // Revert preview
                    return;
                }

                // Check type
                if (!allowedTypes.includes(file.type.toLowerCase())) {
                     avatarTypeError.style.display = 'block';
                     avatarUploadInput.value = ''; // Clear selection
                     avatarPreview.src = avatarPreview.dataset.originalSrc || '/images/default-avatar.png'; // Revert preview
                     return;
                }


                // Show preview
                const reader = new FileReader();
                reader.onload = function (e) {
                    // Store original src if not already stored
                    if (!avatarPreview.dataset.originalSrc) {
                        avatarPreview.dataset.originalSrc = avatarPreview.src;
                    }
                    avatarPreview.src = e.target.result;
                }
                reader.readAsDataURL(file);
            } else {
                 // No file selected, revert preview if needed
                 avatarPreview.src = avatarPreview.dataset.originalSrc || '/images/default-avatar.png';
            }
        });
    }
});
e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\wwwroot\js\site.js
// =========================================
// LOGIC SÆ  Äá»’ BÃ€N (NHÃ‚N VIÃŠN)
// =========================================

// Thay tháº¿ $(document).ready() báº±ng cÃº phÃ¡p $(function() { ... })
$(function () {

    // Chá»‰ cháº¡y code nÃ y náº¿u chÃºng ta á»Ÿ Ä‘Ãºng trang
    const $container = $("#table-layout-container");
    if ($container.length > 0) {

        const apiBaseUrl = "http://localhost:5166";
        let currentSelectedBan = null;
        let currentNhanVienId = null;

        // Láº¥y ID nhÃ¢n viÃªn tá»« attribute (do C# render ra)
        currentNhanVienId = $container.data("nhanvien-id");

        // HÃ m Ä‘á»ƒ táº£i vÃ  hiá»ƒn thá»‹ bÃ n
        function loadSoDoBan() {
            // Chá»‰ hiá»ƒn thá»‹ loading á»Ÿ láº§n táº£i Ä‘áº§u
            if ($container.children(".spinner-border").length > 0) {
                $container.html('<div class="text-center w-100 p-5"><div class="spinner-border text-primary" role="status"></div><p>Äang táº£i...</p></div>');
            }

            $.ajax({
                url: `${apiBaseUrl}/api/app/sodoban/tables`,
                type: 'GET',
                dataType: 'json',
                success: function (tables) {
                    $container.empty(); // XÃ³a loading/bÃ n cÅ©
                    if (!tables || tables.length === 0) {
                        $container.html("<p>KhÃ´ng tÃ¬m tháº¥y bÃ n nÃ o.</p>");
                        return;
                    }

                    tables.forEach(ban => {
                        let statusClass = '';
                        let statusIcon = '';
                        switch (ban.trangThai) {
                            case 'Trá»‘ng':
                                statusClass = 'status-trong';
                                statusIcon = 'fa-solid fa-check';
                                break;
                            case 'CÃ³ khÃ¡ch':
                                statusClass = 'status-co-khach';
                                statusIcon = 'fa-solid fa-users';
                                break;
                            case 'ÄÃ£ Ä‘áº·t':
                                statusClass = 'status-da-dat';
                                statusIcon = 'fa-solid fa-clock';
                                break;
                            case 'Báº£o trÃ¬':
                            case 'Táº¡m ngÆ°ng':
                            default:
                                statusClass = 'status-bao-tri';
                                statusIcon = 'fa-solid fa-triangle-exclamation';
                                break;
                        }

                        let tongTienHtml = ban.trangThai === 'CÃ³ khÃ¡ch'
                            ? `<p class="table-price">${ban.tongTienHienTai.toLocaleString('vi-VN')} Ä‘</p>` : '';

                        // Truyá»n táº¥t cáº£ dá»¯ liá»‡u vÃ o data-*
                        let tableCardHtml = `
                            <div class="table-card ${statusClass}" 
                                 data-id-ban="${ban.idBan}"
                                 data-id-hoadon="${ban.idHoaDonHienTai || ''}"
                                 data-so-ban="${ban.soBan}"
                                 data-trang-thai="${ban.trangThai}"
                                 data-ghi-chu="${ban.ghiChu || ''}"
                                 data-tong-tien="${ban.tongTienHienTai}">
                                <div class="table-icon"><i class="${statusIcon}"></i></div>
                                <h5 class="table-name">${ban.soBan}</h5>
                                <p class="table-status">${ban.trangThai}</p>
                                ${tongTienHtml}
                            </div>
                        `;
                        $container.append(tableCardHtml);
                    });

                    // Cáº­p nháº­t láº¡i tráº¡ng thÃ¡i (náº¿u bÃ n Ä‘ang chá»n bá»‹ thay Ä‘á»•i)
                    if (currentSelectedBan) {
                        const $selectedCard = $container.find(`.table-card[data-id-ban="${currentSelectedBan.idBan}"]`);
                        if ($selectedCard.length > 0) {
                            $selectedCard.addClass('selected');
                            // Cáº­p nháº­t láº¡i thÃ´ng tin panel náº¿u cáº§n
                            updatePanel($selectedCard.data());
                        } else {
                            // BÃ n Ä‘Ã£ bá»‹ xÃ³a? Reset panel
                            resetPanel();
                        }
                    }
                },
                error: function (xhr, status, error) {
                    $container.html(`<div class="alert alert-danger w-100">KhÃ´ng thá»ƒ táº£i sÆ¡ Ä‘á»“ bÃ n. Äáº£m báº£o API (localhost:5166) Ä‘ang cháº¡y. Lá»—i: ${error}</div>`);
                }
            });
        }

        // --- HÃ€M Cáº¬P NHáº¬T PANEL THAO TÃC ---
        function updatePanel(banData) {
            // 1. LÆ°u dá»¯ liá»‡u bÃ n Ä‘Ã£ chá»n (giá»‘ng _selectedBan)
            currentSelectedBan = {
                idBan: banData.idBan,
                idHoaDonHienTai: banData.idHoadon,
                soBan: banData.soBan,
                trangThai: banData.trangThai,
                ghiChu: banData.ghiChu,
                tongTienHienTai: banData.tongTien
            };

            // 2. áº¨n placeholder, hiá»‡n panel chi tiáº¿t
            $("#panelChuaChon").hide();
            $("#panelDaChon").show();

            // 3. Äiá»n thÃ´ng tin vÃ o panel
            $("#runSoBan").text(currentSelectedBan.soBan);
            $("#runTrangThai").text(currentSelectedBan.trangThai);

            if (currentSelectedBan.ghiChu) {
                $("#tbGhiChu").text(`Ghi chÃº: ${currentSelectedBan.ghiChu}`).show();
            } else {
                $("#tbGhiChu").hide();
            }

            // 4. Logic hiá»ƒn thá»‹/áº©n nÃºt (Y Há»†T WPF)
            switch (currentSelectedBan.trangThai) {
                case "Trá»‘ng":
                    $("#btnGoiMon").text("Táº¡o HÃ³a ÄÆ¡n Má»›i").prop('disabled', false);
                    $("#btnChuyenBan").prop('disabled', true);
                    $("#btnGopBan").prop('disabled', true);
                    $("#btnBaoCaoSuCo").prop('disabled', false);
                    $("#tbTongTienWrapper").hide();
                    break;
                case "CÃ³ khÃ¡ch":
                    $("#btnGoiMon").text("Gá»i MÃ³n / Thanh ToÃ¡n").prop('disabled', false);
                    $("#btnChuyenBan").prop('disabled', false);
                    $("#btnGopBan").prop('disabled', false);
                    $("#btnBaoCaoSuCo").prop('disabled', true);
                    $("#tbTongTienWrapper").show();
                    $("#runTongTien").text(currentSelectedBan.tongTienHienTai.toLocaleString('vi-VN') + " Ä‘");
                    break;
                case "ÄÃ£ Ä‘áº·t":
                    $("#btnGoiMon").text("KhÃ¡ch Ä‘áº·t (Má»Ÿ HÃ³a ÄÆ¡n)").prop('disabled', false);
                    $("#btnChuyenBan").prop('disabled', true);
                    $("#btnGopBan").prop('disabled', true);
                    $("#btnBaoCaoSuCo").prop('disabled', false);
                    $("#tbTongTienWrapper").hide();
                    break;
                case "Báº£o trÃ¬":
                case "Táº¡m ngÆ°ng":
                default:
                    $("#btnGoiMon").text("BÃ€N ÄANG Báº¢O TRÃŒ").prop('disabled', true);
                    $("#btnChuyenBan").prop('disabled', true);
                    $("#btnGopBan").prop('disabled', true);
                    $("#btnBaoCaoSuCo").prop('disabled', true);
                    $("#tbTongTienWrapper").hide();
                    break;
            }
        }

        // --- HÃ€M RESET PANEL ---
        function resetPanel() {
            currentSelectedBan = null;
            $("#panelChuaChon").show();
            $("#panelDaChon").hide();
            $(".table-card").removeClass('selected');
        }

        // --- CÃC HÃ€M Xá»¬ LÃ Sá»° KIá»†N ---

        // Táº£i láº§n Ä‘áº§u
        loadSoDoBan();
        // Tá»± Ä‘á»™ng lÃ m má»›i má»—i 30 giÃ¢y
        setInterval(loadSoDoBan, 30000);

        // Thay tháº¿ .click() báº±ng .on("click", ...)
        $("#refresh-tables-btn").on("click", loadSoDoBan);

        // --- LOGIC Má»šI: KHI CLICK VÃ€O Má»˜T BÃ€N ---
        // Thay tháº¿ .click() báº±ng .on("click", ...)
        $(document).on("click", ".table-card", function () {
            const $card = $(this);

            // Bá» chá»n táº¥t cáº£, chá»n tháº» nÃ y
            $(".table-card").removeClass('selected');
            $card.addClass('selected');

            // Láº¥y dá»¯ liá»‡u tá»« data-* vÃ  cáº­p nháº­t panel
            updatePanel($card.data());
        });

        // 1. NÃºt Gá»i MÃ³n / Táº¡o HÃ³a ÄÆ¡n
        $("#btnGoiMon").on("click", function () {
            if (!currentSelectedBan) return;

            let idHoaDon = currentSelectedBan.idHoaDonHienTai;

            // Náº¿u lÃ  bÃ n trá»‘ng, gá»i API táº¡o HÄ trÆ°á»›c
            if (currentSelectedBan.trangThai === "Trá»‘ng" || currentSelectedBan.trangThai === "ÄÃ£ Ä‘áº·t") {
                if (!currentNhanVienId) {
                    alert("Lá»—i: KhÃ´ng tÃ¬m tháº¥y ID nhÃ¢n viÃªn. Vui lÃ²ng táº£i láº¡i trang.");
                    return;
                }

                $(this).prop('disabled', true).text("Äang táº¡o HÄ...");

                $.ajax({
                    url: `${apiBaseUrl}/api/app/sodoban/createorder/${currentSelectedBan.idBan}/${currentNhanVienId}`,
                    type: 'POST',
                    success: function (result) {
                        idHoaDon = result.idHoaDon;
                        alert(`ÄÃ£ táº¡o HÃ³a Ä‘Æ¡n má»›i: ${idHoaDon}. Sáºµn sÃ ng Ä‘iá»u hÆ°á»›ng!`);
                        // TODO: Äiá»u hÆ°á»›ng Ä‘áº¿n trang chi tiáº¿t hÃ³a Ä‘Æ¡n
                        // window.location.href = `/Employee/ChiTietHoaDon?id=${idHoaDon}`;
                        loadSoDoBan(); // Táº£i láº¡i bÃ n
                        resetPanel(); // Reset panel vá» "ChÆ°a chá»n"
                    },
                    error: function (xhr) {
                        alert(`Lá»—i táº¡o hÃ³a Ä‘Æ¡n: ${xhr.responseText}`);
                        // Náº¿u lá»—i, khÃ´i phá»¥c láº¡i nÃºt
                        $("#btnGoiMon").prop('disabled', false).text("Táº¡o HÃ³a ÄÆ¡n Má»›i");
                    }
                });
            } else {
                // Náº¿u Ä‘Ã£ cÃ³ khÃ¡ch, Ä‘iá»u hÆ°á»›ng trá»±c tiáº¿p
                alert(`Sáºµn sÃ ng Ä‘iá»u hÆ°á»›ng Ä‘áº¿n trang gá»i mÃ³n cho HÃ³a Ä‘Æ¡n ID: ${idHoaDon}`);
                // TODO: Äiá»u hÆ°á»›ng
                // window.location.href = `/Employee/ChiTietHoaDon?id=${idHoaDon}`;
            }
        });

        // 2. NÃºt BÃ¡o cÃ¡o sá»± cá»‘
        $("#btnBaoCaoSuCo").on("click", function () {
            if (!currentSelectedBan || !currentNhanVienId) return;

            // DÃ¹ng prompt() thay cho InputDialogWindow
            const ghiChu = prompt(`Vui lÃ²ng mÃ´ táº£ sá»± cá»‘ cho bÃ n ${currentSelectedBan.soBan}:`);

            if (ghiChu && ghiChu.trim() !== "") {
                $(this).prop('disabled', true);

                $.ajax({
                    url: `${apiBaseUrl}/api/app/sodoban/reportproblem/${currentSelectedBan.idBan}/${currentNhanVienId}`,
                    type: 'POST',
                    contentType: 'application/json',
                    data: JSON.stringify({ ghiChuSuCo: ghiChu }),
                    success: function () {
                        alert("ÄÃ£ bÃ¡o cÃ¡o sá»± cá»‘ thÃ nh cÃ´ng. BÃ n Ä‘Ã£ Ä‘Æ°á»£c khÃ³a.");
                        loadSoDoBan(); // Táº£i láº¡i
                        resetPanel(); // Reset panel
                    },
                    error: function (xhr) {
                        alert(`Lá»—i bÃ¡o cÃ¡o: ${xhr.responseText}`);
                        $("#btnBaoCaoSuCo").prop('disabled', false); // KhÃ´i phá»¥c nÃºt náº¿u lá»—i
                    }
                });
            }
        });

        // 3. CÃ¡c nÃºt Ä‘ang phÃ¡t triá»ƒn
        $("#btnChuyenBan").on("click", function () { alert("Chá»©c nÄƒng 'Chuyá»ƒn BÃ n' Ä‘ang Ä‘Æ°á»£c phÃ¡t triá»ƒn."); });
        $("#btnGopBan").on("click", function () { alert("Chá»©c nÄƒng 'Gá»™p BÃ n' Ä‘ang Ä‘Æ°á»£c phÃ¡t triá»ƒn."); });
    }
});
e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\wwwroot\lib\
e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\wwwroot\lib\bootstrap\
e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\wwwroot\lib\bootstrap\dist\
e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\wwwroot\lib\bootstrap\dist\css\
e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\wwwroot\lib\bootstrap\dist\css\bootstrap.css.map e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\wwwroot\lib\bootstrap\dist\css\bootstrap.min.css.map e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\wwwroot\lib\bootstrap\dist\css\bootstrap.min.css e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\wwwroot\lib\bootstrap\dist\css\bootstrap.rtl.css.map e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\wwwroot\lib\bootstrap\dist\css\bootstrap.rtl.min.css.map e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\wwwroot\lib\bootstrap\dist\css\bootstrap.rtl.min.css e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\wwwroot\lib\bootstrap\dist\css\bootstrap.rtl.css e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\wwwroot\lib\bootstrap\dist\css\bootstrap.css
e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\wwwroot\lib\bootstrap\dist\css\bootstrap-grid.css.map e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\wwwroot\lib\bootstrap\dist\css\bootstrap-grid.min.css.map e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\wwwroot\lib\bootstrap\dist\css\bootstrap-grid.min.css e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\wwwroot\lib\bootstrap\dist\css\bootstrap-grid.rtl.css.map e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\wwwroot\lib\bootstrap\dist\css\bootstrap-grid.rtl.min.css.map e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\wwwroot\lib\bootstrap\dist\css\bootstrap-grid.rtl.min.css e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\wwwroot\lib\bootstrap\dist\css\bootstrap-grid.rtl.css e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\wwwroot\lib\bootstrap\dist\css\bootstrap-grid.css
e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\wwwroot\lib\bootstrap\dist\css\bootstrap-reboot.css.map e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\wwwroot\lib\bootstrap\dist\css\bootstrap-reboot.min.css.map e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\wwwroot\lib\bootstrap\dist\css\bootstrap-reboot.min.css e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\wwwroot\lib\bootstrap\dist\css\bootstrap-reboot.rtl.css.map e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\wwwroot\lib\bootstrap\dist\css\bootstrap-reboot.rtl.min.css.map e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\wwwroot\lib\bootstrap\dist\css\bootstrap-reboot.rtl.min.css e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\wwwroot\lib\bootstrap\dist\css\bootstrap-reboot.rtl.css e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\wwwroot\lib\bootstrap\dist\css\bootstrap-reboot.css
e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\wwwroot\lib\bootstrap\dist\css\bootstrap-utilities.css.map e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\wwwroot\lib\bootstrap\dist\css\bootstrap-utilities.min.css.map e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\wwwroot\lib\bootstrap\dist\css\bootstrap-utilities.min.css e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\wwwroot\lib\bootstrap\dist\css\bootstrap-utilities.rtl.css.map e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\wwwroot\lib\bootstrap\dist\css\bootstrap-utilities.rtl.min.css.map e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\wwwroot\lib\bootstrap\dist\css\bootstrap-utilities.rtl.min.css e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\wwwroot\lib\bootstrap\dist\css\bootstrap-utilities.rtl.css e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\wwwroot\lib\bootstrap\dist\css\bootstrap-utilities.css
e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\wwwroot\lib\bootstrap\dist\js\
e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\wwwroot\lib\bootstrap\dist\js\bootstrap.bundle.js.map e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\wwwroot\lib\bootstrap\dist\js\bootstrap.bundle.min.js.map e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\wwwroot\lib\bootstrap\dist\js\bootstrap.bundle.min.js e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\wwwroot\lib\bootstrap\dist\js\bootstrap.bundle.js e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\wwwroot\lib\bootstrap\dist\js\bootstrap.esm.js.map e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\wwwroot\lib\bootstrap\dist\js\bootstrap.esm.min.js.map e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\wwwroot\lib\bootstrap\dist\js\bootstrap.esm.min.js e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\wwwroot\lib\bootstrap\dist\js\bootstrap.esm.js e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\wwwroot\lib\bootstrap\dist\js\bootstrap.js.map e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\wwwroot\lib\bootstrap\dist\js\bootstrap.min.js.map e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\wwwroot\lib\bootstrap\dist\js\bootstrap.min.js e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\wwwroot\lib\bootstrap\dist\js\bootstrap.js
e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\wwwroot\lib\bootstrap\LICENSE
e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\wwwroot\lib\jquery\
e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\wwwroot\lib\jquery\dist\
e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\wwwroot\lib\jquery\dist\jquery.min.map e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\wwwroot\lib\jquery\dist\jquery.min.js e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\wwwroot\lib\jquery\dist\jquery.js
e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\wwwroot\lib\jquery\LICENSE.txt
e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\wwwroot\lib\jquery-validation\
e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\wwwroot\lib\jquery-validation\dist\
e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\wwwroot\lib\jquery-validation\dist\additional-methods.min.js e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\wwwroot\lib\jquery-validation\dist\additional-methods.js
e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\wwwroot\lib\jquery-validation\dist\jquery.validate.min.js e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\wwwroot\lib\jquery-validation\dist\jquery.validate.js
e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\wwwroot\lib\jquery-validation\LICENSE.md
e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\wwwroot\lib\jquery-validation-unobtrusive\
e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\wwwroot\lib\jquery-validation-unobtrusive\jquery.validate.unobtrusive.min.js e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\wwwroot\lib\jquery-validation-unobtrusive\jquery.validate.unobtrusive.js
e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\wwwroot\lib\jquery-validation-unobtrusive\LICENSE.txt
e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\wwwroot\favicon.ico
e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\Pages\Account\
e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\Pages\Account\DangKyView.cshtml.cs e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\Pages\Account\DangKyView.cshtml
@page "/Account/Register"
@model WebCafebookApi.Pages.Account.DangKyViewModel
@{
    ViewData["Title"] = "ÄÄƒng kÃ½";
    Layout = null; // DÃ¹ng layout riÃªng cá»§a trang Login
}

<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"] - Cafebook</title>
    <link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.min.css" />
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet" />
    <link rel="stylesheet" href="~/css/site.css" asp-append-version="true" />
</head>
<body class="login-page-body">

    <div class="login-wrapper">
        <div class="login-container">

            <div class="login-brand-col d-none d-md-flex">
                <img src="/images/logo.png" alt="Cafebook Logo">
                <h1 class="mb-2">Cafebook</h1>
                <p class="fs-5 opacity-75">Tham gia cá»™ng Ä‘á»“ng</p>
            </div>

            <div class="login-form-col">

                <h2>@ViewData["Title"]</h2>
                <p class="text-muted">Táº¡o tÃ i khoáº£n má»›i Ä‘á»ƒ Ä‘áº·t bÃ n vÃ  thuÃª sÃ¡ch.</p>

                <form id="registerForm" asp-route-returnUrl="@Model.ReturnUrl" method="post">

                    <div asp-validation-summary="ModelOnly" class="text-danger mb-2" role="alert"></div>

                    <div class="form-floating-material">
                        <input asp-for="Input.HoTen" class="form-control" aria-required="true" placeholder=" " />
                        <label asp-for="Input.HoTen"></label>
                        <span class="material-symbols-outlined">badge</span>
                        <span asp-validation-for="Input.HoTen" class="text-danger small"></span>
                    </div>

                    <div class="form-floating-material">
                        <input asp-for="Input.SoDienThoai" class="form-control" autocomplete="tel" aria-required="true" placeholder=" " />
                        <label asp-for="Input.SoDienThoai"></label>
                        <span class="material-symbols-outlined">phone</span>
                        <span asp-validation-for="Input.SoDienThoai" class="text-danger small"></span>
                    </div>

                    <div class="form-floating-material">
                        <input asp-for="Input.Email" class="form-control" autocomplete="email" aria-required="true" placeholder=" " />
                        <label asp-for="Input.Email"></label>
                        <span class="material-symbols-outlined">mail</span>
                        <span asp-validation-for="Input.Email" class="text-danger small"></span>
                    </div>

                    <div class="form-floating-material">
                        <input asp-for="Input.TenDangNhap" class="form-control" autocomplete="username" aria-required="true" placeholder=" " />
                        <label asp-for="Input.TenDangNhap">TÃªn Ä‘Äƒng nháº­p (TÃ¹y chá»n)</label>
                        <span class="material-symbols-outlined">person</span>
                        <span asp-validation-for="Input.TenDangNhap" class="text-danger small"></span>
                    </div>

                    <div class="form-floating-material">
                        <input asp-for="Input.Password" class="form-control" type="password" autocomplete="new-password" aria-required="true" placeholder=" " />
                        <label asp-for="Input.Password"></label>
                        <span class="material-symbols-outlined">lock</span>
                        <span asp-validation-for="Input.Password" class="text-danger small"></span>
                    </div>

                    <div class="form-floating-material">
                        <input asp-for="Input.ConfirmPassword" class="form-control" type="password" autocomplete="new-password" aria-required="true" placeholder=" " />
                        <label asp-for="Input.ConfirmPassword"></label>
                        <span class="material-symbols-outlined">password</span>
                        <span asp-validation-for="Input.ConfirmPassword" class="text-danger small"></span>
                    </div>

                    <div>
                        <button id="registerSubmit" type="submit" class="w-100 btn btn-lg btn-primary">ÄÄƒng kÃ½</button>
                    </div>

                    <div class="mt-4 text-center">
                        <p class="text-muted mb-0">
                            ÄÃ£ cÃ³ tÃ i khoáº£n?
                            <a asp-page="/account/DangNhapView">Quay láº¡i ÄÄƒng nháº­p</a>
                        </p>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <partial name="_ValidationScriptsPartial" />
    <script src="~/lib/jquery/dist/jquery.min.js"></script>
    <script src="~/lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\Pages\Account\DangKyView.cshtml.cs
using System.ComponentModel.DataAnnotations;
using System.Security.Claims;
using CafebookModel.Model.ModelApi; // ThÃªm
using CafebookModel.Model.ModelWeb; // ThÃªm
using Microsoft.AspNetCore.Authentication;
using Microsoft.AspNetCore.Authentication.Cookies;
using Microsoft.AspNetCore.Mvc;
using Microsoft.AspNetCore.Mvc.RazorPages;
using System.Net.Http.Json; // ThÃªm

// XÃ“A CÃC USING LIÃŠN QUAN Äáº¾N DbContext VÃ€ ENTITIES
// using Microsoft.EntityFrameworkCore;
// using CafebookModel.Model.Entities;

namespace WebCafebookApi.Pages.Account
{
    public class DangKyViewModel : PageModel
    {
        // Sá»¬A Lá»–I CS0246: XÃ³a DbContext, dÃ¹ng HttpClientFactory
        private readonly IHttpClientFactory _httpClientFactory;
        public DangKyViewModel(IHttpClientFactory httpClientFactory)
        {
            _httpClientFactory = httpClientFactory;
        }

        // Sá»¬A Lá»–I CS8618: Khá»Ÿi táº¡o Input
        [BindProperty]
        public InputModel Input { get; set; } = new();

        // Sá»¬A Lá»–I CS8618: DÃ¹ng string? vÃ  khá»Ÿi táº¡o
        public string? ReturnUrl { get; set; }

        public class InputModel
        {
            // Sá»¬A Lá»–I CS8618: Khá»Ÿi táº¡o string
            [Required(ErrorMessage = "Vui lÃ²ng nháº­p há» tÃªn")]
            [Display(Name = "Há» vÃ  TÃªn")]
            public string HoTen { get; set; } = string.Empty;

            [Required(ErrorMessage = "Vui lÃ²ng nháº­p SÄT")]
            [Phone(ErrorMessage = "Sá»‘ Ä‘iá»‡n thoáº¡i khÃ´ng há»£p lá»‡")]
            [Display(Name = "Sá»‘ Ä‘iá»‡n thoáº¡i")]
            public string SoDienThoai { get; set; } = string.Empty;

            [Required(ErrorMessage = "Vui lÃ²ng nháº­p Email")]
            [EmailAddress(ErrorMessage = "Email khÃ´ng há»£p lá»‡")]
            [Display(Name = "Email")]
            public string Email { get; set; } = string.Empty;

            [Display(Name = "TÃªn Ä‘Äƒng nháº­p")]
            public string? TenDangNhap { get; set; } // Nullable lÃ  OK

            [Required(ErrorMessage = "Vui lÃ²ng nháº­p máº­t kháº©u")]
            [StringLength(100, ErrorMessage = "{0} pháº£i dÃ i tá»« {2} Ä‘áº¿n {1} kÃ½ tá»±.", MinimumLength = 6)]
            [DataType(DataType.Password)]
            [Display(Name = "Máº­t kháº©u")]
            public string Password { get; set; } = string.Empty;

            [DataType(DataType.Password)]
            [Display(Name = "XÃ¡c nháº­n máº­t kháº©u")]
            [Compare("Password", ErrorMessage = "Máº­t kháº©u vÃ  máº­t kháº©u xÃ¡c nháº­n khÃ´ng khá»›p.")]
            public string ConfirmPassword { get; set; } = string.Empty;
        }

        public void OnGet(string? returnUrl = null) // Sá»­a lá»—i CS8625
        {
            ReturnUrl = returnUrl;
        }

        public async Task<IActionResult> OnPostAsync(string? returnUrl = null) // Sá»­a lá»—i CS8625
        {
            returnUrl ??= Url.Content("~/");
            if (!ModelState.IsValid)
            {
                return Page();
            }

            // Gá»ŒI API ÄÄ‚NG KÃ
            var httpClient = _httpClientFactory.CreateClient();
            var apiRequest = new DangKyRequestModel
            {
                HoTen = Input.HoTen,
                Email = Input.Email,
                SoDienThoai = Input.SoDienThoai,
                TenDangNhap = Input.TenDangNhap,
                Password = Input.Password
            };

            var response = await httpClient.PostAsJsonAsync("http://localhost:5166/api/web/taikhoankhach/register", apiRequest);

            if (response.IsSuccessStatusCode)
            {
                var apiResponse = await response.Content.ReadFromJsonAsync<WebLoginResponseModel>();

                if (apiResponse != null && apiResponse.Success && apiResponse.KhachHangData != null)
                {
                    // Tá»° Äá»˜NG ÄÄ‚NG NHáº¬P SAU KHI ÄÄ‚NG KÃ
                    var user = apiResponse.KhachHangData;
                    var claims = new List<Claim>
                    {
                        new Claim(ClaimTypes.NameIdentifier, user.IdKhachHang.ToString()),
                        new Claim(ClaimTypes.Name, user.TenDangNhap ?? user.Email ?? ""),
                        new Claim(ClaimTypes.GivenName, user.HoTen),
                        new Claim(ClaimTypes.Email, user.Email ?? ""),
                        new Claim(ClaimTypes.MobilePhone, user.SoDienThoai ?? ""),
                        new Claim(ClaimTypes.Role, "KhachHang")
                    };

                    var claimsIdentity = new ClaimsIdentity(claims, CookieAuthenticationDefaults.AuthenticationScheme);
                    await HttpContext.SignInAsync(
                        CookieAuthenticationDefaults.AuthenticationScheme,
                        new ClaimsPrincipal(claimsIdentity));

                    return LocalRedirect(returnUrl);
                }
                else
                {
                    // Hiá»ƒn thá»‹ lá»—i tá»« API (vÃ­ dá»¥: "Email Ä‘Ã£ tá»“n táº¡i")
                    ModelState.AddModelError(string.Empty, apiResponse?.Message ?? "Lá»—i Ä‘Äƒng kÃ½.");
                    return Page();
                }
            }

            ModelState.AddModelError(string.Empty, "KhÃ´ng thá»ƒ káº¿t ná»‘i mÃ¡y chá»§ Ä‘Äƒng kÃ½.");
            return Page();
        }
    }
}
e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\Pages\Account\DangNhapView.cshtml.cs e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\Pages\Account\DangNhapView.cshtml
@page "/Account/Login"
@model WebCafebookApi.Pages.Account.DangNhapViewModel
@{
    ViewData["Title"] = "ÄÄƒng nháº­p";
    // ChÃºng ta sáº½ khÃ´ng dÃ¹ng Layout chÃ­nh cho trang Ä‘Äƒng nháº­p
    Layout = null;
}

<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"] - Cafebook</title>
    <link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.min.css" />
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet" />
    <link rel="stylesheet" href="~/css/site.css" asp-append-version="true" />
</head>
<body class="login-page-body">

    <div class="login-wrapper">
        <div class="login-container">

            <div class="login-brand-col d-none d-md-flex">
                <img src="/images/logo.png" alt="Cafebook Logo">
                <h1 class="mb-2">Cafebook</h1>
                <p class="fs-5 opacity-75">Awaken your senses</p>
            </div>

            <div class="login-form-col">
                <a asp-page="/TrangChuView" class="text-decoration-none mb-3" style="align-self: flex-start;">
                    <span class="material-symbols-outlined" style="vertical-align: middle;">arrow_back</span>
                    Vá» Trang Chá»§
                </a>

                <h2>@ViewData["Title"]</h2>
                <p class="text-muted">ChÃ o má»«ng trá»Ÿ láº¡i! Vui lÃ²ng nháº­p thÃ´ng tin cá»§a báº¡n.</p>

                <form id="account" method="post">

                    <div asp-validation-summary="ModelOnly" class="text-danger mb-2" role="alert"></div>

                    <div class="form-floating-material">
                        <input asp-for="Input.LoginIdentifier" class="form-control" autocomplete="username" aria-required="true" placeholder=" " />
                        <label asp-for="Input.LoginIdentifier" class="form-label">Email, Username hoáº·c SÄT</label>
                        <span class="material-symbols-outlined">person</span>
                        <span asp-validation-for="Input.LoginIdentifier" class="text-danger small"></span>
                    </div>

                    <div class="form-floating-material">
                        <input asp-for="Input.Password" type="password" class="form-control" autocomplete="current-password" aria-required="true" placeholder=" " />
                        <label asp-for="Input.Password" class="form-label">Máº­t kháº©u</label>
                        <span class="material-symbols-outlined">lock</span>
                        <span asp-validation-for="Input.Password" class="text-danger small"></span>
                    </div>

                    <div class="d-flex justify-content-between align-items-center mb-3">
                        <div class="form-check">
                            <input class="form-check-input" asp-for="Input.RememberMe" />
                            <label asp-for="Input.RememberMe" class="form-check-label small">
                                @Html.DisplayNameFor(m => m.Input.RememberMe)
                            </label>
                        </div>
                        <a asp-page="/account/QuenMatKhauView" class="small">QuÃªn máº­t kháº©u?</a>
                    </div>

                    <div>
                        <button id="login-submit" type="submit" class="w-100 btn btn-lg btn-primary">ÄÄƒng nháº­p</button>
                    </div>

                    <div class="mt-4 text-center">
                        <p class="text-muted mb-0">
                            ChÆ°a cÃ³ tÃ i khoáº£n?
                            <a asp-page="/account/DangKyView" asp-route-returnUrl="@Model.ReturnUrl">ÄÄƒng kÃ½ ngay</a>
                        </p>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <partial name="_ValidationScriptsPartial" />
    <script src="~/lib/jquery/dist/jquery.min.js"></script>
    <script src="~/lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\Pages\Account\DangNhapView.cshtml.cs
using System.ComponentModel.DataAnnotations;
using System.Security.Claims;
using CafebookModel.Model.ModelApi; // ThÃªm
using Microsoft.AspNetCore.Authentication;
using Microsoft.AspNetCore.Authentication.Cookies;
using Microsoft.AspNetCore.Mvc;
using Microsoft.AspNetCore.Mvc.RazorPages;
using System.Net.Http.Json; // ThÃªm

namespace WebCafebookApi.Pages.Account
{
    public class DangNhapViewModel : PageModel
    {
        // 1. XÃ“A DbContext, THAY Báº°NG HttpClientFactory
        private readonly IHttpClientFactory _httpClientFactory;

        public DangNhapViewModel(IHttpClientFactory httpClientFactory)
        {
            _httpClientFactory = httpClientFactory;
        }

        [BindProperty]
        public InputModel Input { get; set; } = new();

        public string? ReturnUrl { get; set; }

        [TempData]
        public string? ErrorMessage { get; set; }

        public class InputModel
        {
            [Required(ErrorMessage = "Vui lÃ²ng nháº­p TÃªn Ä‘Äƒng nháº­p, Email hoáº·c SÄT")]
            [Display(Name = "TÃªn Ä‘Äƒng nháº­p, Email hoáº·c SÄT")]
            public string LoginIdentifier { get; set; } = string.Empty;

            [Required(ErrorMessage = "Vui lÃ²ng nháº­p Máº­t kháº©u")]
            [DataType(DataType.Password)]
            [Display(Name = "Máº­t kháº©u")]
            public string Password { get; set; } = string.Empty;

            [Display(Name = "Ghi nhá»› Ä‘Äƒng nháº­p")]
            public bool RememberMe { get; set; }
        }

        public async Task OnGetAsync(string? returnUrl = null)
        {
            if (!string.IsNullOrEmpty(ErrorMessage))
            {
                ModelState.AddModelError(string.Empty, ErrorMessage);
            }
            returnUrl ??= Url.Content("~/");
            await HttpContext.SignOutAsync(CookieAuthenticationDefaults.AuthenticationScheme);
            ReturnUrl = returnUrl;
        }

        public async Task<IActionResult> OnPostAsync(string? returnUrl = null)
        {
            returnUrl ??= Url.Content("~/");
            if (!ModelState.IsValid)
            {
                return Page();
            }

            // 2. Táº O YÃŠU Cáº¦U Gá»ŒI API
            var httpClient = _httpClientFactory.CreateClient();
            var apiRequest = new LoginRequestModel
            {
                TenDangNhap = Input.LoginIdentifier,
                MatKhau = Input.Password
            };

            // Láº¥y URL cá»§a API (giáº£ sá»­ lÃ  localhost:5166)
            var response = await httpClient.PostAsJsonAsync("http://localhost:5166/api/web/taikhoankhach/login", apiRequest);

            if (response.IsSuccessStatusCode)
            {
                var apiResponse = await response.Content.ReadFromJsonAsync<WebLoginResponseModel>();

                if (apiResponse != null && apiResponse.Success && apiResponse.KhachHangData != null)
                {
                    // 3. ÄÄ‚NG NHáº¬P THÃ€NH CÃ”NG -> Táº O COOKIE
                    var user = apiResponse.KhachHangData;
                    var claims = new List<Claim>
                    {
                        new Claim(ClaimTypes.NameIdentifier, user.IdKhachHang.ToString()),
                        new Claim(ClaimTypes.Name, user.TenDangNhap ?? user.Email ?? ""),
                        new Claim(ClaimTypes.GivenName, user.HoTen),
                        new Claim(ClaimTypes.Email, user.Email ?? ""),
                        new Claim(ClaimTypes.MobilePhone, user.SoDienThoai ?? ""),
                        new Claim(ClaimTypes.Role, "KhachHang") // GÃ¡n Role
                    };

                    var claimsIdentity = new ClaimsIdentity(claims, CookieAuthenticationDefaults.AuthenticationScheme);
                    var authProperties = new AuthenticationProperties { IsPersistent = Input.RememberMe };

                    await HttpContext.SignInAsync(
                        CookieAuthenticationDefaults.AuthenticationScheme,
                        new ClaimsPrincipal(claimsIdentity),
                        authProperties);

                    // 4. LÆ¯U AVATAR (Máº·c Ä‘á»‹nh, vÃ¬ KhachHang khÃ´ng cÃ³)
                    HttpContext.Session.SetString("AvatarBase64", "");

                    return LocalRedirect(returnUrl);
                }
                else
                {
                    ModelState.AddModelError(string.Empty, apiResponse?.Message ?? "Lá»—i khÃ´ng xÃ¡c Ä‘á»‹nh tá»« API.");
                    return Page();
                }
            }

            ModelState.AddModelError(string.Empty, "KhÃ´ng thá»ƒ káº¿t ná»‘i Ä‘áº¿n mÃ¡y chá»§ Ä‘Äƒng nháº­p.");
            return Page();
        }
    }
}
e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\Pages\Account\DangXuat.cshtml.cs e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\Pages\Account\DangXuat.cshtml
@page
@model WebCafebookApi.Pages.Account.DangXuatModel
@{
    // Trang nÃ y khÃ´ng cáº§n hiá»ƒn thá»‹ gÃ¬ Ä‘áº·c biá»‡t,
    // chá»‰ cáº§n Ä‘á»ƒ PageModel xá»­ lÃ½ logic Ä‘Äƒng xuáº¥t trong OnPost.
    ViewData["Title"] = "ÄÄƒng xuáº¥t";
}

<header>
    <h1>@ViewData["Title"]</h1>
    <p>Báº¡n Ä‘Ã£ Ä‘Äƒng xuáº¥t thÃ nh cÃ´ng.</p>
    @* CÃ³ thá»ƒ thÃªm nÃºt quay láº¡i trang chá»§ *@
    <a asp-page="/TrangChuView">Quay láº¡i Trang Chá»§</a>
</header>
using System.Threading.Tasks;
using Microsoft.AspNetCore.Authentication;
using Microsoft.AspNetCore.Authentication.Cookies;
using Microsoft.AspNetCore.Mvc;
using Microsoft.AspNetCore.Mvc.RazorPages;

namespace WebCafebookApi.Pages.Account
{
    public class DangXuatModel : PageModel
    {
        // Sá»­a lá»—i CS8625: string -> string?
        public async Task<IActionResult> OnPostAsync(string? returnUrl = null)
        {
            await HttpContext.SignOutAsync(CookieAuthenticationDefaults.AuthenticationScheme);
            HttpContext.Session.Clear();

            if (returnUrl != null)
            {
                return LocalRedirect(returnUrl);
            }
            else
            {
                return RedirectToPage("/TrangChuView");
            }
        }

        public async Task<IActionResult> OnGetAsync(string? returnUrl = null) // Sá»­a lá»—i CS8625
        {
            return await OnPostAsync(returnUrl);
        }
    }
}
e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\Pages\Account\QuenMatKhauView.cshtml.cs e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\Pages\Account\QuenMatKhauView.cshtml
@page
@model WebCafebookApi.Pages.Account.QuenMatKhauViewModel
@{
}
e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\Pages\Account\QuenMatKhauView.cshtml.cs
using Microsoft.AspNetCore.Mvc;
using Microsoft.AspNetCore.Mvc.RazorPages;

namespace WebCafebookApi.Pages.Account
{
    public class QuenMatKhauViewModel : PageModel
    {
        public void OnGet()
        {
        }
    }
}
e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\Pages\employee\
e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\Pages\employee\_Layout_Employee.cshtml
@using System.Security.Claims
<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"] - Quáº£n lÃ½ Cafebook</title>
    <link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="~/css/site.css" asp-append-version="true" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" />

    @await RenderSectionAsync("Styles", required: false)
</head>
<body class="employee-body">
    <div class="d-flex">

        <nav class="sidebar-nav bg-dark">
            <div class="sidebar-header">
                <a class="navbar-brand text-white fs-4" asp-page="/employee/WebQuanLyView">
                    <i class="fa-solid fa-mug-hot"></i> Cafebook
                </a>
            </div>

            <ul class="nav flex-column">
                <li class="nav-item">
                    <a class="nav-link" asp-page="/Employee/WebQuanLyView">
                        <i class="fa-solid fa-chart-line"></i> Tá»•ng quan
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link active" asp-page="/Employee/SoDoBanView">
                        <i class="fa-solid fa-border-all"></i> SÆ¡ Äá»“ BÃ n
                    </a>
                </li>
            </ul>
        </nav>

        <div class="main-content flex-grow-1">
            <header class="header-nav shadow-sm">
                <span class="navbar-text">
                    Xin chÃ o, @(User.FindFirstValue(ClaimTypes.GivenName) ?? User.Identity.Name)!
                </span>
                <form method="post" asp-page="/employee/DangXuat">
                    <button type="submit" class="btn btn-link nav-link text-danger">
                        <i class="fa-solid fa-right-from-bracket"></i> ÄÄƒng xuáº¥t
                    </button>
                </form>
            </header>

            <main role="main" class="p-4">
                @RenderBody()
            </main>
        </div>
    </div>

    <script src="~/lib/jquery/dist/jquery.min.js"></script>
    <script src="~/lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
    <script src="~/js/site.js" asp-append-version="true"></script>

    @await RenderSectionAsync("Scripts", required: false)
</body>
</html>
e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\Pages\employee\_ViewStart.cshtml
@{
    Layout = "_Layout_Employee";
}
e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\Pages\employee\DangNhapEmployee.cshtml.cs e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\Pages\employee\DangNhapEmployee.cshtml
@page "/Employee/Login"
@model WebCafebookApi.Pages.employee.DangNhapEmployeeModel
@{
    ViewData["Title"] = "ÄÄƒng nháº­p NhÃ¢n viÃªn";
    Layout = null; // DÃ¹ng layout riÃªng cá»§a trang Login
}

<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"] - Cafebook</title>
    <link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.min.css" />
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet" />
    <link rel="stylesheet" href="~/css/site.css" asp-append-version="true" />
</head>
<body class="login-page-body">

    <div class="login-wrapper" style="max-width: 450px;">
        <div class="login-container" style="flex-direction: column;">

            <div class="login-form-col">
                <a asp-page="/Index" class="text-decoration-none mb-3" style="align-self: flex-start;">
                    <span class="material-symbols-outlined" style="vertical-align: middle;">arrow_back</span>
                    Vá» Trang Chá»§
                </a>

                <h2 class="text-center">@ViewData["Title"]</h2>
                <p class="text-muted text-center">Sá»­ dá»¥ng tÃ i khoáº£n ná»™i bá»™ cá»§a báº¡n.</p>

                <form id="account" method="post">

                    @if (!string.IsNullOrEmpty(Model.ErrorMessage))
                    {
                        <div class="alert alert-danger" role="alert">@Model.ErrorMessage</div>
                    }
                    <div asp-validation-summary="ModelOnly" class="text-danger mb-2" role="alert"></div>

                    <div class="form-floating-material">
                        <input asp-for="Input.TenDangNhap" class="form-control" autocomplete="username" aria-required="true" placeholder=" " />
                        <label asp-for="Input.TenDangNhap">TÃ i khoáº£n (Username, Email hoáº·c SÄT)</label>
                        <span class="material-symbols-outlined">shield_person</span>
                        <span asp-validation-for="Input.TenDangNhap" class="text-danger small"></span>
                    </div>

                    <div class="form-floating-material">
                        <input asp-for="Input.MatKhau" type="password" class="form-control" autocomplete="current-password" aria-required="true" placeholder=" " />
                        <label asp-for="Input.MatKhau">Máº­t kháº©u</label>
                        <span class="material-symbols-outlined">lock</span>
                        <span asp-validation-for="Input.MatKhau" class="text-danger small"></span>
                    </div>

                    <div>
                        <button id="login-submit" type="submit" class="w-100 btn btn-lg btn-primary">ÄÄƒng nháº­p</button>
                    </div>

                </form>
            </div>
        </div>
    </div>

    <partial name="_ValidationScriptsPartial" />
    <script src="~/lib/jquery/dist/jquery.min.js"></script>
    <script src="~/lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\Pages\employee\DangNhapEmployee.cshtml.cs
using System.ComponentModel.DataAnnotations;
using System.Security.Claims;
using CafebookModel.Model.ModelApi; // ThÃªm
using Microsoft.AspNetCore.Authentication;
using Microsoft.AspNetCore.Authentication.Cookies;
using Microsoft.AspNetCore.Mvc;
using Microsoft.AspNetCore.Mvc.RazorPages;
using System.Net.Http.Json; // ThÃªm
using CafebookModel.Model.Data; // ThÃªm

namespace WebCafebookApi.Pages.employee
{
    public class DangNhapEmployeeModel : PageModel
    {
        private readonly IHttpClientFactory _httpClientFactory;

        public DangNhapEmployeeModel(IHttpClientFactory httpClientFactory)
        {
            _httpClientFactory = httpClientFactory;
        }

        [BindProperty]
        public InputModel Input { get; set; } = new();

        [TempData]
        public string? ErrorMessage { get; set; }

        public class InputModel
        {
            [Required(ErrorMessage = "Vui lÃ²ng nháº­p tÃ i khoáº£n")]
            public string TenDangNhap { get; set; } = string.Empty;

            [Required(ErrorMessage = "Vui lÃ²ng nháº­p máº­t kháº©u")]
            [DataType(DataType.Password)]
            public string MatKhau { get; set; } = string.Empty;
        }

        public async Task OnGetAsync()
        {
            await HttpContext.SignOutAsync(CookieAuthenticationDefaults.AuthenticationScheme);
        }

        public async Task<IActionResult> OnPostAsync()
        {
            if (!ModelState.IsValid)
            {
                return Page();
            }

            var httpClient = _httpClientFactory.CreateClient();
            var apiRequest = new LoginRequestModel
            {
                TenDangNhap = Input.TenDangNhap,
                MatKhau = Input.MatKhau
            };

            var response = await httpClient.PostAsJsonAsync("http://localhost:5166/api/web/taikhoannv/login", apiRequest);

            if (response.IsSuccessStatusCode)
            {
                var apiResponse = await response.Content.ReadFromJsonAsync<WebLoginResponseModel>();

                if (apiResponse != null && apiResponse.Success && apiResponse.NhanVienData != null)
                {
                    var user = apiResponse.NhanVienData;
                    var claims = new List<Claim>
                    {
                        new Claim(ClaimTypes.NameIdentifier, user.IdNhanVien.ToString()),
                        new Claim(ClaimTypes.Name, user.HoTen ?? ""),
                        new Claim(ClaimTypes.GivenName, user.HoTen ?? ""),
                        new Claim(ClaimTypes.Role, user.TenVaiTro ?? "NhanVien")
                    };

                    foreach (var quyen in user.DanhSachQuyen)
                    {
                        claims.Add(new Claim("Permission", quyen));
                    }

                    var claimsIdentity = new ClaimsIdentity(claims, CookieAuthenticationDefaults.AuthenticationScheme);
                    var authProperties = new AuthenticationProperties { ExpiresUtc = DateTimeOffset.UtcNow.AddHours(8) };

                    await HttpContext.SignInAsync(
                        CookieAuthenticationDefaults.AuthenticationScheme,
                        new ClaimsPrincipal(claimsIdentity),
                        authProperties);

                    HttpContext.Session.SetString("AvatarBase64", user.AnhDaiDien ?? "");

                    // Chuyá»ƒn hÆ°á»›ng Ä‘áº¿n trang Dashboard
                    return LocalRedirect(Url.Content("~/Employee/Dashboard"));
                }
                else
                {
                    ErrorMessage = apiResponse?.Message ?? "Lá»—i khÃ´ng xÃ¡c Ä‘á»‹nh tá»« API.";
                    return Page();
                }
            }

            ErrorMessage = "KhÃ´ng thá»ƒ káº¿t ná»‘i Ä‘áº¿n mÃ¡y chá»§ Ä‘Äƒng nháº­p.";
            return Page();
        }
    }
}
e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\Pages\employee\DangXuat.cshtml.cs e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\Pages\employee\DangXuat.cshtml
@page "/Employee/Logout"
@model WebCafebookApi.Pages.employee.DangXuatModel
@{
    ViewData["Title"] = "ÄÄƒng xuáº¥t";
}
<p>Äang Ä‘Äƒng xuáº¥t...</p>
e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\Pages\employee\DangXuat.cshtml.cs
using CafebookApi.Data;
using CafebookModel.Model.ModelWeb;
using Microsoft.AspNetCore.Authentication;
using Microsoft.AspNetCore.Authentication.Cookies;
using Microsoft.AspNetCore.Mvc;
using Microsoft.AspNetCore.Mvc.RazorPages;
using System.Threading.Tasks;

namespace WebCafebookApi.Pages.employee
{
    public class DangXuatModel : PageModel
    {
        public async Task<IActionResult> OnPostAsync()
        {
            await HttpContext.SignOutAsync(CookieAuthenticationDefaults.AuthenticationScheme);
            HttpContext.Session.Clear();
            return RedirectToPage("/Employee/DangNhapEmployee");
        }

        public async Task<IActionResult> OnGetAsync()
        {
            return await OnPostAsync();
        }
    }
}
e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\Pages\employee\SoDoBanView.cshtml.cs e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\Pages\employee\SoDoBanView.cshtml
@page "/Employee/SoDoBan"
@model WebCafebookApi.Pages.employee.SoDoBanViewModel
@{
    ViewData["Title"] = "SÆ¡ Äá»“ BÃ n";
    Layout = "_Layout_Employee";
}

@if (!string.IsNullOrEmpty(Model.ErrorMessage))
{
    <div class="alert alert-danger">@Model.ErrorMessage</div>
}
else
{
    <div class="row g-3">
        <div class="col-lg-8">
            <div class="d-flex justify-content-between align-items-center mb-3">
                <h1 class="h3 mb-0 text-gray-800">@ViewData["Title"]</h1>

                <div class="d-none d-md-flex">
                    <div class="me-3"><span class="status-box status-trong"></span> Trá»‘ng</div>
                    <div class="me-3"><span class="status-box status-co-khach"></span> CÃ³ khÃ¡ch</div>
                    <div class="me-3"><span class="status-box status-da-dat"></span> ÄÃ£ Ä‘áº·t</div>
                    <div class="me-3"><span class="status-box status-bao-tri"></span> Báº£o trÃ¬</div>
                </div>
            </div>

            <div id="table-layout-container" class="d-flex flex-wrap" data-nhanvien-id="@Model.NhanVienId">
                <div class="text-center w-100 p-5">
                    <div class="spinner-border text-primary" role="status">
                        <span class="visually-hidden">Äang táº£i...</span>
                    </div>
                    <p>Äang táº£i sÆ¡ Ä‘á»“ bÃ n...</p>
                </div>
            </div>
        </div>

        <div class="col-lg-4">
            <div class="card shadow-sm" style="position: sticky; top: 80px;">
                <div class="card-body p-4">

                    <div id="panelChuaChon" class="text-center p-5">
                        <i class="fa-solid fa-hand-pointer fa-3x text-muted mb-3"></i>
                        <h5 class="text-muted">Chá»n má»™t bÃ n Ä‘á»ƒ báº¯t Ä‘áº§u thao tÃ¡c</h5>
                    </div>

                    <div id="panelDaChon" style="display: none;">
                        <h3 class="fw-bold" style="color: var(--cf-brown);">
                            BÃ n <span id="runSoBan">...</span>
                        </h3>
                        <p class="fs-5 mb-2">Tráº¡ng thÃ¡i: <span id="runTrangThai" class="fw-bold">...</span></p>
                        <p id="tbGhiChu" class="fst-italic text-muted" style="display: none;"></p>

                        <div id="tbTongTienWrapper" class="alert alert-danger" style="display: none;">
                            <span class="fs-5">Tá»•ng tiá»n táº¡m tÃ­nh:</span><br />
                            <span id="runTongTien" class="fs-3 fw-bold">0 Ä‘</span>
                        </div>

                        <hr class="my-3" />

                        <div class="d-grid gap-3">
                            <button id="btnGoiMon" class="btn btn-primary btn-lg p-3">
                                <i class="fa-solid fa-utensils me-2"></i>
                                <span>Gá»i MÃ³n / Thanh ToÃ¡n</span>
                            </button>

                            <div class="row g-3">
                                <div class="col-6 d-grid">
                                    <button id="btnChuyenBan" class="btn btn-outline-secondary p-3">
                                        <i class="fa-solid fa-right-left me-1"></i> Chuyá»ƒn BÃ n
                                    </button>
                                </div>
                                <div class="col-6 d-grid">
                                    <button id="btnGopBan" class="btn btn-outline-secondary p-3">
                                        <i class="fa-solid fa-object-ungroup me-1"></i> Gá»™p BÃ n
                                    </button>
                                </div>
                            </div>

                            <button id="btnBaoCaoSuCo" class="btn btn-outline-warning p-3">
                                <i class="fa-solid fa-triangle-exclamation me-2"></i> BÃ¡o cÃ¡o Sá»± cá»‘
                            </button>

                            <button id="refresh-tables-btn" class="btn btn-link text-muted mt-3">
                                <i class="fa-solid fa-sync"></i> LÃ m má»›i SÆ¡ Ä‘á»“
                            </button>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>
}

@section Styles {
    <style>
        .table-card {
            border: 3px solid transparent;
        }

            .table-card.selected {
                border-color: var(--cf-orange) !important;
                box-shadow: 0 8px 20px rgba(210, 125, 45, 0.5) !important;
            }
    </style>
}

@section Scripts {
}
e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\Pages\employee\SoDoBanView.cshtml.cs
using Microsoft.AspNetCore.Mvc;
using Microsoft.AspNetCore.Mvc.RazorPages;
using System.Security.Claims; // Cáº§n dÃ¹ng Ä‘á»ƒ láº¥y ID

namespace WebCafebookApi.Pages.employee
{
    // Giáº£ Ä‘á»‹nh báº¡n Ä‘Ã£ cáº¥u hÃ¬nh Authorize cho thÆ° má»¥c /employee
    public class SoDoBanViewModel : PageModel
    {
        public int NhanVienId { get; set; }
        public string? ErrorMessage { get; set; }

        public IActionResult OnGet()
        {
            var idNhanVienStr = User.FindFirstValue(ClaimTypes.NameIdentifier);
            if (string.IsNullOrEmpty(idNhanVienStr) || !int.TryParse(idNhanVienStr, out var id))
            {
                // Náº¿u khÃ´ng cÃ³ cookie, Ä‘Ã¡ vá» trang Ä‘Äƒng nháº­p
                return RedirectToPage("/Employee/DangNhapEmployee");
            }

            // GÃ¡n ID nhÃ¢n viÃªn Ä‘á»ƒ .cshtml cÃ³ thá»ƒ Ä‘á»c
            NhanVienId = id;
            return Page();
        }
    }
}
e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\Pages\employee\WebQuanLyView.cshtml.cs e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\Pages\employee\WebQuanLyView.cshtml
@page "/Employee/Dashboard"
@model WebCafebookApi.Pages.employee.WebQuanLyViewModel
@{
    ViewData["Title"] = "Báº£ng Ä‘iá»u khiá»ƒn";
    Layout = "_Layout_Employee"; // <-- Sá»­ dá»¥ng layout nhÃ¢n viÃªn

    // Logic xá»­ lÃ½ áº£nh Base64 (giá»‘ng _LoginPartial)
    var avatarSrc = string.IsNullOrEmpty(Model.DashboardData.AnhDaiDien)
        ? "/images/default-avatar.png"
        : $"data:image/png;base64,{Model.DashboardData.AnhDaiDien}";
}

@if (!string.IsNullOrEmpty(Model.ErrorMessage))
{
    <div class="alert alert-danger">@Model.ErrorMessage</div>
}
else
{
    <div class="row g-4">
        <div class="col-lg-4 col-md-5">
            <div class="card h-100">
                <div class="card-body text-center d-flex flex-column justify-content-center align-items-center p-4">
                    <img src="@avatarSrc" alt="Avatar" class="rounded-circle mb-3 shadow-sm" style="width: 120px; height: 120px; object-fit: cover;" />
                    <h3 class="card-title fw-bold mb-1">@Model.DashboardData.HoTen</h3>
                    <p class="card-text text-muted fs-5 mb-3">@Model.DashboardData.VaiTro</p>
                    <hr class="w-100" />
                    <p class="card-text fs-5 mb-0">
                        <strong class="text-uppercase">Ca lÃ m viá»‡c hÃ´m nay:</strong>
                        <br />
                        <span class="fw-bold fs-4" style="color: var(--cf-orange);">
                            @(Model.DashboardData.CaHienTai ?? "...")
                        </span>
                    </p>
                </div>
            </div>
        </div>

        <div class="col-lg-8 col-md-7">
            <div class="row g-4 mb-4">
                <div class="col-md-6">
                    <div class="card h-100">
                        <div class="card-body text-center p-4">
                            <i class="fa-solid fa-users fa-3x mb-3 text-danger"></i>
                            <h1 class="display-3 fw-bold mb-0" style="color: var(--cf-dark-brown);">@Model.DashboardData.TongBanDangPhucVu</h1>
                            <p class="card-text fs-5 text-muted mb-0">BÃ n Äang Phá»¥c Vá»¥</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="card h-100">
                        <div class="card-body text-center p-4">
                            <i class="fa-solid fa-file-invoice fa-3x mb-3 text-primary"></i>
                            <h1 class="display-3 fw-bold mb-0" style="color: var(--cf-dark-brown);">@Model.DashboardData.TongDonDangXuLy</h1>
                            <p class="card-text fs-5 text-muted mb-0">ÄÆ¡n Äang Xá»­ LÃ½</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="d-grid">
                <a asp-page="/Employee/SoDoBanView" class="btn btn-primary btn-lg p-4">
                    <i class="fas fa-border-all me-2"></i> Báº¯t Ä‘áº§u lÃ m viá»‡c (SÆ¡ Äá»“ BÃ n)
                </a>
            </div>
        </div>
    </div>
}

@section Styles {
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" />
}
e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\Pages\employee\WebQuanLyView.cshtml.cs
using CafebookModel.Model.ModelWeb;
using Microsoft.AspNetCore.Mvc;
using Microsoft.AspNetCore.Mvc.RazorPages;
using System.Net.Http.Json;
using System.Security.Claims;
using System.Threading.Tasks;

namespace WebCafebookApi.Pages.employee
{
    // Giáº£ Ä‘á»‹nh báº¡n Ä‘Ã£ cáº¥u hÃ¬nh Authorize cho thÆ° má»¥c /employee
    public class WebQuanLyViewModel : PageModel
    {
        private readonly IHttpClientFactory _httpClientFactory;

        public WebQuanLyViewModel(IHttpClientFactory httpClientFactory)
        {
            _httpClientFactory = httpClientFactory;
        }

        [BindProperty]
        public WebQuanLyDashboardDto DashboardData { get; set; } = new();
        public string? ErrorMessage { get; set; }

        public async Task<IActionResult> OnGetAsync()
        {
            var idNhanVienStr = User.FindFirstValue(ClaimTypes.NameIdentifier);
            if (string.IsNullOrEmpty(idNhanVienStr))
            {
                // Náº¿u khÃ´ng cÃ³ cookie, Ä‘Ã¡ vá» trang Ä‘Äƒng nháº­p
                return RedirectToPage("/Employee/DangNhapEmployee");
            }

            var httpClient = _httpClientFactory.CreateClient();
            try
            {
                var response = await httpClient.GetFromJsonAsync<WebQuanLyDashboardDto>($"http://localhost:5166/api/web/quanly/dashboard/{idNhanVienStr}");

                if (response != null)
                {
                    DashboardData = response;
                }
                else
                {
                    ErrorMessage = "KhÃ´ng thá»ƒ táº£i dá»¯ liá»‡u dashboard.";
                }
            }
            catch (System.Exception ex)
            {
                ErrorMessage = $"Lá»—i káº¿t ná»‘i API: {ex.Message}";
            }

            return Page();
        }
    }
}
e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\Pages\Shared\
e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\Pages\_ViewImports.cshtml
@using WebCafebookApi
@namespace WebCafebookApi.Pages
@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers
@using Microsoft.AspNetCore.Mvc.TagHelpers
@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers
e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\Pages\_ViewStart.cshtml
@{
    Layout = "_Layout";
}
e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\Pages\TrangChuView.cshtml.cs e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\Pages\TrangChuView.cshtml
@page "/"
@model WebCafebookApi.Pages.TrangChuViewModel
@{
    ViewData["Title"] = "Trang Chá»§";
    var bannerStyle = string.IsNullOrEmpty(Model.Info?.BannerImageUrl)
        ? "background-color: #4E342E; color: #FFF8E1;"
        : $"background-image: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url('{Model.Info.BannerImageUrl}'); background-size: cover; background-position: center; color: white;";
}

<div class="container-fluid px-0 mb-5">
    <div class="text-center p-5" style="@bannerStyle min-height: 40vh; display: flex; flex-direction: column; justify-content: center; align-items: center;">
        <h1 class="display-3 fw-bold" style="color: inherit;">
            @(Model.Info?.TenQuan ?? "ChÃ o má»«ng Ä‘áº¿n Cafebook")
        </h1>
        <p class="lead fs-4 col-md-8" style="color: inherit; opacity: 0.9;">
            @(Model.Info?.GioiThieu ?? "NÆ¡i báº¡n cÃ³ thá»ƒ thÆ°á»Ÿng thá»©c cÃ  phÃª thÆ¡m ngon, Ä‘á»c nhá»¯ng cuá»‘n sÃ¡ch hay vÃ  tÃ¬m tháº¥y khÃ´ng gian yÃªn tÄ©nh cho riÃªng mÃ¬nh.")
        </p>
        <div class="mt-4">
            <a asp-page="/ThucDonView" class="btn btn-primary btn-lg me-2">Xem Thá»±c ÄÆ¡n</a>
            <a asp-page="/ThuVienSachView" class="btn btn-outline-light btn-lg">KhÃ¡m PhÃ¡ SÃ¡ch</a>
        </div>
    </div>
</div>


<div class="container">

    @if (Model.Promotions != null && Model.Promotions.Any())
    {
    }

    <div class="row mt-5">
        <h2 class="text-center mb-4 pb-2 border-bottom">â˜• MÃ³n Ná»•i Báº­t</h2>
        @if (Model.MonNoiBat != null && Model.MonNoiBat.Any())
        {
            @foreach (var item in Model.MonNoiBat)
            {
                <div class="col-lg col-md-4 col-sm-6 mb-4">
                    <div class="card h-100">
                        @{
                            // Sá»¬A Lá»–I LOGIC á» ÄÃ‚Y
                            var imgSrc = string.IsNullOrEmpty(item.AnhSanPhamBase64)
                            ? "/images/default-food-icon.png"  // 1. Láº¥y áº£nh Máº¶C Äá»ŠNH tá»« wwwroot
                            : $"data:image/png;base64,{item.AnhSanPhamBase64}"; // 2. ThÃªm tiá»n tá»‘ cho Base64
                        }
                        <img src="@imgSrc" class="card-img-top" alt="@item.TenSanPham" style="height: 180px; object-fit: cover;">
                        <div class="card-body d-flex flex-column">
                            <h6 class="card-title">@item.TenSanPham</h6>
                            <p class="card-text text-danger fw-bold mt-auto mb-0">@item.DonGia.ToString("N0") Ä‘</p>
                        </div>
                    </div>
                </div>
            }
        }
        else
        {
            <p class="text-center text-muted">âš™ï¸ Dá»¯ liá»‡u mÃ³n ná»•i báº­t Ä‘ang Ä‘Æ°á»£c cáº­p nháº­t...</p>
        }
    </div>

    <div class="row mt-5">
        <h2 class="text-center mb-4 pb-2 border-bottom">ğŸ“š SÃ¡ch Hay NÃªn Äá»c</h2>
        @if (Model.SachNoiBat != null && Model.SachNoiBat.Any())
        {
            @foreach (var sach in Model.SachNoiBat)
            {
                <div class="col-lg-3 col-md-6 mb-4">
                    <div class="card h-100">
                        @{
                            // Sá»¬A Lá»–I TÆ¯Æ NG Tá»°
                            var imgSrc = string.IsNullOrEmpty(sach.AnhBia)
                            ? "/images/default-book-cover.png" // 1. Láº¥y áº£nh Máº¶C Äá»ŠNH
                            : $"data:image/png;base64,{sach.AnhBia}"; // 2. ThÃªm tiá»n tá»‘ Base64
                        }
                        <img src="@imgSrc" class="card-img-top" alt="@sach.TieuDe" style="height: 250px; object-fit: cover;">
                        <div class="card-body">
                            <h6 class="card-title" style="height: 2.5em; overflow: hidden;">@sach.TieuDe</h6>
                            <p class="card-text text-muted small">@sach.TacGia</p>
                        </div>
                        <div class="card-footer bg-transparent border-0 pb-3">
                            <a asp-page="/ChiTietSachView" asp-route-id="@sach.IdSach" class="btn btn-outline-primary btn-sm w-100">
                                Xem chi tiáº¿t
                            </a>
                        </div>
                    </div>
                </div>
            }
        }
        else
        {
            <p class="text-center text-muted">âš™ï¸ Dá»¯ liá»‡u sÃ¡ch ná»•i báº­t Ä‘ang Ä‘Æ°á»£c cáº­p nháº­t...</p>
        }
    </div>

</div>
e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\Pages\TrangChuView.cshtml.cs
using CafebookModel.Model.ModelWeb; // ThÃªm DTO
using Microsoft.AspNetCore.Mvc;
using Microsoft.AspNetCore.Mvc.RazorPages;
using System.Net.Http.Json; // ThÃªm

namespace WebCafebookApi.Pages // Giáº£ sá»­ namespace lÃ  WebCafebookApi.Pages
{
    // Äáº£m báº£o tÃªn class khá»›p vá»›i @model
    public class TrangChuViewModel : PageModel
    {
        private readonly IHttpClientFactory _httpClientFactory;
        public TrangChuViewModel(IHttpClientFactory httpClientFactory)
        {
            _httpClientFactory = httpClientFactory;
        }

        // KHAI BÃO CÃC THUá»˜C TÃNH MÃ€ .cshtml Cáº¦N
        // (Sá»­a lá»—i CS1061)
        public ThongTinChungDto? Info { get; set; }
        public List<KhuyenMaiDto> Promotions { get; set; } = new();
        public List<SanPhamDto> MonNoiBat { get; set; } = new();
        public List<SachDto> SachNoiBat { get; set; } = new();

        public async Task OnGetAsync()
        {
            var httpClient = _httpClientFactory.CreateClient();
            try
            {
                // Gá»i API Trang chá»§
                var response = await httpClient.GetFromJsonAsync<TrangChuDto>("http://localhost:5166/api/web/trangchu/data");

                if (response != null)
                {
                    Info = response.Info;
                    Promotions = response.Promotions;
                    MonNoiBat = response.MonNoiBat;
                    SachNoiBat = response.SachNoiBat;
                }
            }
            catch (Exception)
            {
                // Náº¿u API lá»—i, trang váº«n hiá»ƒn thá»‹ (vá»›i dá»¯ liá»‡u rá»—ng)
                // Khá»Ÿi táº¡o Info Ä‘á»ƒ trÃ¡nh lá»—i null á»Ÿ .cshtml
                Info = new ThongTinChungDto();
            }
        }
    }
}
e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\Services\
e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\appsettings.Development.json e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\appsettings.json
{
  "Logging": {
    "LogLevel": {
      "Default": "Information",
      "Microsoft.AspNetCore": "Warning"
    }
  },
  "AllowedHosts": "*"
}
e:\Tai Lieu Hoc Tap\CS 445 AM\Project\WebCafebookApi\Program.cs
using Microsoft.AspNetCore.Authentication.Cookies;

var builder = WebApplication.CreateBuilder(args);

// 1. THÃŠM Dá»ŠCH Vá»¤ HTTPCLIENT (Äá»‚ Gá»ŒI API)
builder.Services.AddHttpClient();

// 2. THÃŠM Dá»ŠCH Vá»¤ SESSION (Äá»‚ LÆ¯U AVATAR)
builder.Services.AddDistributedMemoryCache();
builder.Services.AddSession(options =>
{
    options.IdleTimeout = TimeSpan.FromMinutes(30);
    options.Cookie.HttpOnly = true;
    options.Cookie.IsEssential = true;
});

// 3. THÃŠM Dá»ŠCH Vá»¤ AUTHENTICATION (Äá»‚ Táº O COOKIE)
builder.Services.AddAuthentication(CookieAuthenticationDefaults.AuthenticationScheme)
    .AddCookie(options =>
    {
        options.LoginPath = "/Account/Login";
        options.AccessDeniedPath = "/AccessDenied";
        options.LogoutPath = "/Account/DangXuat";
    });

// 4. THÃŠM RAZOR PAGES (cá»§a báº¡n Ä‘Ã£ cÃ³)
builder.Services.AddRazorPages(options =>
{
    //options.Conventions.AddPageRoute("/Account/DangNhapView", "/Account/Login");
    //options.Conventions.AddPageRoute("/Account/DangKyView", "/Account/Register");
    //options.Conventions.AddPageRoute("/Employee/DangNhapEmployee", "/Employee/Login");
});

var app = builder.Build();

// Configure the HTTP request pipeline.
if (!app.Environment.IsDevelopment())
{
    app.UseExceptionHandler("/Error");
}
app.UseStaticFiles();

app.UseRouting();

// 5. KÃCH HOáº T CÃC Dá»ŠCH Vá»¤ (Thá»© tá»± quan trá»ng)
app.UseSession(); // KÃ­ch hoáº¡t Session
app.UseAuthentication(); // KÃ­ch hoáº¡t Authentication
app.UseAuthorization(); // KÃ­ch hoáº¡t Authorization

app.MapRazorPages();

app.Run();