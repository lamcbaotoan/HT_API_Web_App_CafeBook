=== MÃ NGUỒN DỰ ÁN: CafebookModel ===

E:\Tai Lieu Hoc Tap\CS 445 AM\Project\CafebookModel\CafebookModel.csproj
E:\Tai Lieu Hoc Tap\CS 445 AM\Project\CafebookModel\Model\Entities.cs
================================================================================
﻿using System; // <-- Thêm
using System.Collections.Generic; // <-- Thêm
using System.ComponentModel.DataAnnotations;
using System.ComponentModel.DataAnnotations.Schema;

namespace CafebookModel.Model.Entities
{
    [Table("KhuVuc")]
    public class KhuVuc
    {
        [Key]
        public int IdKhuVuc { get; set; }
        [Required]
        [StringLength(100)]
        public string TenKhuVuc { get; set; } = string.Empty;
        [StringLength(500)]
        public string? MoTa { get; set; }

        public virtual ICollection<Ban> Bans { get; set; } = new List<Ban>();
    }

    [Table("Ban")]
    public class Ban
    {
        [Key]
        public int IdBan { get; set; }
        [Required]
        [StringLength(50)]
        public string SoBan { get; set; } = string.Empty;
        public int SoGhe { get; set; }
        [Required]
        [StringLength(50)]
        public string TrangThai { get; set; } = string.Empty;
        [StringLength(500)]
        public string? GhiChu { get; set; }

        public int? IdKhuVuc { get; set; }
        [ForeignKey("IdKhuVuc")]
        public virtual KhuVuc? KhuVuc { get; set; }

        public virtual ICollection<HoaDon> HoaDons { get; set; } = new List<HoaDon>();
        public virtual ICollection<PhieuDatBan> PhieuDatBans { get; set; } = new List<PhieuDatBan>();
    }

    [Table("NguoiGiaoHang")]
    public class NguoiGiaoHang
    {
        [Key]
        public int IdNguoiGiaoHang { get; set; }
        [Required]
        [StringLength(100)]
        public string TenNguoiGiaoHang { get; set; } = string.Empty;
        [Required]
        [StringLength(20)]
        public string SoDienThoai { get; set; } = string.Empty;
        [StringLength(50)]
        public string? TrangThai { get; set; }

        public virtual ICollection<HoaDon> HoaDons { get; set; } = new List<HoaDon>();
    }

    [Table("HoaDon")]
    public class HoaDon
    {
        [Key]
        public int IdHoaDon { get; set; }
        public int? IdBan { get; set; }
        public int? IdNhanVien { get; set; }
        public int? IdKhachHang { get; set; }
        public DateTime ThoiGianTao { get; set; }
        public DateTime? ThoiGianThanhToan { get; set; }
        [Required]
        [StringLength(50)]
        public string TrangThai { get; set; } = string.Empty;
        [Column(TypeName = "decimal(18, 2)")]
        public decimal TongTienGoc { get; set; }
        [Column(TypeName = "decimal(18, 2)")]
        public decimal GiamGia { get; set; }
        [Column(TypeName = "decimal(18, 2)")]
        public decimal TongPhuThu { get; set; }
        [Column(TypeName = "decimal(18, 2)")]
        [DatabaseGenerated(DatabaseGeneratedOption.Computed)]
        public decimal ThanhTien { get; set; }
        [StringLength(50)]
        public string? PhuongThucThanhToan { get; set; }
        public string? GhiChu { get; set; }
        [Required]
        [StringLength(50)]
        public string LoaiHoaDon { get; set; } = string.Empty;
        [StringLength(100)]
        public string? TrangThaiGiaoHang { get; set; }
        [StringLength(500)]
        public string? DiaChiGiaoHang { get; set; }
        [StringLength(20)]
        public string? SoDienThoaiGiaoHang { get; set; }
        public int? IdNguoiGiaoHang { get; set; }

        [ForeignKey("IdBan")]
        public virtual Ban? Ban { get; set; }
        [ForeignKey("IdNhanVien")]
        public virtual NhanVien? NhanVien { get; set; }
        [ForeignKey("IdKhachHang")]
        public virtual KhachHang? KhachHang { get; set; }
        [ForeignKey("IdNguoiGiaoHang")]
        public virtual NguoiGiaoHang? NguoiGiaoHang { get; set; }

        public virtual ICollection<ChiTietHoaDon> ChiTietHoaDons { get; set; } = new List<ChiTietHoaDon>();
        public virtual ICollection<NhatKyHuyMon> NhatKyHuyMons { get; set; } = new List<NhatKyHuyMon>();
        public virtual ICollection<GiaoDichThanhToan> GiaoDichThanhToans { get; set; } = new List<GiaoDichThanhToan>();
        public virtual ICollection<ChiTietPhuThuHoaDon> ChiTietPhuThuHoaDons { get; set; } = new List<ChiTietPhuThuHoaDon>();
        public virtual ICollection<HoaDon_KhuyenMai> HoaDonKhuyenMais { get; set; } = new List<HoaDon_KhuyenMai>();
    }

    [Table("DanhMuc")]
    public class DanhMuc
    {
        [Key]
        public int IdDanhMuc { get; set; }
        [Required]
        [StringLength(255)]
        public string TenDanhMuc { get; set; } = string.Empty;
        public int? IdDanhMucCha { get; set; }

        [ForeignKey("IdDanhMucCha")]
        public virtual DanhMuc? DanhMucCha { get; set; }
        public virtual ICollection<DanhMuc> DanhMucCons { get; set; } = new List<DanhMuc>();
        public virtual ICollection<SanPham> SanPhams { get; set; } = new List<SanPham>();
    }

    [Table("SanPham")]
    public class SanPham
    {
        [Key]
        public int IdSanPham { get; set; }
        [Required]
        [StringLength(255)]
        public string TenSanPham { get; set; } = string.Empty;
        public int IdDanhMuc { get; set; }
        [Column(TypeName = "decimal(18, 2)")]
        public decimal GiaBan { get; set; }
        public string? MoTa { get; set; }
        public bool TrangThaiKinhDoanh { get; set; }
        public string? HinhAnh { get; set; } // Base64
        [StringLength(50)]
        public string? NhomIn { get; set; }

        [ForeignKey("IdDanhMuc")]
        public virtual DanhMuc DanhMuc { get; set; } = null!;

        public virtual ICollection<ChiTietHoaDon> ChiTietHoaDons { get; set; } = new List<ChiTietHoaDon>();
        public virtual ICollection<NhatKyHuyMon> NhatKyHuyMons { get; set; } = new List<NhatKyHuyMon>();
        public virtual ICollection<DinhLuong> DinhLuongs { get; set; } = new List<DinhLuong>();
        public virtual ICollection<DeXuatSanPham> DeXuatSanPhamGocs { get; set; } = new List<DeXuatSanPham>();
        public virtual ICollection<DeXuatSanPham> DeXuatSanPhamDeXuats { get; set; } = new List<DeXuatSanPham>();
        public virtual ICollection<DanhGia> DanhGias { get; set; } = new List<DanhGia>();
    }

    [Table("ChiTietHoaDon")]
    public class ChiTietHoaDon
    {
        [Key]
        public int IdChiTietHoaDon { get; set; }
        public int IdHoaDon { get; set; }
        public int IdSanPham { get; set; }
        public int SoLuong { get; set; }
        [Column(TypeName = "decimal(18, 2)")]
        public decimal DonGia { get; set; }
        [Column(TypeName = "decimal(18, 2)")]
        [DatabaseGenerated(DatabaseGeneratedOption.Computed)]
        public decimal ThanhTien { get; set; }
        [StringLength(500)]
        public string? GhiChu { get; set; }

        [ForeignKey("IdHoaDon")]
        public virtual HoaDon HoaDon { get; set; } = null!;
        [ForeignKey("IdSanPham")]
        public virtual SanPham SanPham { get; set; } = null!;
    }

    [Table("PhuThu")]
    public class PhuThu
    {
        [Key]
        public int IdPhuThu { get; set; }
        [Required]
        [StringLength(100)]
        public string TenPhuThu { get; set; } = string.Empty;
        [Column(TypeName = "decimal(18, 2)")]
        public decimal GiaTri { get; set; }
        [Required]
        [StringLength(20)]
        public string LoaiGiaTri { get; set; } = string.Empty;

        public virtual ICollection<ChiTietPhuThuHoaDon> ChiTietPhuThuHoaDons { get; set; } = new List<ChiTietPhuThuHoaDon>();
    }

    [Table("ChiTietPhuThuHoaDon")]
    public class ChiTietPhuThuHoaDon
    {
        public int IdHoaDon { get; set; }
        public int IdPhuThu { get; set; }
        [Column(TypeName = "decimal(18, 2)")]
        public decimal SoTien { get; set; }

        [ForeignKey("IdHoaDon")]
        public virtual HoaDon HoaDon { get; set; } = null!;
        [ForeignKey("IdPhuThu")]
        public virtual PhuThu PhuThu { get; set; } = null!;
    }

    [Table("NhatKyHuyMon")]
    public class NhatKyHuyMon
    {
        [Key]
        public int IdNhatKy { get; set; }
        public int IdHoaDon { get; set; }
        public int IdSanPham { get; set; }
        public int SoLuongHuy { get; set; }
        [Required]
        [StringLength(255)]
        public string LyDo { get; set; } = string.Empty;
        public int IdNhanVienHuy { get; set; }
        public DateTime ThoiGianHuy { get; set; }

        [ForeignKey("IdHoaDon")]
        public virtual HoaDon HoaDon { get; set; } = null!;
        [ForeignKey("IdSanPham")]
        public virtual SanPham SanPham { get; set; } = null!;
        [ForeignKey("IdNhanVienHuy")]
        public virtual NhanVien NhanVienHuy { get; set; } = null!;
    }

    [Table("NguyenLieu")]
    public class NguyenLieu
    {
        [Key]
        public int IdNguyenLieu { get; set; }
        [Required]
        [StringLength(255)]
        public string TenNguyenLieu { get; set; } = string.Empty;
        [Required]
        [StringLength(50)]
        public string DonViTinh { get; set; } = string.Empty;
        [Column(TypeName = "decimal(18, 2)")]
        public decimal TonKho { get; set; }
        [Column(TypeName = "decimal(18, 2)")]
        public decimal TonKhoToiThieu { get; set; }

        public virtual ICollection<DinhLuong> DinhLuongs { get; set; } = new List<DinhLuong>();
        public virtual ICollection<ChiTietNhapKho> ChiTietNhapKhos { get; set; } = new List<ChiTietNhapKho>();
        public virtual ICollection<ChiTietKiemKho> ChiTietKiemKhos { get; set; } = new List<ChiTietKiemKho>();
        public virtual ICollection<ChiTietXuatHuy> ChiTietXuatHuys { get; set; } = new List<ChiTietXuatHuy>();
    }

    [Table("DinhLuong")]
    public class DinhLuong
    {
        public int IdSanPham { get; set; }
        public int IdNguyenLieu { get; set; }

        [Column(TypeName = "decimal(18, 2)")]
        public decimal SoLuongSuDung { get; set; } // <-- ĐÃ ĐỔI TÊN

        public int IdDonViSuDung { get; set; } // <-- THÊM MỚI

        [ForeignKey("IdSanPham")]
        public virtual SanPham SanPham { get; set; } = null!;
        [ForeignKey("IdNguyenLieu")]
        public virtual NguyenLieu NguyenLieu { get; set; } = null!;

        [ForeignKey("IdDonViSuDung")] // <-- THÊM MỚI
        public virtual DonViChuyenDoi DonViSuDung { get; set; } = null!;
    }

    [Table("DonViChuyenDoi")]
    public class DonViChuyenDoi
    {
        [Key]
        public int IdChuyenDoi { get; set; }

        public int IdNguyenLieu { get; set; }

        [Required]
        [StringLength(50)]
        public string TenDonVi { get; set; } = string.Empty;

        [Column(TypeName = "decimal(18, 6)")]
        public decimal GiaTriQuyDoi { get; set; }

        public bool LaDonViCoBan { get; set; }

        [ForeignKey("IdNguyenLieu")]
        public virtual NguyenLieu NguyenLieu { get; set; } = null!;
        public virtual ICollection<DinhLuong> DinhLuongs { get; set; } = new List<DinhLuong>();
    }

    [Table("NhaCungCap")]
    public class NhaCungCap
    {
        [Key]
        public int IdNhaCungCap { get; set; }
        [Required]
        [StringLength(255)]
        public string TenNhaCungCap { get; set; } = string.Empty;
        [StringLength(20)]
        public string? SoDienThoai { get; set; }
        [StringLength(500)]
        public string? DiaChi { get; set; }
        [StringLength(100)]
        public string? Email { get; set; }

        public virtual ICollection<PhieuNhapKho> PhieuNhapKhos { get; set; } = new List<PhieuNhapKho>();
    }

    [Table("PhieuNhapKho")]
    public class PhieuNhapKho
    {
        [Key]
        public int IdPhieuNhapKho { get; set; }
        public int? IdNhaCungCap { get; set; }
        public int IdNhanVien { get; set; }
        public DateTime NgayNhap { get; set; }
        [Column(TypeName = "decimal(18, 2)")]
        public decimal TongTien { get; set; }
        [StringLength(500)]
        public string? GhiChu { get; set; }
        [Required]
        [StringLength(50)]
        public string TrangThai { get; set; } = string.Empty;

        [ForeignKey("IdNhaCungCap")]
        public virtual NhaCungCap? NhaCungCap { get; set; }
        [ForeignKey("IdNhanVien")]
        public virtual NhanVien NhanVien { get; set; } = null!;

        public virtual ICollection<ChiTietNhapKho> ChiTietNhapKhos { get; set; } = new List<ChiTietNhapKho>();
    }

    [Table("ChiTietNhapKho")]
    public class ChiTietNhapKho
    {
        public int IdPhieuNhapKho { get; set; }
        public int IdNguyenLieu { get; set; }
        [Column(TypeName = "decimal(18, 2)")]
        public decimal SoLuongNhap { get; set; }
        [Column(TypeName = "decimal(18, 2)")]
        public decimal DonGiaNhap { get; set; }
        [Column(TypeName = "decimal(18, 2)")]
        [DatabaseGenerated(DatabaseGeneratedOption.Computed)]
        public decimal ThanhTien { get; set; }

        [ForeignKey("IdPhieuNhapKho")]
        public virtual PhieuNhapKho PhieuNhapKho { get; set; } = null!;
        [ForeignKey("IdNguyenLieu")]
        public virtual NguyenLieu NguyenLieu { get; set; } = null!;
    }

    [Table("PhieuKiemKho")]
    public class PhieuKiemKho
    {
        [Key]
        public int IdPhieuKiemKho { get; set; }
        public int IdNhanVienKiem { get; set; }
        public DateTime NgayKiem { get; set; }
        [StringLength(500)]
        public string? GhiChu { get; set; }
        [Required]
        [StringLength(50)]
        public string TrangThai { get; set; } = string.Empty;

        [ForeignKey("IdNhanVienKiem")]
        public virtual NhanVien NhanVienKiem { get; set; } = null!;

        public virtual ICollection<ChiTietKiemKho> ChiTietKiemKhos { get; set; } = new List<ChiTietKiemKho>();
    }

    [Table("ChiTietKiemKho")]
    public class ChiTietKiemKho
    {
        public int IdPhieuKiemKho { get; set; }
        public int IdNguyenLieu { get; set; }
        [Column(TypeName = "decimal(18, 2)")]
        public decimal TonKhoHeThong { get; set; }
        [Column(TypeName = "decimal(18, 2)")]
        public decimal TonKhoThucTe { get; set; }
        [Column(TypeName = "decimal(18, 2)")]
        [DatabaseGenerated(DatabaseGeneratedOption.Computed)]
        public decimal ChenhLech { get; set; }
        [StringLength(255)]
        public string? LyDoChenhLech { get; set; }

        [ForeignKey("IdPhieuKiemKho")]
        public virtual PhieuKiemKho PhieuKiemKho { get; set; } = null!;
        [ForeignKey("IdNguyenLieu")]
        public virtual NguyenLieu NguyenLieu { get; set; } = null!;
    }

    [Table("PhieuXuatHuy")]
    public class PhieuXuatHuy
    {
        [Key]
        public int IdPhieuXuatHuy { get; set; }
        public int IdNhanVienXuat { get; set; }
        public DateTime NgayXuatHuy { get; set; }
        [Required]
        [StringLength(500)]
        public string LyDoXuatHuy { get; set; } = string.Empty;
        [Column(TypeName = "decimal(18, 2)")]
        public decimal TongGiaTriHuy { get; set; }

        [ForeignKey("IdNhanVienXuat")]
        public virtual NhanVien NhanVienXuat { get; set; } = null!;

        public virtual ICollection<ChiTietXuatHuy> ChiTietXuatHuys { get; set; } = new List<ChiTietXuatHuy>();
    }

    [Table("ChiTietXuatHuy")]
    public class ChiTietXuatHuy
    {
        public int IdPhieuXuatHuy { get; set; }
        public int IdNguyenLieu { get; set; }
        [Column(TypeName = "decimal(18, 2)")]
        public decimal SoLuong { get; set; }
        [Column(TypeName = "decimal(18, 2)")]
        public decimal DonGiaVon { get; set; }
        [Column(TypeName = "decimal(18, 2)")]
        [DatabaseGenerated(DatabaseGeneratedOption.Computed)]
        public decimal ThanhTien { get; set; }

        [ForeignKey("IdPhieuXuatHuy")]
        public virtual PhieuXuatHuy PhieuXuatHuy { get; set; } = null!;
        [ForeignKey("IdNguyenLieu")]
        public virtual NguyenLieu NguyenLieu { get; set; } = null!;
    }

    [Table("KhachHang")]
    public class KhachHang
    {
        [Key]
        public int IdKhachHang { get; set; }
        [Required]
        [StringLength(255)]
        public string HoTen { get; set; } = string.Empty;
        [StringLength(20)]
        public string? SoDienThoai { get; set; }
        [StringLength(100)]
        public string? Email { get; set; }
        [StringLength(500)]
        public string? DiaChi { get; set; }
        public int DiemTichLuy { get; set; }
        [StringLength(100)]
        public string? TenDangNhap { get; set; }
        [StringLength(255)]
        public string? MatKhau { get; set; }
        public DateTime NgayTao { get; set; }
        public bool BiKhoa { get; set; }
        public string? AnhDaiDien { get; set; } 
        public bool TaiKhoanTam { get; set; }
        public virtual ICollection<HoaDon> HoaDons { get; set; } = new List<HoaDon>();
        public virtual ICollection<PhieuDatBan> PhieuDatBans { get; set; } = new List<PhieuDatBan>();
        public virtual ICollection<PhieuThueSach> PhieuThueSachs { get; set; } = new List<PhieuThueSach>();
        public virtual ICollection<ChatLichSu> ChatLichSus { get; set; } = new List<ChatLichSu>();
    }

    [Table("PhieuDatBan")]
    public class PhieuDatBan
    {
        [Key]
        public int IdPhieuDatBan { get; set; }
        public int? IdKhachHang { get; set; }
        public int IdBan { get; set; }
        [StringLength(100)]
        public string? HoTenKhach { get; set; }
        [StringLength(20)]
        public string? SdtKhach { get; set; }
        public DateTime ThoiGianDat { get; set; }
        public int SoLuongKhach { get; set; }
        [Required]
        [StringLength(50)]
        public string TrangThai { get; set; } = string.Empty;
        [StringLength(500)]
        public string? GhiChu { get; set; }

        [ForeignKey("IdKhachHang")]
        public virtual KhachHang? KhachHang { get; set; }
        [ForeignKey("IdBan")]
        public virtual Ban Ban { get; set; } = null!;
    }

    [Table("KhuyenMai")]
    public class KhuyenMai
    {
        [Key]
        public int IdKhuyenMai { get; set; }
        [Required]
        [StringLength(50)]
        public string MaKhuyenMai { get; set; } = string.Empty;
        [Required]
        [StringLength(255)]
        public string TenChuongTrinh { get; set; } = string.Empty;
        public string? MoTa { get; set; }
        [Required]
        [StringLength(20)]
        public string LoaiGiamGia { get; set; } = string.Empty;
        [Column(TypeName = "decimal(18, 2)")]
        public decimal GiaTriGiam { get; set; }
        public DateTime NgayBatDau { get; set; }
        public DateTime NgayKetThuc { get; set; }
        [StringLength(500)]
        public string? DieuKienApDung { get; set; } // Mô tả cho DataGrid
        public int? SoLuongConLai { get; set; }

        // --- CÁC CỘT MỚI ---
        [Required]
        [StringLength(50)]
        public string TrangThai { get; set; } = string.Empty; // Hoạt động, Tạm dừng, Hết hạn
        [Column(TypeName = "decimal(18, 2)")]
        public decimal? GiamToiDa { get; set; }
        public int? IdSanPhamApDung { get; set; }
        [Column(TypeName = "decimal(18, 2)")]
        public decimal? HoaDonToiThieu { get; set; }
        public TimeSpan? GioBatDau { get; set; }
        public TimeSpan? GioKetThuc { get; set; }
        [StringLength(50)]
        public string? NgayTrongTuan { get; set; }

        [ForeignKey("IdSanPhamApDung")]
        public virtual SanPham? SanPhamApDung { get; set; }

        public virtual ICollection<HoaDon_KhuyenMai> HoaDonKhuyenMais { get; set; } = new List<HoaDon_KhuyenMai>();
    }

    [Table("HoaDon_KhuyenMai")]
    public class HoaDon_KhuyenMai
    {
        public int IdHoaDon { get; set; }
        public int IdKhuyenMai { get; set; }

        [ForeignKey("IdHoaDon")]
        public virtual HoaDon HoaDon { get; set; } = null!;
        [ForeignKey("IdKhuyenMai")]
        public virtual KhuyenMai KhuyenMai { get; set; } = null!;
    }

    [Table("TheLoai")]
    public class TheLoai
    {
        [Key]
        public int IdTheLoai { get; set; }
        public string TenTheLoai { get; set; } = null!;
        public string? MoTa { get; set; }
        public virtual ICollection<SachTheLoai> SachTheLoais { get; set; } = new List<SachTheLoai>();
    }

    [Table("TacGia")]
    public class TacGia
    {
        [Key]
        public int IdTacGia { get; set; }
        [Required]
        [StringLength(255)]
        public string TenTacGia { get; set; } = string.Empty;
        public string? GioiThieu { get; set; }
        public virtual ICollection<SachTacGia> SachTacGias { get; set; } = new List<SachTacGia>();
    }

    [Table("NhaXuatBan")]
    public class NhaXuatBan
    {
        [Key]
        public int IdNhaXuatBan { get; set; }
        public string TenNhaXuatBan { get; set; } = null!;
        public string? MoTa { get; set; }
        public virtual ICollection<SachNhaXuatBan> SachNhaXuatBans { get; set; } = new List<SachNhaXuatBan>();
    }

    [Table("Sach")]
    public class Sach
    {
        [Key]
        public int IdSach { get; set; }
        public string TenSach { get; set; } = null!;
        public int? NamXuatBan { get; set; }
        public string? MoTa { get; set; }
        public int SoLuongTong { get; set; }
        public int SoLuongHienCo { get; set; }
        public string? AnhBia { get; set; }
        [Column(TypeName = "decimal(18, 2)")]
        public decimal? GiaBia { get; set; }
        public string? ViTri { get; set; }
        public virtual ICollection<SachTacGia> SachTacGias { get; set; } = new List<SachTacGia>();
        public virtual ICollection<SachTheLoai> SachTheLoais { get; set; } = new List<SachTheLoai>();
        public virtual ICollection<SachNhaXuatBan> SachNhaXuatBans { get; set; } = new List<SachNhaXuatBan>();
        public virtual ICollection<ChiTietPhieuThue> ChiTietPhieuThues { get; set; } = new List<ChiTietPhieuThue>();
        [InverseProperty("SachGoc")]
        public virtual ICollection<DeXuatSach> DeXuatSachGocs { get; set; } = new List<DeXuatSach>();
        [InverseProperty("SachDeXuat")]
        public virtual ICollection<DeXuatSach> DeXuatSachDeXuats { get; set; } = new List<DeXuatSach>();
        public virtual ICollection<ChiTietPhieuTra> ChiTietPhieuTras { get; set; } = new List<ChiTietPhieuTra>();
    }


    [Table("PhieuTraSach")]
    public class PhieuTraSach
    {
        [Key]
        public int IdPhieuTra { get; set; }

        public int IdPhieuThueSach { get; set; }
        public int IdNhanVien { get; set; }
        public DateTime NgayTra { get; set; }

        [Column(TypeName = "decimal(18, 2)")]
        public decimal TongPhiThue { get; set; }

        [Column(TypeName = "decimal(18, 2)")]
        public decimal TongTienPhat { get; set; }

        [Column(TypeName = "decimal(18, 2)")]
        public decimal TongTienCocHoan { get; set; }

        public int DiemTichLuy { get; set; }

        // Navigation properties
        [ForeignKey("IdPhieuThueSach")]
        public virtual PhieuThueSach PhieuThueSach { get; set; } = null!;

        [ForeignKey("IdNhanVien")]
        public virtual NhanVien NhanVien { get; set; } = null!;

        public virtual ICollection<ChiTietPhieuTra> ChiTietPhieuTras { get; set; } = new List<ChiTietPhieuTra>();
        
    }

    [Table("ChiTietPhieuTra")]
    public class ChiTietPhieuTra
    {
        public int IdPhieuTra { get; set; }
        public int IdSach { get; set; }

        [Column(TypeName = "decimal(18, 2)")]
        public decimal TienPhat { get; set; }

        // Navigation properties
        [ForeignKey("IdPhieuTra")]
        public virtual PhieuTraSach PhieuTraSach { get; set; } = null!;

        [ForeignKey("IdSach")]
        public virtual Sach Sach { get; set; } = null!;
    }

    [Table("Sach_TacGia")]
    public class SachTacGia
    {
        public int IdSach { get; set; }
        public virtual Sach Sach { get; set; } = null!;
        public int IdTacGia { get; set; }
        public virtual TacGia TacGia { get; set; } = null!;
    }

    [Table("Sach_TheLoai")]
    public class SachTheLoai
    {
        public int IdSach { get; set; }
        public virtual Sach Sach { get; set; } = null!;
        public int IdTheLoai { get; set; }
        public virtual TheLoai TheLoai { get; set; } = null!;
    }

    [Table("Sach_NhaXuatBan")]
    public class SachNhaXuatBan
    {
        public int IdSach { get; set; }
        public virtual Sach Sach { get; set; } = null!;
        public int IdNhaXuatBan { get; set; }
        public virtual NhaXuatBan NhaXuatBan { get; set; } = null!;
    }

    [Table("PhieuThueSach")]
    public class PhieuThueSach
    {
        [Key]
        public int IdPhieuThueSach { get; set; }
        public int IdKhachHang { get; set; }
        public int? IdNhanVien { get; set; }
        public DateTime NgayThue { get; set; }
        [Required]
        [StringLength(50)]
        public string TrangThai { get; set; } = string.Empty;
        [Column(TypeName = "decimal(18, 2)")]
        public decimal TongTienCoc { get; set; }
        [ForeignKey("IdKhachHang")]
        public virtual KhachHang KhachHang { get; set; } = null!;
        [ForeignKey("IdNhanVien")]
        public virtual NhanVien? NhanVien { get; set; }
        public virtual ICollection<ChiTietPhieuThue> ChiTietPhieuThues { get; set; } = new List<ChiTietPhieuThue>();
        public virtual ICollection<PhieuTraSach> PhieuTraSachs { get; set; } = new List<PhieuTraSach>();
    }

    [Table("ChiTietPhieuThue")]
    public class ChiTietPhieuThue
    {
        public int IdPhieuThueSach { get; set; }
        public int IdSach { get; set; }
        public DateTime NgayHenTra { get; set; }
        public DateTime? NgayTraThucTe { get; set; }
        [Column(TypeName = "decimal(18, 2)")]
        public decimal TienCoc { get; set; }
        [Column(TypeName = "decimal(18, 2)")]
        public decimal? TienPhatTraTre { get; set; }

        [ForeignKey("IdPhieuThueSach")]
        public virtual PhieuThueSach PhieuThueSach { get; set; } = null!;
        [ForeignKey("IdSach")]
        public virtual Sach Sach { get; set; } = null!;

    }

    [Table("VaiTro")]
    public class VaiTro
    {
        [Key]
        public int IdVaiTro { get; set; }
        [Required]
        [StringLength(100)]
        public string TenVaiTro { get; set; } = string.Empty;
        [StringLength(500)]
        public string? MoTa { get; set; }

        public virtual ICollection<NhanVien> NhanViens { get; set; } = new List<NhanVien>();
        public virtual ICollection<VaiTro_Quyen> VaiTroQuyens { get; set; } = new List<VaiTro_Quyen>();
    }

    [Table("NhanVien")]
    public class NhanVien
    {
        [Key]
        public int IdNhanVien { get; set; }
        [Required]
        [StringLength(255)]
        public string HoTen { get; set; } = string.Empty;
        [Required]
        [StringLength(20)]
        public string SoDienThoai { get; set; } = string.Empty;
        [StringLength(100)]
        public string? Email { get; set; }
        [StringLength(500)]
        public string? DiaChi { get; set; }
        public DateTime NgayVaoLam { get; set; }
        public int IdVaiTro { get; set; }
        [Column(TypeName = "decimal(18, 2)")]
        public decimal LuongCoBan { get; set; }
        [Required]
        [StringLength(50)]
        public string TrangThaiLamViec { get; set; } = string.Empty;
        [Required]
        [StringLength(100)]
        public string TenDangNhap { get; set; } = string.Empty;
        [Required]
        [StringLength(255)]
        public string MatKhau { get; set; } = string.Empty;
        public string? AnhDaiDien { get; set; } // Base64

        [ForeignKey("IdVaiTro")]
        public virtual VaiTro VaiTro { get; set; } = null!;

        // --- BẮT ĐẦU SỬA LỖI ---

        public virtual ICollection<HoaDon> HoaDons { get; set; } = new List<HoaDon>();
        public virtual ICollection<NhatKyHuyMon> NhatKyHuyMons { get; set; } = new List<NhatKyHuyMon>();
        public virtual ICollection<PhieuNhapKho> PhieuNhapKhos { get; set; } = new List<PhieuNhapKho>();
        public virtual ICollection<PhieuKiemKho> PhieuKiemKhos { get; set; } = new List<PhieuKiemKho>();
        public virtual ICollection<PhieuXuatHuy> PhieuXuatHuys { get; set; } = new List<PhieuXuatHuy>();
        public virtual ICollection<PhieuThueSach> PhieuThueSachs { get; set; } = new List<PhieuThueSach>();
        public virtual ICollection<LichLamViec> LichLamViecs { get; set; } = new List<LichLamViec>();
        [InverseProperty("NhanVien")]
        public virtual ICollection<PhieuLuong> PhieuLuongs { get; set; } = new List<PhieuLuong>();
        [InverseProperty("NguoiPhat")]
        public virtual ICollection<PhieuLuong> PhieuLuongsDaPhat { get; set; } = new List<PhieuLuong>();
        [InverseProperty("NhanVien")]
        public virtual ICollection<DonXinNghi> DonXinNghis { get; set; } = new List<DonXinNghi>();
        [InverseProperty("NguoiDuyet")]
        public virtual ICollection<DonXinNghi> DonXinNghiNguoiDuyets { get; set; } = new List<DonXinNghi>();
        public virtual ICollection<ChatLichSu> ChatLichSus { get; set; } = new List<ChatLichSu>();
        public virtual ICollection<PhieuTraSach> PhieuTraSachs { get; set; } = new List<PhieuTraSach>();
        public virtual ICollection<PhieuThuongPhat> PhieuThuongPhatNguoiTaos { get; set; } = new List<PhieuThuongPhat>();

        // --- KẾT THÚC SỬA LỖI ---
    }

    [Table("CaLamViec")]
    public class CaLamViec
    {
        [Key]
        public int IdCa { get; set; }
        [Required]
        [StringLength(100)]
        public string TenCa { get; set; } = string.Empty;
        public TimeSpan GioBatDau { get; set; }
        public TimeSpan GioKetThuc { get; set; }

        public virtual ICollection<LichLamViec> LichLamViecs { get; set; } = new List<LichLamViec>();
    }

    [Table("LichLamViec")]
    public class LichLamViec
    {
        [Key]
        public int IdLichLamViec { get; set; }
        public int IdNhanVien { get; set; }
        public int IdCa { get; set; }
        public DateTime NgayLam { get; set; }

        [ForeignKey("IdNhanVien")]
        public virtual NhanVien NhanVien { get; set; } = null!;
        [ForeignKey("IdCa")]
        public virtual CaLamViec CaLamViec { get; set; } = null!;

        public virtual ICollection<BangChamCong> BangChamCongs { get; set; } = new List<BangChamCong>();
    }

    [Table("BangChamCong")]
    public class BangChamCong
    {
        [Key]
        public int IdChamCong { get; set; }
        public int IdLichLamViec { get; set; }
        public DateTime? GioVao { get; set; }
        public DateTime? GioRa { get; set; }

        // --- SỬA LỖI TỪ double? SANG decimal? VÀ THÊM TYPE ---
        [Column(TypeName = "decimal(18, 2)")]
        [DatabaseGenerated(DatabaseGeneratedOption.Computed)]
        public decimal? SoGioLam { get; set; }

        [ForeignKey("IdLichLamViec")]
        public virtual LichLamViec LichLamViec { get; set; } = null!;
    }

    [Table("PhieuLuong")]
    public class PhieuLuong
    {
        [Key]
        public int IdPhieuLuong { get; set; }
        public int IdNhanVien { get; set; }
        public int Thang { get; set; }
        public int Nam { get; set; }
        [Column(TypeName = "decimal(18, 2)")]
        public decimal LuongCoBan { get; set; }
        [Column(TypeName = "decimal(18, 2)")]
        public decimal TongGioLam { get; set; }

        // --- SỬA LỖI KHỚP VỚI CSDL (cho phép NULL) ---
        [Column(TypeName = "decimal(18, 2)")]
        public decimal? TienThuong { get; set; }
        [Column(TypeName = "decimal(18, 2)")]
        public decimal? KhauTru { get; set; }

        [Column(TypeName = "decimal(18, 2)")]
        public decimal ThucLanh { get; set; }
        public DateTime NgayTao { get; set; }
        [Required]
        [StringLength(50)]
        public string TrangThai { get; set; } = string.Empty;

        [ForeignKey("IdNhanVien")]
        public virtual NhanVien NhanVien { get; set; } = null!;

        // --- SỬA LỖI KHỚP VỚI CSDL (thêm cột mới) ---
        public DateTime? NgayPhatLuong { get; set; }
        public int? IdNguoiPhat { get; set; }
        [ForeignKey("IdNguoiPhat")]
        public virtual NhanVien? NguoiPhat { get; set; }
    }

    [Table("DonXinNghi")]
    public class DonXinNghi
    {
        [Key]
        public int IdDonXinNghi { get; set; }
        public int IdNhanVien { get; set; }
        [Required]
        [StringLength(100)]
        public string LoaiDon { get; set; } = string.Empty;
        [Required]
        [StringLength(500)]
        public string LyDo { get; set; } = string.Empty;
        public DateTime NgayBatDau { get; set; }
        public DateTime NgayKetThuc { get; set; }
        [Required]
        [StringLength(50)]
        public string TrangThai { get; set; } = string.Empty;
        public int? IdNguoiDuyet { get; set; }
        public DateTime? NgayDuyet { get; set; }
        [StringLength(255)]
        public string? GhiChuPheDuyet { get; set; }

        [ForeignKey("IdNhanVien")]
        public virtual NhanVien NhanVien { get; set; } = null!;
        [ForeignKey("IdNguoiDuyet")]
        public virtual NhanVien? NguoiDuyet { get; set; }
    }

    [Table("CaiDat")]
    public class CaiDat
    {
        [Key]
        [StringLength(100)]
        public string TenCaiDat { get; set; } = string.Empty;
        [Required]
        public string GiaTri { get; set; } = string.Empty;
        [StringLength(500)]
        public string? MoTa { get; set; }
    }

    [Table("Quyen")]
    public class Quyen
    {
        [Key]
        [StringLength(100)]
        public string IdQuyen { get; set; } = string.Empty;
        [Required]
        [StringLength(255)]
        public string TenQuyen { get; set; } = string.Empty;
        [Required]
        [StringLength(100)]
        public string NhomQuyen { get; set; } = string.Empty;

        public virtual ICollection<VaiTro_Quyen> VaiTroQuyens { get; set; } = new List<VaiTro_Quyen>();
    }

    [Table("VaiTro_Quyen")]
    public class VaiTro_Quyen
    {
        public int IdVaiTro { get; set; }
        [StringLength(100)]
        public string IdQuyen { get; set; } = string.Empty;

        [ForeignKey("IdVaiTro")]
        public virtual VaiTro VaiTro { get; set; } = null!;
        [ForeignKey("IdQuyen")]
        public virtual Quyen Quyen { get; set; } = null!;
    }

    [Table("GiaoDichThanhToan")]
    public class GiaoDichThanhToan
    {
        [Key]
        public int IdGiaoDich { get; set; }
        public int IdHoaDon { get; set; }
        [Required]
        [StringLength(100)]
        public string MaGiaoDichNgoai { get; set; } = string.Empty;
        [Required]
        [StringLength(50)]
        public string CongThanhToan { get; set; } = string.Empty;
        [Column(TypeName = "decimal(18, 2)")]
        public decimal SoTien { get; set; }
        public DateTime ThoiGianGiaoDich { get; set; }
        [Required]
        [StringLength(100)]
        public string TrangThai { get; set; } = string.Empty;
        [StringLength(50)]
        public string? MaLoi { get; set; }
        [StringLength(500)]
        public string? MoTaLoi { get; set; }

        [ForeignKey("IdHoaDon")]
        public virtual HoaDon HoaDon { get; set; } = null!;
    }

    [Table("ChatLichSu")]
    public class ChatLichSu
    {
        [Key]
        public long IdChat { get; set; }
        public int? IdKhachHang { get; set; }
        public int? IdNhanVien { get; set; }
        [Required]
        public string NoiDungHoi { get; set; } = string.Empty;
        [Required]
        public string NoiDungTraLoi { get; set; } = string.Empty;
        public DateTime ThoiGian { get; set; }
        [StringLength(50)]
        public string? LoaiChat { get; set; }

        // === CẬP NHẬT (THEO FSD MỚI) ===
        [StringLength(100)]
        public string? GuestSessionId { get; set; } // Hỗ trợ khách vãng lai

        [StringLength(20)]
        public string? LoaiTinNhan { get; set; } // "KhachHang", "AI", "NhanVien"

        public int? IdThongBaoHoTro { get; set; }
        // === KẾT THÚC CẬP NHẬT ===

        [ForeignKey("IdKhachHang")]
        public virtual KhachHang? KhachHang { get; set; }
        [ForeignKey("IdNhanVien")]
        public virtual NhanVien? NhanVien { get; set; }

        [ForeignKey("IdThongBaoHoTro")]
        public virtual ThongBaoHoTro? ThongBaoHoTro { get; set; }
    }

    [Table("DeXuatSanPham")]
    public class DeXuatSanPham
    {
        public int IdSanPhamGoc { get; set; }
        public int IdSanPhamDeXuat { get; set; }
        public double DoLienQuan { get; set; }
        [Required]
        [StringLength(100)]
        public string LoaiDeXuat { get; set; } = string.Empty;

        [ForeignKey("IdSanPhamGoc")]
        public virtual SanPham SanPhamGoc { get; set; } = null!;
        [ForeignKey("IdSanPhamDeXuat")]
        public virtual SanPham SanPhamDeXuat { get; set; } = null!;
    }

    [Table("DeXuatSach")]
    public class DeXuatSach
    {
        public int IdSachGoc { get; set; }
        public int IdSachDeXuat { get; set; }
        public double DoLienQuan { get; set; }
        [Required]
        [StringLength(100)]
        public string LoaiDeXuat { get; set; } = string.Empty;

        [ForeignKey("IdSachGoc")]
        public virtual Sach SachGoc { get; set; } = null!;
        [ForeignKey("IdSachDeXuat")]
        public virtual Sach SachDeXuat { get; set; } = null!;
    }

    [Table("ThongBao")]
    public class ThongBao
    {
        [Key]
        public int IdThongBao { get; set; }

        public int? IdNhanVienTao { get; set; }

        [Required]
        [StringLength(500)]
        public string NoiDung { get; set; } = string.Empty;

        public DateTime ThoiGianTao { get; set; }

        [StringLength(50)]
        public string? LoaiThongBao { get; set; }

        public int? IdLienQuan { get; set; } // Sẽ là idBan

        public bool DaXem { get; set; }

        [ForeignKey("IdNhanVienTao")]
        public virtual NhanVien? NhanVienTao { get; set; }
    }

    [Table("PhieuThuongPhat")]
    public class PhieuThuongPhat
    {
        [Key]
        public int IdPhieuThuongPhat { get; set; }

        public int IdNhanVien { get; set; }

        public int IdNguoiTao { get; set; }

        public DateTime NgayTao { get; set; }

        [Column(TypeName = "decimal(18, 2)")]
        public decimal SoTien { get; set; }

        [Required]
        [StringLength(500)]
        public string LyDo { get; set; } = string.Empty;

        public int? IdPhieuLuong { get; set; }

        [ForeignKey("IdNhanVien")]
        public virtual NhanVien NhanVien { get; set; } = null!;

        [ForeignKey("IdNguoiTao")]
        public virtual NhanVien NguoiTao { get; set; } = null!;

        [ForeignKey("IdPhieuLuong")]
        public virtual PhieuLuong? PhieuLuong { get; set; }
    }

    [Table("TrangThaiCheBien")]
    public class TrangThaiCheBien
    {
        [Key]
        public int IdTrangThaiCheBien { get; set; }

        public int IdChiTietHoaDon { get; set; }
        public int IdHoaDon { get; set; }
        public int IdSanPham { get; set; }

        [Required]
        [StringLength(255)]
        public string TenMon { get; set; } = string.Empty;

        [Required]
        [StringLength(50)]
        public string SoBan { get; set; } = string.Empty;

        public int SoLuong { get; set; }

        [StringLength(500)]
        public string? GhiChu { get; set; }

        [StringLength(50)]
        public string? NhomIn { get; set; }

        [Required]
        [StringLength(50)]
        public string TrangThai { get; set; } = string.Empty; // Chờ làm, Đang làm, Hoàn thành

        public DateTime ThoiGianGoi { get; set; }
        public DateTime? ThoiGianBatDau { get; set; }
        public DateTime? ThoiGianHoanThanh { get; set; }

        // Khóa ngoại
        [ForeignKey("IdChiTietHoaDon")]
        public virtual ChiTietHoaDon ChiTietHoaDon { get; set; } = null!;

        [ForeignKey("IdHoaDon")]
        public virtual HoaDon HoaDon { get; set; } = null!;

        [ForeignKey("IdSanPham")]
        public virtual SanPham SanPham { get; set; } = null!;
    }

    [Table("DanhGia")]
    public class DanhGia
    {
        [Key]
        public int idDanhGia { get; set; }

        [ForeignKey("KhachHang")]
        public int idKhachHang { get; set; }
        public virtual KhachHang? KhachHang { get; set; }

        [ForeignKey("SanPham")]
        public int? idSanPham { get; set; }
        public virtual SanPham? SanPham { get; set; }

        [ForeignKey("HoaDon")]
        public int idHoaDon { get; set; }
        public virtual HoaDon? HoaDon { get; set; }

        [Range(1, 5)]
        public int SoSao { get; set; }

        [Column(TypeName = "nvarchar(max)")]
        public string? BinhLuan { get; set; }

        [Column(TypeName = "nvarchar(max)")]
        public string? HinhAnhURL { get; set; }

        [Required]
        // CHỈ CÓ MỘT DÒNG NÀY
        public DateTime NgayTao { get; set; } 

        [Required]
        [Column(TypeName = "nvarchar(50)")]
        public string TrangThai { get; set; } = "Hiển thị";

        public virtual ICollection<PhanHoiDanhGia> PhanHoiDanhGias { get; set; } = new List<PhanHoiDanhGia>();

        public DanhGia()
        {
            // Constructor gán giá trị cho thuộc tính NgayTao ở trên
            this.NgayTao = DateTime.Now;
        }
    }

    [Table("PhanHoiDanhGia")]
    public class PhanHoiDanhGia
    {
        [Key]
        public int idPhanHoi { get; set; }

        [ForeignKey("DanhGia")]
        public int idDanhGia { get; set; }
        public virtual DanhGia? DanhGia { get; set; }

        [ForeignKey("NhanVien")]
        public int idNhanVien { get; set; }
        public virtual NhanVien? NhanVien { get; set; }

        [Required]
        [Column(TypeName = "nvarchar(max)")]
        public string NoiDung { get; set; } = null!;

        [Required]
        // CHỈ CÓ MỘT DÒNG NÀY
        public DateTime NgayTao { get; set; } 

        public PhanHoiDanhGia()
        {
            // Constructor gán giá trị cho thuộc tính NgayTao ở trên
            this.NgayTao = DateTime.Now;
        }
    }

    [Table("ThongBaoHoTro")]
    public class ThongBaoHoTro
    {
        [Key]
        public int IdThongBao { get; set; }

        // ======================================
        // === SỬA LỖI CS0266 TẠI ĐÂY ===
        // ======================================
        // 1. Xóa [Required]
        // 2. Thêm dấu '?' để cho phép NULL
        public int? IdKhachHang { get; set; }
        // ======================================

        [StringLength(100)]
        public string? GuestSessionId { get; set; } // Hỗ trợ khách vãng lai

        public string? NoiDungYeuCau { get; set; }

        [Required]
        public DateTime ThoiGianTao { get; set; }

        [Required]
        [StringLength(50)]
        public string TrangThai { get; set; } = string.Empty;

        public int? IdNhanVien { get; set; }

        public DateTime? ThoiGianPhanHoi { get; set; }

        [StringLength(500)]
        public string? GhiChu { get; set; }

        // Navigation Properties
        [ForeignKey("IdKhachHang")]
        public virtual KhachHang? KhachHang { get; set; } // Thêm '?'

        [ForeignKey("IdNhanVien")]
        public virtual NhanVien? NhanVien { get; set; }

        public virtual ICollection<ChatLichSu> ChatLichSus { get; set; } = new List<ChatLichSu>();
    }
}
================================================================================

E:\Tai Lieu Hoc Tap\CS 445 AM\Project\CafebookModel\Model\Data\NhanVienDto.cs
================================================================================
﻿using System.Collections.Generic;

namespace CafebookModel.Model.Data
{
    // Lớp này chứa thông tin người dùng sẽ được lưu trữ
    // trong WPF app sau khi đăng nhập thành công.
    public class NhanVienDto
    {
        public int IdNhanVien { get; set; }
        public string? HoTen { get; set; }
        public string? TenVaiTro { get; set; }
        public string? AnhDaiDien { get; set; } 
        public List<string> DanhSachQuyen { get; set; } = new List<string>();
    }
}
================================================================================

E:\Tai Lieu Hoc Tap\CS 445 AM\Project\CafebookModel\Model\ModelApi\LoginRequestModel.cs
================================================================================
﻿namespace CafebookModel.Model.ModelApi
{
    public class LoginRequestModel
    {
        public string? TenDangNhap { get; set; }
        public string? MatKhau { get; set; }
    }
}
================================================================================

E:\Tai Lieu Hoc Tap\CS 445 AM\Project\CafebookModel\Model\ModelApi\LoginResponseModel.cs
================================================================================
﻿using CafebookModel.Model.Data;

namespace CafebookModel.Model.ModelApi
{
    public class LoginResponseModel
    {
        public bool Success { get; set; }
        public string Message { get; set; } = string.Empty;
        public string? Token { get; set; }
        public NhanVienDto? UserData { get; set; }
    }
}
================================================================================

E:\Tai Lieu Hoc Tap\CS 445 AM\Project\CafebookModel\Model\ModelApp\BanQuanLyDto.cs
================================================================================
﻿using System;
using System.Collections.Generic;

namespace CafebookModel.Model.ModelApp
{
    /// <summary>
    /// DTO cho một bàn (Node con)
    /// </summary>
    public class BanDto
    {
        public int IdBan { get; set; }
        public string SoBan { get; set; } = string.Empty;
        public int SoGhe { get; set; }
        public string TrangThai { get; set; } = string.Empty;
        public string? GhiChu { get; set; }
        public int IdKhuVuc { get; set; }
    }

    /// <summary>
    /// DTO cho một khu vực (Node cha), chứa danh sách các bàn
    /// </summary>
    public class KhuVucDto
    {
        public int IdKhuVuc { get; set; }
        public string TenKhuVuc { get; set; } = string.Empty;
        public string? MoTa { get; set; }
        public List<BanDto> Bans { get; set; } = new List<BanDto>();
    }

    /// <summary>
    /// DTO cho chức năng "Xem Lịch sử" (Advanced Function 3)
    /// </summary>
    public class BanHistoryDto
    {
        public int SoLuotPhucVu { get; set; }
        public decimal TongDoanhThu { get; set; }
        public int SoLuotDatTruoc { get; set; }
    }

    /// <summary>
    /// DTO dùng để gửi dữ liệu CẬP NHẬT/THÊM MỚI Bàn
    /// </summary>
    public class BanUpdateRequestDto
    {
        public string SoBan { get; set; } = string.Empty;
        public int SoGhe { get; set; }
        public int IdKhuVuc { get; set; }
        public string TrangThai { get; set; } = string.Empty;
        public string? GhiChu { get; set; }
    }

    /// <summary>
    /// DTO dùng để gửi dữ liệu CẬP NHẬT/THÊM MỚI Khu Vực
    /// </summary>
    public class KhuVucUpdateRequestDto
    {
        public string TenKhuVuc { get; set; } = string.Empty;
        public string? MoTa { get; set; }
    }
}
================================================================================

E:\Tai Lieu Hoc Tap\CS 445 AM\Project\CafebookModel\Model\ModelApp\BaoCaoDto.cs
================================================================================
﻿using System.Collections.Generic;

namespace CafebookModel.Model.ModelApp
{
    /// <summary>
    /// DTO để gửi yêu cầu (Từ ngày/Đến ngày) lên API
    /// </summary>
    public class BaoCaoRequestDto
    {
        public DateTime StartDate { get; set; }
        public DateTime EndDate { get; set; }
    }

    /// <summary>
    /// DTO chứa toàn bộ kết quả báo cáo
    /// </summary>
    public class BaoCaoTongHopDto
    {
        public BaoCaoKpiDto Kpi { get; set; } = new();
        public BaoCaoChiTietDoanhThuDto ChiTietDoanhThu { get; set; } = new();
        public BaoCaoChiPhiDto ChiTietChiPhi { get; set; } = new();
        public List<TopSanPhamDto> TopSanPham { get; set; } = new();
    }

    // -- Các lớp con cho báo cáo chi tiết --

    public class BaoCaoKpiDto
    {
        public decimal DoanhThuRong { get; set; }
        public decimal TongGiaVon { get; set; }
        public decimal LoiNhuanGop { get; set; }
        public decimal ChiPhiOpex { get; set; }
        public decimal LoiNhuanRong { get; set; }
    }

    // Kết quả của truy vấn 3.1
    public class BaoCaoChiTietDoanhThuDto
    {
        public decimal TongDoanhThuGoc { get; set; }
        public decimal TongGiamGia { get; set; }
        public decimal TongPhuThu { get; set; }
        public decimal DoanhThuRong { get; set; }
        public int SoLuongHoaDon { get; set; }
        public decimal GiaTriTrungBinhHD { get; set; }
    }

    // Kết quả của truy vấn 3.2b
    public class OpexDto
    {
        public decimal TongChiPhiLuong { get; set; }
        public decimal TongChiPhiHuyHang { get; set; }
    }

    // DTO cho Tab 2
    public class BaoCaoChiPhiDto
    {
        public decimal TongGiaVon_COGS { get; set; }
        public decimal TongChiPhiLuong { get; set; }
        public decimal TongChiPhiHuyHang { get; set; }
    }

    // Kết quả của truy vấn 3.3
    public class TopSanPhamDto
    {
        public string TenSanPham { get; set; } = string.Empty;
        public int TongSoLuongBan { get; set; }
        public decimal TongDoanhThu { get; set; }
    }
}
================================================================================

E:\Tai Lieu Hoc Tap\CS 445 AM\Project\CafebookModel\Model\ModelApp\BaoCaoHieuSuatDto.cs
================================================================================
﻿using System;
using System.Collections.Generic;

namespace CafebookModel.Model.ModelApp
{
    /// <summary>
    /// DTO để gửi yêu cầu lọc (filters) lên API
    /// </summary>
    public class BaoCaoHieuSuatRequestDto
    {
        public DateTime StartDate { get; set; }
        public DateTime EndDate { get; set; }
        public int? VaiTroId { get; set; }
        public string? SearchText { get; set; }
    }

    /// <summary>
    /// DTO chứa toàn bộ kết quả báo cáo
    /// </summary>
    public class BaoCaoHieuSuatTongHopDto
    {
        public BaoCaoHieuSuatKpiDto Kpi { get; set; } = new();
        public List<BaoCaoSalesDto> SalesPerformance { get; set; } = new();
        public List<BaoCaoOperationsDto> OperationalPerformance { get; set; } = new();
        public List<BaoCaoAttendanceDto> Attendance { get; set; } = new();
    }

    // -- Các lớp con cho báo cáo chi tiết --

    // Dùng cho KPI
    public class BaoCaoHieuSuatKpiDto
    {
        public decimal TongDoanhThu { get; set; }
        public decimal TongGioLam { get; set; } // SỬA TỪ double -> decimal
        public int TongSoCaLam { get; set; }
        public int TongLanHuyMon { get; set; }
    }

    // Dùng cho Tab 1: Sales
    public class BaoCaoSalesDto
    {
        public string HoTen { get; set; } = string.Empty;
        public string TenVaiTro { get; set; } = string.Empty;
        public decimal TongDoanhThu { get; set; }
        public int SoHoaDon { get; set; }
        public decimal DoanhThuTrungBinh { get; set; }
        public int SoLanHuyMon { get; set; }
    }

    // Dùng cho Tab 2: Operations
    public class BaoCaoOperationsDto
    {
        public string HoTen { get; set; } = string.Empty;
        public string TenVaiTro { get; set; } = string.Empty;
        public int PhieuNhap { get; set; }
        public int PhieuKiem { get; set; }
        public int PhieuHuy { get; set; }
        public int DonDuyet { get; set; }
    }

    // Dùng cho Tab 3: Attendance
    public class BaoCaoAttendanceDto
    {
        public string HoTen { get; set; } = string.Empty;
        public int TongSoCaLam { get; set; }
        public decimal TongGioLam { get; set; } // SỬA TỪ double -> decimal
        public int SoDonXinNghi { get; set; }
        public int SoDonDaDuyet { get; set; }
        public int SoDonChoDuyet { get; set; }
    }
}
================================================================================

E:\Tai Lieu Hoc Tap\CS 445 AM\Project\CafebookModel\Model\ModelApp\BaoCaoSachDto.cs
================================================================================
﻿using System;
using System.Collections.Generic;

namespace CafebookModel.Model.ModelApp
{
    /// <summary>
    /// DTO để gửi yêu cầu lọc (filters) lên API
    /// </summary>
    public class BaoCaoSachRequestDto
    {
        public string? SearchText { get; set; }
        public int? TheLoaiId { get; set; }
        public int? TacGiaId { get; set; }
    }

    /// <summary>
    /// DTO chứa dữ liệu cho các ComboBox lọc
    /// </summary>
    public class FilterLookupDto
    {
        public int Id { get; set; }
        public string Ten { get; set; } = string.Empty;
        public string? MoTa { get; set; } // <--- THÊM DÒNG NÀY
    }

    /// <summary>
    /// DTO chứa toàn bộ kết quả báo cáo Sách
    /// </summary>
    public class BaoCaoSachTongHopDto
    {
        public BaoCaoSachKpiDto Kpi { get; set; } = new();
        public List<BaoCaoSachChiTietDto> ChiTietTonKho { get; set; } = new();
        public List<BaoCaoSachTreHanDto> SachTreHan { get; set; } = new();
        public List<TopSachDuocThueDto> TopSachThue { get; set; } = new();
    }

    // -- Các lớp con cho báo cáo chi tiết --

    // Dùng cho KPI
    public class BaoCaoSachKpiDto
    {
        public int TongDauSach { get; set; }
        public int TongSoLuong { get; set; }
        public int DangChoThue { get; set; }
        public int SanSang { get; set; }
    }

    // Dùng cho Tab 1
    public class BaoCaoSachChiTietDto
    {
        public string TenSach { get; set; } = string.Empty;
        public string? TenTacGia { get; set; }
        public string? TenTheLoai { get; set; }
        public int SoLuongTong { get; set; }
        public int SoLuongDangMuon { get; set; }
        public int SoLuongConLai { get; set; }
    }

    // Dùng cho Tab 2
    public class BaoCaoSachTreHanDto
    {
        public string TenSach { get; set; } = string.Empty;
        public string HoTen { get; set; } = string.Empty;
        public string? SoDienThoai { get; set; }
        public DateTime NgayThue { get; set; }
        public DateTime NgayHenTra { get; set; }
        public string TinhTrang { get; set; } = string.Empty;
    }

    // Dùng cho Tab 3
    public class TopSachDuocThueDto
    {
        public string TenSach { get; set; } = string.Empty;
        public string? TenTacGia { get; set; }
        public int TongLuotThue { get; set; }
    }
}
================================================================================

E:\Tai Lieu Hoc Tap\CS 445 AM\Project\CafebookModel\Model\ModelApp\BaoCaoTonKhoDto.cs
================================================================================
﻿using System;
using System.Collections.Generic;

namespace CafebookModel.Model.ModelApp
{
    /// <summary>
    /// DTO để gửi yêu cầu lọc (filters) lên API
    /// </summary>
    public class BaoCaoTonKhoRequestDto
    {
        public string? SearchText { get; set; }
        public int? NhaCungCapId { get; set; }
        public bool ShowLowStockOnly { get; set; }
    }

    /// <summary>
    /// DTO chứa toàn bộ kết quả báo cáo Kho
    /// </summary>
    public class BaoCaoTonKhoTongHopDto
    {
        public BaoCaoTonKhoKpiDto Kpi { get; set; } = new();
        public List<BaoCaoTonKhoChiTietDto> ChiTietTonKho { get; set; } = new();
        public List<BaoCaoKiemKeDto> LichSuKiemKe { get; set; } = new();
        public List<BaoCaoHuyHangDto> LichSuHuyHang { get; set; } = new();
    }

    // -- Các lớp con cho báo cáo chi tiết --

    // Dùng cho KPI
    public class BaoCaoTonKhoKpiDto
    {
        public decimal TongGiaTriTonKho { get; set; }
        public int SoLuongSPSapHet { get; set; }
        public decimal TongGiaTriDaHuy { get; set; }
    }

    // Dùng cho Tab 1
    public class BaoCaoTonKhoChiTietDto
    {
        public string TenNguyenLieu { get; set; } = string.Empty;
        public string DonViTinh { get; set; } = string.Empty; 
        public decimal TonKho { get; set; }
        public decimal TonKhoToiThieu { get; set; }
        public string TinhTrang { get; set; } = string.Empty;
    }

    // Dùng cho Tab 2
    public class BaoCaoKiemKeDto
    {
        public DateTime NgayKiem { get; set; }
        public string TenNguyenLieu { get; set; } = string.Empty; 
        public decimal TonKhoHeThong { get; set; }
        public decimal TonKhoThucTe { get; set;}
        public decimal ChenhLech { get; set; }
        public string? LyDoChenhLech { get; set; }
    }

    // Dùng cho Tab 3
    public class BaoCaoHuyHangDto
    {
        public DateTime NgayHuy { get; set; }
        public string TenNguyenLieu { get; set; } = string.Empty; 
        public decimal SoLuongHuy { get; set; }
        public decimal GiaTriHuy { get; set; }
        public string LyDoHuy { get; set; } = string.Empty; 
    }
}
================================================================================

E:\Tai Lieu Hoc Tap\CS 445 AM\Project\CafebookModel\Model\ModelApp\CaiDatDto.cs
================================================================================
﻿namespace CafebookModel.Model.ModelApp
{
    // DTO để truyền dữ liệu từ bảng CaiDat
    public class CaiDatDto
    {
        // Khóa chính
        public string TenCaiDat { get; set; } = string.Empty;

        // Dữ liệu cần sửa
        public string GiaTri { get; set; } = string.Empty;

        // Chỉ để hiển thị
        public string? MoTa { get; set; }
    }
}
================================================================================

E:\Tai Lieu Hoc Tap\CS 445 AM\Project\CafebookModel\Model\ModelApp\CaiDatThongTinCuaHangDto.cs
================================================================================
﻿namespace CafebookModel.Model.ModelApp
{
    /// <summary>
    /// DTO chứa thông tin cơ bản của cửa hàng từ bảng CaiDat
    /// </summary>
    public class CaiDatThongTinCuaHangDto
    {
        public string TenQuan { get; set; } = "Cafe Sách";
        public string DiaChi { get; set; } = "N/A";
        public string SoDienThoai { get; set; } = "N/A";
    }
}
================================================================================

E:\Tai Lieu Hoc Tap\CS 445 AM\Project\CafebookModel\Model\ModelApp\ChartDataPoint.cs
================================================================================
﻿using System;

namespace CafebookModel.Model.ModelApp
{
    public class ChartDataPoint
    {
        public DateTime Ngay { get; set; }
        public decimal TongTien { get; set; }
    }
}
================================================================================

E:\Tai Lieu Hoc Tap\CS 445 AM\Project\CafebookModel\Model\ModelApp\DashboardSummaryDto.cs
================================================================================
﻿using System.Collections.Generic;

namespace CafebookModel.Model.ModelApp
{
    public class DashboardSummaryDto
    {
        public decimal TongDoanhThuHomNay { get; set; }
        public int TongDonHangHomNay { get; set; }
        public string SanPhamBanChayHomNay { get; set; } = "Chưa có";
        public List<ChartDataPoint> DoanhThu30Ngay { get; set; } = new();
    }
}
================================================================================

E:\Tai Lieu Hoc Tap\CS 445 AM\Project\CafebookModel\Model\ModelApp\DonHangDto.cs
================================================================================
﻿using CafebookModel.Model.ModelApp.NhanVien;
using System;
using System.Collections.Generic;

namespace CafebookModel.Model.ModelApp
{
    /// <summary>
    /// DTO cho DataGrid chính (Danh sách Đơn hàng)
    /// </summary>
    public class DonHangDto
    {
        public int IdHoaDon { get; set; }
        public DateTime ThoiGianTao { get; set; }
        public string? TenNhanVien { get; set; }
        public string? TenKhachHang { get; set; } // Thêm
        public string? SoBan { get; set; }
        public decimal ThanhTien { get; set; }
        public string TrangThai { get; set; } = string.Empty;
        public string LoaiHoaDon { get; set; } = string.Empty; // Thêm
    }

    /// <summary>
    /// DTO cho DataGrid chi tiết
    /// </summary>
    public class DonHangChiTietDto
    {
        public string TenSanPham { get; set; } = string.Empty;
        public int SoLuong { get; set; }
        public decimal ThanhTien { get; set; }
    }

    // ### THÊM DTO MỚI NÀY VÀO CUỐI FILE ###
    /// <summary>
    /// DTO mới: Chứa cả Món ăn và Phụ thu cho bảng chi tiết
    /// </summary>
    public class DonHangFullDetailsDto
    {
        public List<DonHangChiTietDto> Items { get; set; } = new();
        public List<PhuThuDto> Surcharges { get; set; } = new();
    }
    // ### KẾT THÚC THÊM MỚI ###

    /// <summary>
    /// DTO để lấy dữ liệu cho các ComboBox lọc
    /// </summary>
    public class DonHangFiltersDto
    {
        // FilterLookupDto đã được định nghĩa trong SachDto.cs
        public List<FilterLookupDto> NhanViens { get; set; } = new();
        public List<FilterLookupDto> KhachHangs { get; set; } = new();
    }
}
================================================================================

E:\Tai Lieu Hoc Tap\CS 445 AM\Project\CafebookModel\Model\ModelApp\DonViChuyenDoiDto.cs
================================================================================
﻿namespace CafebookModel.Model.ModelApp
{
    /// <summary>
    /// DTO cho DataGrid
    /// </summary>
    public class DonViChuyenDoiDtoo
    {
        public int IdChuyenDoi { get; set; }
        public int IdNguyenLieu { get; set; }
        public string TenNguyenLieu { get; set; } = string.Empty;
        public string TenDonVi { get; set; } = string.Empty;
        public decimal GiaTriQuyDoi { get; set; }
        public bool LaDonViCoBan { get; set; }
    }

    /// <summary>
    /// DTO để Gửi (Thêm/Sửa)
    /// </summary>
    public class DonViChuyenDoiUpdateRequestDto
    {
        public int IdNguyenLieu { get; set; }
        public string TenDonVi { get; set; } = string.Empty;
        public decimal GiaTriQuyDoi { get; set; }
        public bool LaDonViCoBan { get; set; }
    }
}
================================================================================

E:\Tai Lieu Hoc Tap\CS 445 AM\Project\CafebookModel\Model\ModelApp\KhachHangDto.cs
================================================================================
﻿using Microsoft.AspNetCore.Http;
using System;
using System.Collections.Generic;
using System.Text.Json.Serialization;

namespace CafebookModel.Model.ModelApp
{
    /// <summary>
    /// DTO cho DataGrid Khách hàng
    /// </summary>
    public class KhachHangDto
    {
        public int IdKhachHang { get; set; }
        public string HoTen { get; set; } = string.Empty;
        public string? SoDienThoai { get; set; }
        public string? Email { get; set; }
        public DateTime NgayTao { get; set; }
        public bool BiKhoa { get; set; }
        public string TrangThai => BiKhoa ? "Bị khóa" : "Hoạt động";
    }

    /// <summary>
    /// DTO cho Form (gồm Lịch sử)
    /// </summary>
    public class KhachHangDetailDto
    {
        public int IdKhachHang { get; set; }
        public string HoTen { get; set; } = string.Empty;
        public string? SoDienThoai { get; set; }
        public string? Email { get; set; }
        public string? DiaChi { get; set; }
        public int DiemTichLuy { get; set; }
        public string? TenDangNhap { get; set; }
        public bool BiKhoa { get; set; }
        public string? AnhDaiDienUrl { get; set; } // <-- SỬA: Dùng URL
        public List<LichSuDonHangDto> LichSuDonHang { get; set; } = new();
        public List<LichSuThueSachDto> LichSuThueSach { get; set; } = new();
    }

    /// <summary>
    /// DTO để Gửi (Thêm/Sửa)
    /// </summary>
    public class KhachHangUpdateRequestDto
    {
        public int IdKhachHang { get; set; }
        public string HoTen { get; set; } = string.Empty;
        public string? SoDienThoai { get; set; }
        public string? Email { get; set; }
        public string? DiaChi { get; set; }
        public int DiemTichLuy { get; set; }
        public string? TenDangNhap { get; set; }

        // SỬA: Xóa Base64, thêm 2 dòng này
        [JsonIgnore]
        public IFormFile? AnhDaiDienUpload { get; set; }
        [JsonIgnore]
        public bool XoaAnhDaiDien { get; set; } = false;
    }

    // --- DTOs con cho Lịch sử ---
    public class LichSuDonHangDto
    {
        public int IdHoaDon { get; set; }
        public DateTime ThoiGianTao { get; set; }
        public decimal ThanhTien { get; set; }
        public string TrangThai { get; set; } = string.Empty;
    }

    public class LichSuThueSachDto
    {
        public int IdPhieuThue { get; set; }
        public string TieuDeSach { get; set; } = string.Empty;
        public DateTime NgayThue { get; set; }
        public string TrangThai { get; set; } = string.Empty;
    }
}
================================================================================

E:\Tai Lieu Hoc Tap\CS 445 AM\Project\CafebookModel\Model\ModelApp\KhoDto.cs
================================================================================
﻿using System;
using System.Collections.Generic;

namespace CafebookModel.Model.ModelApp
{
    // --- CÁC DTO ĐÃ CÓ ---
    #region DTOs (Đã có)

    // DTO cho Tab 1: Tồn Kho
    public class NguyenLieuTonKhoDto
    {
        public int IdNguyenLieu { get; set; }
        public string TenNguyenLieu { get; set; } = string.Empty;
        public decimal TonKho { get; set; }
        public string DonViTinh { get; set; } = string.Empty;
        public decimal TonKhoToiThieu { get; set; }
        public string TinhTrang { get; set; } = string.Empty;
    }

    // DTO cho Tab 2: CRUD Nguyên Liệu (ĐÃ SỬA LỖI CS0117)
    public class NguyenLieuCrudDto
    {
        public int IdNguyenLieu { get; set; }
        public string TenNguyenLieu { get; set; } = string.Empty;
        public string DonViTinh { get; set; } = string.Empty;
        public decimal TonKhoToiThieu { get; set; }
        public decimal TonKho { get; set; } // <-- Thêm cột này
    }

    // DTO để Gửi (Thêm/Sửa) Nguyên Liệu
    public class NguyenLieuUpdateRequestDto
    {
        public string TenNguyenLieu { get; set; } = string.Empty;
        public string DonViTinh { get; set; } = string.Empty;
        public decimal TonKhoToiThieu { get; set; }
    }

    // DTO cho Tab 4: CRUD Nhà Cung Cấp
    public class NhaCungCapDto
    {
        public int IdNhaCungCap { get; set; }
        public string TenNhaCungCap { get; set; } = string.Empty;
        public string? SoDienThoai { get; set; }
        public string? DiaChi { get; set; }
        public string? Email { get; set; }
    }

    // DTO cho Tab 3: DataGrid Phiếu Nhập
    public class PhieuNhapDto
    {
        public int IdPhieuNhapKho { get; set; }
        public DateTime NgayNhap { get; set; }
        public string? TenNhaCungCap { get; set; }
        public string TenNhanVien { get; set; } = string.Empty;
        public decimal TongTien { get; set; }
        public string TrangThai { get; set; } = string.Empty;
    }

    // DTO cho Tab 3: DataGrid Chi Tiết Phiếu Nhập
    public class ChiTietPhieuNhapDto
    {
        public int IdNguyenLieu { get; set; }
        public string? TenNguyenLieu { get; set; }
        public decimal SoLuongNhap { get; set; }
        public decimal DonGiaNhap { get; set; }
        public decimal ThanhTien { get; set; }
    }

    // DTO để Gửi (POST) một Phiếu Nhập Mới
    public class PhieuNhapCreateDto
    {
        public int IdNhanVien { get; set; }
        public int? IdNhaCungCap { get; set; }
        public DateTime NgayNhap { get; set; }
        public string? GhiChu { get; set; }
        public List<ChiTietPhieuNhapCreateDto> ChiTiet { get; set; } = new();
    }

    // DTO con cho Phiếu Nhập Mới
    public class ChiTietPhieuNhapCreateDto
    {
        public int IdNguyenLieu { get; set; }
        public decimal SoLuongNhap { get; set; }
        public decimal DonGiaNhap { get; set; }
    }
    #endregion

    // --- THÊM CÁC DTO MỚI CHO XUẤT HỦY VÀ KIỂM KHO ---
    #region DTOs (Mới)

    // --- DTOs cho Chức năng Xuất Hủy ---

    public class PhieuXuatHuyDto
    {
        public int IdPhieuXuatHuy { get; set; }
        public DateTime NgayXuatHuy { get; set; }
        public string TenNhanVien { get; set; } = string.Empty;
        public string LyDoXuatHuy { get; set; } = string.Empty;
        public decimal TongGiaTriHuy { get; set; }
    }

    public class ChiTietPhieuXuatHuyDto
    {
        public int IdNguyenLieu { get; set; }
        public string? TenNguyenLieu { get; set; }
        public decimal SoLuong { get; set; }
        public decimal DonGiaVon { get; set; }
        public decimal ThanhTien { get; set; }
    }

    public class PhieuXuatHuyCreateDto
    {
        public int IdNhanVien { get; set; }
        public DateTime NgayXuatHuy { get; set; }
        public string LyDoXuatHuy { get; set; } = string.Empty;
        public List<ChiTietPhieuXuatHuyCreateDto> ChiTiet { get; set; } = new();
    }

    public class ChiTietPhieuXuatHuyCreateDto
    {
        public int IdNguyenLieu { get; set; }
        public decimal SoLuong { get; set; }
    }

    // --- DTOs cho Chức năng Kiểm Kho ---

    public class PhieuKiemKhoDto
    {
        public int IdPhieuKiemKho { get; set; }
        public DateTime NgayKiem { get; set; }
        public string TenNhanVienKiem { get; set; } = string.Empty;
        public string TrangThai { get; set; } = string.Empty;
    }

    public class ChiTietKiemKhoDto
    {
        public int IdNguyenLieu { get; set; }
        public string TenNguyenLieu { get; set; } = string.Empty;
        public string DonViTinh { get; set; } = string.Empty;
        public decimal TonKhoHeThong { get; set; }
        public decimal TonKhoThucTe { get; set; }
        public decimal ChenhLech => TonKhoThucTe - TonKhoHeThong;
        public string? LyDoChenhLech { get; set; }
        public decimal GiaTriChenhLech { get; set; } // Tính toán từ API
    }

    public class PhieuKiemKhoCreateDto
    {
        public int IdNhanVien { get; set; }
        public DateTime NgayKiem { get; set; }
        public string? GhiChu { get; set; }
        // Dùng lại ChiTietKiemKhoDto vì nó chứa đủ thông tin
        public List<ChiTietKiemKhoDto> ChiTiet { get; set; } = new();
    }

    #endregion
}
================================================================================

E:\Tai Lieu Hoc Tap\CS 445 AM\Project\CafebookModel\Model\ModelApp\KhuyenMaiDto.cs
================================================================================
﻿using System;
using System.Collections.Generic;

namespace CafebookModel.Model.ModelApp
{
    /// <summary>
    /// DTO cho DataGrid Khuyến mãi (Đã cập nhật)
    /// </summary>
    public class KhuyenMaiDto
    {
        public int IdKhuyenMai { get; set; }
        public string MaKhuyenMai { get; set; } = string.Empty;
        public string TenKhuyenMai { get; set; } = string.Empty;
        public string GiaTriGiam { get; set; } = string.Empty;
        public decimal? GiamToiDa { get; set; }
        public string? DieuKienApDung { get; set; }
        public DateTime NgayBatDau { get; set; }
        public DateTime NgayKetThuc { get; set; }
        public string TrangThai { get; set; } = string.Empty; // <-- Lỗi CS0102/CS0229 đã được fix (không trùng lặp)

        // SỬA: BỔ SUNG TRƯỜNG CÒN THIẾU
        public int? SoLuongConLai { get; set; }
    }

    /// <summary>
    /// DTO để tải chi tiết và cập nhật Khuyến mãi (Đã cập nhật)
    /// </summary>
    public class KhuyenMaiUpdateRequestDto
    {
        public int IdKhuyenMai { get; set; }
        public string MaKhuyenMai { get; set; } = string.Empty;
        public string TenChuongTrinh { get; set; } = string.Empty;
        public string? MoTa { get; set; }
        public string LoaiGiamGia { get; set; } = string.Empty;
        public decimal GiaTriGiam { get; set; }

        // SỬA: BỔ SUNG CÁC TRƯỜNG CÒN THIẾU
        public decimal? GiamToiDa { get; set; }
        public decimal? HoaDonToiThieu { get; set; }
        public int? IdSanPhamApDung { get; set; }
        public DateTime NgayBatDau { get; set; }
        public DateTime NgayKetThuc { get; set; }
        public string? NgayTrongTuan { get; set; }
        public string? GioBatDau { get; set; } // Sẽ ở dạng "HH:mm"
        public string? GioKetThuc { get; set; } // Sẽ ở dạng "HH:mm"
        public int? SoLuongConLai { get; set; }
        public string TrangThai { get; set; } = string.Empty;
        public string? DieuKienApDung { get; set; }
    }


/// <summary>
/// DTO lấy các bộ lọc cho Form Khuyến mãi
/// </summary>
public class KhuyenMaiFiltersDto
    {
        public List<FilterLookupDto> SanPhams { get; set; } = new();
    }
}
================================================================================

E:\Tai Lieu Hoc Tap\CS 445 AM\Project\CafebookModel\Model\ModelApp\NguoiGiaoHangDto.cs
================================================================================
﻿namespace CafebookModel.Model.ModelApp
{
    /// <summary>
    /// DTO đầy đủ để quản lý thêm/sửa xóa Shipper
    /// </summary>
    public class NguoiGiaoHangCrudDto
    {
        public int IdNguoiGiaoHang { get; set; }
        public string TenNguoiGiaoHang { get; set; } = string.Empty;
        public string SoDienThoai { get; set; } = string.Empty;
        public string TrangThai { get; set; } = "Sẵn sàng"; // "Sẵn sàng", "Tạm ngưng"
    }
}
================================================================================

E:\Tai Lieu Hoc Tap\CS 445 AM\Project\CafebookModel\Model\ModelApp\NhanSuDto.cs
================================================================================
﻿// File: CafebookModel/Model/ModelApp/NhanSuDto.cs (Cập nhật)

using Microsoft.AspNetCore.Http;
using System;
using System.Collections.Generic;
using System.Text.Json.Serialization;

namespace CafebookModel.Model.ModelApp
{
    /// <summary>
    /// DTO cho DataGrid chính (Danh sách Nhân Viên) - ĐÃ ĐỔI TÊN
    /// </summary>
    public class NhanVienGridDto
    {
        public int IdNhanVien { get; set; }
        public string HoTen { get; set; } = string.Empty;
        public string TenVaiTro { get; set; } = string.Empty;
        public decimal LuongCoBan { get; set; }
        public string TrangThaiLamViec { get; set; } = string.Empty;
    }

    /// <summary>
    /// SỬA: DTO cho Form (GetDetails)
    /// </summary>
    public class NhanVienDetailDto
    {
        public int IdNhanVien { get; set; }
        public string HoTen { get; set; } = string.Empty;
        public string TenDangNhap { get; set; } = string.Empty;
        public int IdVaiTro { get; set; }
        public decimal LuongCoBan { get; set; }
        public string TrangThaiLamViec { get; set; } = string.Empty;
        public string? SoDienThoai { get; set; }
        public string? Email { get; set; }
        public string? DiaChi { get; set; }
        public DateTime NgayVaoLam { get; set; }
        public string? AnhDaiDienUrl { get; set; } // <-- SỬA: Dùng URL
    }

    /// <summary>
    /// SỬA: DTO cho Form (Thêm/Sửa)
    /// </summary>
    public class NhanVienUpdateRequestDto
    {
        public int IdNhanVien { get; set; }
        public string HoTen { get; set; } = string.Empty;
        public string TenDangNhap { get; set; } = string.Empty;
        public string? MatKhau { get; set; }
        public int IdVaiTro { get; set; }
        public decimal LuongCoBan { get; set; }
        public string TrangThaiLamViec { get; set; } = string.Empty;
        public string? SoDienThoai { get; set; }
        public string? Email { get; set; }
        public string? DiaChi { get; set; }
        public DateTime NgayVaoLam { get; set; }

        // SỬA: Xóa Base64, thêm 2 dòng này
        [JsonIgnore]
        public IFormFile? AnhDaiDienUpload { get; set; }
        [JsonIgnore]
        public bool XoaAnhDaiDien { get; set; } = false;
    }

    /// <summary>
    /// DTO cho ComboBox lọc - (Giữ nguyên)
    /// </summary>
    public class NhanSuFiltersDto
    {
        // Dùng FilterLookupDto (đã có)
        public List<FilterLookupDto> VaiTros { get; set; } = new();
    }

    /// <summary>
    /// DTO cho DataGrid Vai Trò - (Giữ nguyên)
    /// </summary>
    public class VaiTroDto
    {
        public int IdVaiTro { get; set; }
        public string TenVaiTro { get; set; } = string.Empty;
        public string? MoTa { get; set; }
    }

    /// <summary>
    /// DTO cho một Quyền, dùng để hiển thị trên UI (ListView)
    /// </summary>
    public class QuyenDto
    {
        public string IdQuyen { get; set; } = string.Empty;
        public string TenQuyen { get; set; } = string.Empty;
        public string NhomQuyen { get; set; } = string.Empty;
    }

    /// <summary>
    /// DTO dùng để gửi cấu hình quyền mới lên API
    /// </summary>
    public class PhanQuyenDto
    {
        public int IdVaiTro { get; set; }
        public List<string> DanhSachIdQuyen { get; set; } = new List<string>();
    }

    // === BẮT ĐẦU THÊM MỚI CHO YÊU CẦU #4 ===

    /// <summary>
    /// DTO cho Ca Làm Việc Mẫu (Bảng CaLamViec)
    /// </summary>
    public class CaLamViecDto
    {
        public int IdCa { get; set; }
        public string TenCa { get; set; } = string.Empty;

        // Dùng TimeSpan để API/WPF làm việc, CSDL sẽ lưu kiểu TIME
        public TimeSpan GioBatDau { get; set; }
        public TimeSpan GioKetThuc { get; set; }
    }

    /// <summary>
    /// DTO dùng để hiển thị 1 mục trong lịch làm việc
    /// (Kết hợp từ LichLamViec và DonXinNghi)
    /// </summary>
    public class LichLamViecDisplayDto
    {
        public int IdLich { get; set; } // Có thể là idLichLamViec hoặc idDonXinNghi
        public int IdNhanVien { get; set; }
        public string HoTenNhanVien { get; set; } = string.Empty;
        public DateTime Ngay { get; set; }

        // Loại lịch: "CaLam" hoặc "NghiPhep"
        public string LoaiLich { get; set; } = string.Empty;

        // Thông tin nếu là CaLam
        public string? TenCa { get; set; }
        public TimeSpan? GioBatDau { get; set; }
        public TimeSpan? GioKetThuc { get; set; }

        // Thông tin nếu là NghiPhep
        public string? LyDoNghi { get; set; }
    }

    /// <summary>
    /// DTO dùng để gán lịch làm việc hàng loạt
    /// </summary>
    public class LichLamViecCreateDto
    {
        public DateTime NgayGanLich { get; set; }
        public int IdCa { get; set; }
        public List<int> DanhSachIdNhanVien { get; set; } = new List<int>();
    }

    /// <summary>
    /// DTO đơn giản để chọn nhân viên gán lịch
    /// </summary>
    public class NhanVienLookupDto
    {
        public int IdNhanVien { get; set; }
        public string HoTen { get; set; } = string.Empty;
    }

    /// <summary>
    /// DTO cho kết quả trả về của API Gán Lịch
    /// </summary>
    public class LichLamViecAssignResponseDto
    {
        public string Message { get; set; } = string.Empty;
        public List<string> Failures { get; set; } = new List<string>();
    }

    // === BẮT ĐẦU THÊM MỚI CHO YÊU CẦU #5 ===

    /// <summary>
    /// DTO để hiển thị danh sách Đơn Xin Nghỉ trên DataGrid
    /// </summary>
    public class DonXinNghiDto
    {
        public int IdDonXinNghi { get; set; }
        public string TenNhanVien { get; set; } = string.Empty;
        public string LoaiDon { get; set; } = string.Empty;
        public DateTime NgayBatDau { get; set; }
        public DateTime NgayKetThuc { get; set; }
        public string LyDo { get; set; } = string.Empty;
        public string TrangThai { get; set; } = string.Empty;
        public string? TenNguoiDuyet { get; set; }
        public DateTime? NgayDuyet { get; set; }
        public string? GhiChuPheDuyet { get; set; }
    }

    /// <summary>
    /// DTO dùng để Thêm mới một đơn
    /// </summary>
    public class DonXinNghiCreateDto
    {
        // Quản lý có thể tạo đơn cho nhân viên
        public int IdNhanVien { get; set; }
        public string LoaiDon { get; set; } = string.Empty;
        public string LyDo { get; set; } = string.Empty;
        public DateTime NgayBatDau { get; set; }
        public DateTime NgayKetThuc { get; set; }
    }

    /// <summary>
    /// DTO dùng để Duyệt/Từ chối một đơn
    /// </summary>
    public class DonXinNghiActionDto
    {
        public int IdNguoiDuyet { get; set; }
        public string? GhiChuPheDuyet { get; set; }
    }

    // === BẮT ĐẦU THÊM MỚI CHO YÊU CẦU #6 ===

    /// <summary>
    /// DTO hiển thị Bảng Chấm Công (Module 6.1)
    /// </summary>
    public class ChamCongDto
    {
        public int IdChamCong { get; set; }
        public int IdLichLamViec { get; set; }
        public string HoTenNhanVien { get; set; } = string.Empty;
        public string TenCa { get; set; } = string.Empty;
        public DateTime NgayLam { get; set; }
        public TimeSpan GioCaBatDau { get; set; }
        public TimeSpan GioCaKetThuc { get; set; }
        public DateTime? GioVao { get; set; }
        public DateTime? GioRa { get; set; }
        public decimal SoGioLam { get; set; } // <-- SỬA: double -> decimal
        public string TrangThai { get; set; } = string.Empty; // "Đúng giờ", "Đi trễ", "Về sớm"
    }

    /// <summary>
    /// DTO cập nhật Chấm công thủ công (Module 6.1)
    /// </summary>
    public class ChamCongUpdateDto
    {
        public int IdChamCong { get; set; }
        public int IdLichLamViec { get; set; } // <-- THÊM DÒNG NÀY
        public DateTime? GioVaoMoi { get; set; }
        public DateTime? GioRaMoi { get; set; }
    }

    /// <summary>
    /// DTO hiển thị Thưởng/Phạt thủ công (Module 6.2.3)
    /// </summary>
    public class PhieuThuongPhatDto
    {
        public int IdPhieuThuongPhat { get; set; }
        public int IdNhanVien { get; set; }
        public string HoTenNhanVien { get; set; } = string.Empty;
        public DateTime NgayTao { get; set; }
        public decimal SoTien { get; set; }
        public string LyDo { get; set; } = string.Empty;
        public string TenNguoiTao { get; set; } = string.Empty;
    }

    /// <summary>
    /// DTO tạo Thưởng/Phạt thủ công (Module 6.2.3)
    /// </summary>
    public class PhieuThuongPhatCreateDto
    {
        public int IdNhanVien { get; set; }
        public int IdNguoiTao { get; set; }
        public decimal SoTien { get; set; }
        public string LyDo { get; set; } = string.Empty;
    }

    /// <summary>
    /// DTO Bảng kê lương (Trước khi chốt) (Module 6.3)
    /// </summary>
    public class LuongBangKeDto
    {
        public int IdNhanVien { get; set; }
        public string HoTenNhanVien { get; set; } = string.Empty;
        public decimal LuongCoBan { get; set; } // Lương/giờ
        public decimal TongGioLam { get; set; }
        public decimal TienLuongGio { get; set; }
        public decimal TongThuong { get; set; } // Auto (OT) + Manual
        public decimal TongPhat { get; set; }  // Auto (Late) + Manual
        public decimal ThucLanh { get; set; }
        public string ChiTiet { get; set; } = string.Empty;
    }

    /// <summary>
    /// DTO Chốt Lương (Module 6.4)
    /// </summary>
    public class LuongFinalizeDto
    {
        public int Thang { get; set; }
        public int Nam { get; set; }
        public int IdNguoiChot { get; set; }
        // Gửi toàn bộ bảng kê lên để lưu
        public List<LuongBangKeDto> DanhSachBangKe { get; set; } = new List<LuongBangKeDto>();
    }

    /// <summary>
    /// DTO để Tải và Lưu toàn bộ Cài Đặt Nhân Sự
    /// </summary>
    public class CaiDatNhanSuDto
    {
        // Giờ làm & OT
        public decimal GioLamChuan { get; set; }
        public decimal HeSoOT { get; set; }

        // Phạt đi trễ
        public int PhatDiTre_Phut { get; set; }
        public decimal PhatDiTre_HeSo { get; set; }

        // Thưởng chuyên cần
        public int ChuyenCan_SoNgay { get; set; }
        public decimal ChuyenCan_TienThuong { get; set; }

        // Chính sách nghỉ
        public int PhepNam_MacDinh { get; set; }
    }

    // === BẮT ĐẦU THÊM MỚI CHO YÊU CẦU #8 ===

    /// <summary>
    /// DTO Gửi yêu cầu lọc Báo cáo
    /// </summary>
    public class BaoCaoNhanSuRequestDto
    {
        public DateTime StartDate { get; set; }
        public DateTime EndDate { get; set; }
        public int IdNhanVien { get; set; } // 0 = Tất cả
        public int IdVaiTro { get; set; } // 0 = Tất cả
        public string TrangThaiNhanVien { get; set; } = "Đang làm việc"; // "Tất cả", "Đang làm việc", "Nghỉ việc"
    }

    /// <summary>
    /// DTO (Cha) chứa toàn bộ kết quả Báo cáo
    /// </summary>
    public class BaoCaoNhanSuDto
    {
        public BaoCaoNhanSu_KpiDto Kpi { get; set; } = new();
        public List<BaoCaoNhanSu_BangLuongDto> BangLuongChiTiet { get; set; } = new();
        public List<BaoCaoNhanSu_NghiPhepDto> ThongKeNghiPhep { get; set; } = new();
        public List<ChartDataPoint> LuongChartData { get; set; } = new(); // Tận dụng DTO từ Dashboard
    }

    /// <summary>
    /// DTO cho các thẻ KPI
    /// </summary>
    public class BaoCaoNhanSu_KpiDto
    {
        public int SoLuongNhanVien { get; set; }
        public decimal TongLuongDaTra { get; set; }
        public decimal TongGioLam { get; set; }
        public int TongSoNgayNghi { get; set; }
    }

    /// <summary>
    // DTO cho Tab 1: Báo cáo Lương (Tổng hợp từ PhieuLuong)
    /// </summary>
    public class BaoCaoNhanSu_BangLuongDto
    {
        public int IdNhanVien { get; set; }
        public string HoTenNhanVien { get; set; } = string.Empty;
        public string TenVaiTro { get; set; } = string.Empty;
        public decimal TongGioLam { get; set; }
        public decimal TongLuongCoBan { get; set; }
        public decimal TongThuong { get; set; }
        public decimal TongPhat { get; set; }
        public decimal ThucLanh { get; set; }
    }

    /// <summary>
    // DTO cho Tab 2: Báo cáo Nghỉ Phép (Tổng hợp từ DonXinNghi)
    /// </summary>
    public class BaoCaoNhanSu_NghiPhepDto
    {
        public int IdNhanVien { get; set; }
        public string HoTenNhanVien { get; set; } = string.Empty;
        public string TenVaiTro { get; set; } = string.Empty;
        public int SoDonDaDuyet { get; set; }
        public int TongSoNgayNghi { get; set; }
    }

    /// <summary>
    /// DTO chứa các bộ lọc cho Báo cáo
    /// </summary>
    public class BaoCaoNhanSu_FiltersDto
    {
        public List<NhanVienLookupDto> NhanViens { get; set; } = new();
        public List<FilterLookupDto> VaiTros { get; set; } = new();
    }

    // (Thêm vào cuối file NhanSuDto.cs)

    /// <summary>
    /// DTO cho DataGrid ở trang QuanLyPhatLuongView
    /// </summary>
    public class PhatLuongListItemDto
    {
        public int IdPhieuLuong { get; set; }
        public string HoTenNhanVien { get; set; } = string.Empty;
        public string KyLuong { get; set; } = string.Empty; // "Tháng 11/2025"
        public decimal TongGioLam { get; set; }
        public decimal ThucLanh { get; set; }
        public DateTime NgayChot { get; set; }
        public string TrangThai { get; set; } = string.Empty; // "Đã chốt", "Đã phát"
    }

    /// <summary>
    /// DTO chi tiết cho Popup PhieuLuongPreviewWindow (A5)
    /// </summary>
    public class PhatLuongDetailDto
    {
        public int IdPhieuLuong { get; set; }
        public string HoTenNhanVien { get; set; } = string.Empty;
        public string KyLuong { get; set; } = string.Empty; // "Tháng 11/2025"
        public DateTime NgayBatDauKy { get; set; }
        public DateTime NgayKetThucKy { get; set; }
        public decimal LuongCoBan { get; set; } // Lương/giờ
        public decimal TongGioLam { get; set; }
        public decimal TienThuong { get; set; }
        public decimal KhauTru { get; set; }
        public decimal ThucLanh { get; set; }

        public string TrangThai { get; set; } = string.Empty;
        public DateTime NgayChot { get; set; }
        public DateTime? NgayPhat { get; set; }
        public string TenNguoiPhat { get; set; } = string.Empty; // Tên kế toán

        // Thông tin cửa hàng (tải từ CaiDat)
        public string TenQuan { get; set; } = "CAFEBOOK";
        public string DiaChi { get; set; } = string.Empty;
        public string SoDienThoai { get; set; } = string.Empty;
    }

    /// <summary>
    /// DTO gửi lên khi xác nhận phát lương
    /// </summary>
    public class XacNhanPhatDto
    {
        public int IdNguoiPhat { get; set; } // ID của kế toán/người bấm nút
    }
}
================================================================================

E:\Tai Lieu Hoc Tap\CS 445 AM\Project\CafebookModel\Model\ModelApp\PhatLuongDtos.cs
================================================================================
﻿using System;

namespace CafebookModel.Model.ModelApp
{
    /// <summary>
    /// DTO hiển thị danh sách phiếu lương đã chốt
    /// </summary>
    public class PhieuLuongDto
    {
        public int IdPhieuLuong { get; set; }
        public int IdNhanVien { get; set; }
        public string HoTenNhanVien { get; set; } = string.Empty;
        public int Thang { get; set; }
        public int Nam { get; set; }
        public decimal TongGioLam { get; set; }
        public decimal ThucLanh { get; set; }
        public DateTime NgayChot { get; set; }
        public string TrangThai { get; set; } = string.Empty; // "Đã chốt", "Đã phát"
    }


    /// <summary>
    /// DTO chi tiết phiếu lương để in hoặc xem
    /// </summary>
    public class PhieuLuongChiTietDto
    {
        public int IdPhieuLuong { get; set; }
        public string HoTenNhanVien { get; set; } = string.Empty;
        public int Thang { get; set; }
        public int Nam { get; set; }
        public decimal LuongCoBan { get; set; }
        public decimal TongGioLam { get; set; }
        public decimal TienThuong { get; set; }
        public decimal KhauTru { get; set; }
        public decimal ThucLanh { get; set; }
        public string TrangThai { get; set; } = string.Empty;
        public DateTime? NgayPhat { get; set; }
        public string? TenNguoiPhat { get; set; }

        public DateTime NgayBatDauKy => new DateTime(Nam, Thang, 1);
        public DateTime NgayKetThucKy => new DateTime(Nam, Thang, 1).AddMonths(1).AddDays(-1);
    }


    /// <summary>
    /// DTO gửi lên khi xác nhận phát lương
    /// </summary>
    public class PhatLuongXacNhanDto
    {
        public int IdNguoiPhat { get; set; }
    }
}
================================================================================

E:\Tai Lieu Hoc Tap\CS 445 AM\Project\CafebookModel\Model\ModelApp\QuanLyDanhGiaDto.cs
================================================================================
﻿using System;
using System.Collections.Generic;

namespace CafebookModel.Model.ModelApp
{
    // DTO chính để hiển thị một đánh giá trong ListView của quản lý
    public class DanhGiaQuanLyDto
    {
        public int IdDanhGia { get; set; }
        public int? IdSanPham { get; set; } // <-- ĐÃ THÊM
        public string TenKhachHang { get; set; } = string.Empty;
        public string? TenSanPham { get; set; } // Có thể null nếu là đánh giá chung
        public int SoSao { get; set; }
        public string? BinhLuan { get; set; }
        public string? HinhAnhUrl { get; set; } // API sẽ trả về URL đầy đủ
        public DateTime NgayTao { get; set; }
        public string TrangThai { get; set; } = string.Empty; // "Hiển thị" hoặc "Đã ẩn"
        public PhanHoiQuanLyDto? PhanHoi { get; set; }
    }

    // DTO cho phản hồi của nhân viên (nếu có)
    public class PhanHoiQuanLyDto
    {
        public string TenNhanVien { get; set; } = string.Empty;
        public string NoiDung { get; set; } = string.Empty;
        public DateTime NgayTao { get; set; }
    }

    // DTO dùng khi Quản lý gửi một phản hồi
    public class PhanHoiInputDto
    {
        public string NoiDung { get; set; } = string.Empty;
    }

    // DTO để nhận kết quả phân trang từ API
    public class PaginatedResult<T>
    {
        public List<T> Items { get; set; } = new List<T>();
        public int TotalPages { get; set; }
        public int CurrentPage { get; set; }
    }
    public class ProductSearchResultDto
    {
        public int IdSanPham { get; set; }
        public string TenSanPham { get; set; } = string.Empty;
    }

    public class ProductStatsDto
    {
        public int TotalReviews { get; set; }
        public double AverageRating { get; set; }
    }
}
================================================================================

E:\Tai Lieu Hoc Tap\CS 445 AM\Project\CafebookModel\Model\ModelApp\SachDto.cs
================================================================================
﻿// Tập tin: CafebookModel/Model/ModelApp/SachDto.cs
using System.Collections.Generic;
using System.Text.Json.Serialization;
using Microsoft.AspNetCore.Http;

namespace CafebookModel.Model.ModelApp
{
    /// <summary>
    /// DTO dùng để hiển thị Sách trên DataGrid (Đã sửa)
    /// </summary>
    public class SachDto
    {
        public int IdSach { get; set; }
        public string TenSach { get; set; } = string.Empty;
        public string? TenTacGia { get; set; } // Sẽ được nối chuỗi từ API (vd: "A, B, C")
        public string? TenTheLoai { get; set; } // Sẽ được nối chuỗi từ API
        public string? ViTri { get; set; }
        public int SoLuongTong { get; set; }
        public int SoLuongHienCo { get; set; }
        public int SoLuongDangMuon => SoLuongTong - SoLuongHienCo;
        public string? AnhBiaUrl { get; set; }
    }

    /// <summary>
    /// DTO (SỬA) cho Form Chi Tiết (Khi GetDetails)
    /// </summary>
    public class SachDetailDto
    {
        public int IdSach { get; set; }
        public string TenSach { get; set; } = string.Empty;

        // SỬA: Chuyển sang List<int>
        public List<int> IdTheLoais { get; set; } = new();
        public List<int> IdTacGias { get; set; } = new();
        public List<int> IdNhaXuatBans { get; set; } = new();

        public int? NamXuatBan { get; set; }
        public string? MoTa { get; set; }
        public int SoLuongTong { get; set; }
        public string? AnhBiaUrl { get; set; }
        public decimal? GiaBia { get; set; }
        public string? ViTri { get; set; }
    }

    /// <summary>
    /// DTO (SỬA) chỉ dùng để Tải Lên (Create/Update)
    /// </summary>
    public class SachUpdateRequestDto
    {
        public int IdSach { get; set; }
        public string TenSach { get; set; } = string.Empty;

        // SỬA: Chuyển sang List<int>
        public List<int> IdTheLoais { get; set; } = new();
        public List<int> IdTacGias { get; set; } = new();
        public List<int> IdNhaXuatBans { get; set; } = new();

        public int? NamXuatBan { get; set; }
        public string? MoTa { get; set; }
        public int SoLuongTong { get; set; }
        public decimal? GiaBia { get; set; }
        public string? ViTri { get; set; }

        [JsonIgnore]
        public IFormFile? AnhBiaUpload { get; set; }
        [JsonIgnore]
        public bool XoaAnhBia { get; set; } = false;
    }

    // (ĐÃ XÓA FilterLookupDto và BaoCaoSachTreHanDto khỏi đây)

    public class SachFiltersDto
    {
        public List<FilterLookupDto> TheLoais { get; set; } = new();
        public List<FilterLookupDto> TacGias { get; set; } = new();
        public List<FilterLookupDto> NhaXuatBans { get; set; } = new();
    }

    public class SachRentalsDto
    {
        public List<BaoCaoSachTreHanDto> SachQuaHan { get; set; } = new();
        public List<LichSuThueDto> LichSuThue { get; set; } = new();
    }

    public class LichSuThueDto
    {
        public string TenSach { get; set; } = string.Empty;
        public string TenKhachHang { get; set; } = string.Empty;
        public DateTime NgayThue { get; set; }
        public DateTime NgayHenTra { get; set; }
        public DateTime? NgayTraThucTe { get; set; }
        public decimal TienPhat { get; set; }
        public string TrangThai { get; set; } = string.Empty;
    }
}
================================================================================

E:\Tai Lieu Hoc Tap\CS 445 AM\Project\CafebookModel\Model\ModelApp\SanPhamDto.cs
================================================================================
﻿using Microsoft.AspNetCore.Http;
using System.Collections.Generic;
using System.Text.Json.Serialization;

namespace CafebookModel.Model.ModelApp
{
    /// <summary>
    /// DTO cho DataGrid (Tìm kiếm)
    /// </summary>
    public class SanPhamDto
    {
        public int IdSanPham { get; set; }
        public string TenSanPham { get; set; } = string.Empty;
        public decimal GiaBan { get; set; }
        public string? TenDanhMuc { get; set; }
        public bool TrangThaiKinhDoanh { get; set; }
        public string? HinhAnhUrl { get; set; } // SỬA: Dùng URL
    }

    /// <summary>
    /// DTO (MỚI) cho Form Chi Tiết (Khi GetDetails)
    /// </summary>
    public class SanPhamDetailDto
    {
        public int IdSanPham { get; set; }
        public string TenSanPham { get; set; } = string.Empty;
        public int? IdDanhMuc { get; set; }
        public decimal GiaBan { get; set; }
        public string? MoTa { get; set; }
        public bool TrangThaiKinhDoanh { get; set; }
        public string? NhomIn { get; set; }
        public string? HinhAnhUrl { get; set; } // DÙNG ĐỂ HIỂN THỊ
    }

    /// <summary>
    /// DTO (SỬA) chỉ dùng để Tải Lên (Create/Update)
    /// </summary>
    public class SanPhamUpdateRequestDto
    {
        public int IdSanPham { get; set; } // Sẽ = 0 nếu là Tạo mới
        public string TenSanPham { get; set; } = string.Empty;
        public int? IdDanhMuc { get; set; }
        public decimal GiaBan { get; set; }
        public string? MoTa { get; set; }
        public bool TrangThaiKinhDoanh { get; set; }
        public string? NhomIn { get; set; }

        // SỬA: Thêm 2 thuộc tính này để Swagger nhận diện
        [JsonIgnore]
        public IFormFile? HinhAnhUpload { get; set; }
        [JsonIgnore]
        public bool XoaHinhAnh { get; set; } = false;
    }

    // (Các DTO còn lại giữ nguyên)
    public class SanPhamFiltersDto
    {
        public List<FilterLookupDto> DanhMucs { get; set; } = new();
        public List<FilterLookupDto> NguyenLieus { get; set; } = new();
        public List<DonViChuyenDoiDto> DonViTinhs { get; set; } = new();
    }
    public class DonViChuyenDoiDto
    {
        public int Id { get; set; }
        public int IdNguyenLieu { get; set; }
        public string Ten { get; set; } = string.Empty;
    }
    public class DinhLuongDto
    {
        public int IdNguyenLieu { get; set; }
        public string TenNguyenLieu { get; set; } = string.Empty;
        public decimal SoLuong { get; set; }
        public int IdDonViSuDung { get; set; }
        public string TenDonViSuDung { get; set; } = string.Empty;
    }
    public class DinhLuongUpdateRequestDto
    {
        public int IdSanPham { get; set; }
        public int IdNguyenLieu { get; set; }
        public decimal SoLuong { get; set; }
        public int IdDonViSuDung { get; set; }
    }
}
================================================================================

E:\Tai Lieu Hoc Tap\CS 445 AM\Project\CafebookModel\Model\ModelApp\ThongBaoDto.cs
================================================================================
﻿using System;

namespace CafebookModel.Model.ModelApp
{
    public class ThongBaoDto
    {
        public int IdThongBao { get; set; }
        public string NoiDung { get; set; } = string.Empty;
        public DateTime ThoiGianTao { get; set; }
        public string? LoaiThongBao { get; set; }
        public int? IdLienQuan { get; set; } // idBan
        public bool DaXem { get; set; }
        public string? TenNhanVienTao { get; set; }
    }

    public class ThongBaoCountDto
    {
        public int UnreadCount { get; set; }
    }
}
================================================================================

E:\Tai Lieu Hoc Tap\CS 445 AM\Project\CafebookModel\Model\ModelApp\NhanVien\ChamCongDto.cs
================================================================================
﻿// Tệp: CafebookModel/Model/ModelApp/NhanVien/ChamCongDto.cs
using System;
using System.Collections.Generic; // THÊM USING NÀY

namespace CafebookModel.Model.ModelApp.NhanVien
{
    /// <summary>
    /// DTO trả về trạng thái tổng hợp cho Bảng điều khiển Chấm công
    /// </summary>
    public class ChamCongDashboardDto
    {
        /// <summary>
        /// Trạng thái chính: 
        /// "KhongCoCa", "ChuaChamCong", "DaChamCong", "DaTraCa", "NghiPhep"
        /// </summary>
        public string TrangThai { get; set; } = "KhongCoCa";

        // Thông tin ca làm
        public string? TenCa { get; set; }
        public TimeSpan? GioBatDauCa { get; set; }
        public TimeSpan? GioKetThucCa { get; set; }

        // Thông tin thực tế
        public DateTime? GioVao { get; set; }
        public DateTime? GioRa { get; set; }
        public decimal? SoGioLam { get; set; }

        // Thông tin nhân viên
        public string TenNhanVien { get; set; } = string.Empty;

        // === CẢI TIẾN MỚI ===

        /// <summary>
        /// Trạng thái đơn nghỉ: null (không có), "Chờ duyệt", "Đã duyệt", "Đã từ chối"
        /// </summary>
        public string? TrangThaiDonNghi { get; set; }

        /// <summary>
        /// Số lần chấm công trễ trong tháng này
        /// </summary>
        public int SoLanDiTreThangNay { get; set; } = 0;
    }


    // === THÊM CÁC LỚP MỚI CHO TRANG LỊCH SỬ ===

    public class LichSuItemDto
    {
        public string Ngay { get; set; } = string.Empty;
        public string CaLamViec { get; set; } = string.Empty;
        public string GioVao { get; set; } = string.Empty;
        public string GioRa { get; set; } = string.Empty;
        public string DiTre { get; set; } = string.Empty; // (ví dụ: "15 phút")
        public decimal SoGioLam { get; set; }
    }

    public class DonNghiItemDto
    {
        public int IdDonXinNghi { get; set; }
        public string LoaiDon { get; set; } = string.Empty;
        public string ThoiGian { get; set; } = string.Empty; // (ví dụ: "01/11 - 02/11")
        public string LyDo { get; set; } = string.Empty;
        public string TrangThai { get; set; } = string.Empty;
        public string? PheDuyet { get; set; } // (Ghi chú của quản lý)
    }

    public class ThongKeChamCongDto
    {
        public decimal TongGioLam { get; set; }
        public int SoLanDiTre { get; set; }
        public int SoNgayNghiPhep { get; set; }
    }

    public class LichSuChamCongPageDto
    {
        public List<LichSuItemDto> LichSuChamCong { get; set; } = new List<LichSuItemDto>();
        public List<DonNghiItemDto> DanhSachDonNghi { get; set; } = new List<DonNghiItemDto>();
        public ThongKeChamCongDto ThongKe { get; set; } = new ThongKeChamCongDto();
    }

}
================================================================================

E:\Tai Lieu Hoc Tap\CS 445 AM\Project\CafebookModel\Model\ModelApp\NhanVien\CheBienDto.cs
================================================================================
﻿using System;
using System.Collections.Generic; // Thêm

namespace CafebookModel.Model.ModelApp.NhanVien
{
    // DTO cho một món ăn hiển thị trên màn hình bếp
    public class CheBienItemDto
    {
        public int IdTrangThaiCheBien { get; set; }
        public int IdSanPham { get; set; } // <-- THÊM MỚI
        public string TenMon { get; set; } = string.Empty;
        public int SoLuong { get; set; }
        public string SoBan { get; set; } = string.Empty;
        public string? GhiChu { get; set; }
        public string TrangThai { get; set; } = string.Empty; // Chờ làm, Đang làm
        public DateTime ThoiGianGoi { get; set; }
        public string NhomIn { get; set; } = string.Empty;

        // === SỬA LỖI XamlParseException TẠI ĐÂY ===
        // Chuyển đổi các thuộc tính expression-bodied (=>) thành các getter đầy đủ.

        /// <summary>
        /// Thuộc tính tính toán cho WPF
        /// </summary>
        public string ThoiGianGoiDisplay
        {
            get { return ThoiGianGoi.ToString("HH:mm:ss"); }
        }

        public string ThoiGianCho
        {
            get
            {
                var thoiGian = (DateTime.Now - ThoiGianGoi).TotalMinutes;
                return $"({Math.Floor(thoiGian)} phút)";
            }
        }

        public bool IsChoLam
        {
            get { return TrangThai == "Chờ làm"; }
        }

        public bool IsDangLam
        {
            get { return TrangThai == "Đang làm"; }
        }
    }

    // === THÊM MỚI DTO CHO CÔNG THỨC ===
    public class CongThucItemDto
    {
        public string TenNguyenLieu { get; set; } = string.Empty;
        public decimal SoLuongSuDung { get; set; }
        public string TenDonVi { get; set; } = string.Empty;
    }
}
================================================================================

E:\Tai Lieu Hoc Tap\CS 445 AM\Project\CafebookModel\Model\ModelApp\NhanVien\DatBanDtos.cs
================================================================================
﻿using System;
using System.Collections.Generic;

namespace CafebookModel.Model.ModelApp.NhanVien.DatBan
{
    // DTO dùng để hiển thị trên DataGrid của nhân viên
    public class PhieuDatBanDto
    {
        public int IdPhieuDatBan { get; set; }
        public string? TenKhachHang { get; set; }
        public string? SoDienThoai { get; set; }
        public string? Email { get; set; }
        public int IdBan { get; set; }
        public string? SoBan { get; set; }
        public string? TenKhuVuc { get; set; }
        public DateTime ThoiGianDat { get; set; }
        public int SoLuongKhach { get; set; }
        public string? TrangThai { get; set; }
        public string? GhiChu { get; set; }
        public int? IdKhachHang { get; set; }
    }

    // DTO dùng khi nhân viên tạo/cập nhật phiếu
    public class PhieuDatBanCreateUpdateDto
    {
        public int? IdPhieuDatBan { get; set; }
        public string TenKhachHang { get; set; } = string.Empty;
        public string SoDienThoai { get; set; } = string.Empty;
        public string? Email { get; set; }
        public int IdBan { get; set; }
        public DateTime ThoiGianDat { get; set; }
        public int SoLuongKhach { get; set; }
        public string? GhiChu { get; set; }
        public string TrangThai { get; set; } = "Đã xác nhận";
        public int IdNhanVienTao { get; set; }
        // IsKhachVangLai đã được XÓA
    }

    // DTO dùng cho form đặt bàn của khách hàng qua web
    public class PhieuDatBanWebCreateDto
    {
        public string TenKhachHang { get; set; } = string.Empty;
        public string SoDienThoai { get; set; } = string.Empty;
        public string? Email { get; set; }
        public int IdBan { get; set; }
        public DateTime ThoiGianDat { get; set; }
        public int SoLuongKhach { get; set; }
        public string? GhiChu { get; set; }
    }

    // DTO khi nhân viên xác nhận khách đến
    public class XacNhanKhachDenRequestDto
    {
        public int IdPhieuDatBan { get; set; }
        public int IdNhanVien { get; set; }
    }

    // DTO trả về id hóa đơn mới tạo khi khách đến
    public class XacNhanKhachDenResponseDto
    {
        public int IdHoaDon { get; set; }
    }

    // DTO dùng cho ComboBox chọn bàn
    public class BanDatBanDto
    {
        public int IdBan { get; set; }
        public string? SoBan { get; set; }
        public string? TenKhuVuc { get; set; }
        // SỬA: Thêm SoGhe để kiểm tra sức chứa (Yêu cầu 7)
        public int SoGhe { get; set; }
        public int? IdKhuVuc { get; set; } // Thêm IdKhuVuc để lọc
        public string HienThi => $"{SoBan} ({TenKhuVuc})";
    }

    // DTO cho chuông thông báo
    public class ThongBaoDto
    {
        public int IdThongBao { get; set; }
        public string? NoiDung { get; set; }
        public string? LoaiThongBao { get; set; }
        public int? IdLienQuan { get; set; }
        public bool DaXem { get; set; }
        public DateTime ThoiGianTao { get; set; }
    }

    // THÊM MỚI: DTO cho tìm kiếm khách hàng (Yêu cầu 5)
    public class KhachHangLookupDto
    {
        public int IdKhachHang { get; set; }
        public string HoTen { get; set; } = string.Empty;
        public string SoDienThoai { get; set; } = string.Empty;
        public string? Email { get; set; }
        // Thuộc tính để hiển thị trong ComboBox
        public string DisplaySdt => $"{HoTen} ({SoDienThoai})";
        public string DisplayEmail => $"{HoTen} ({Email})";
    }
}
================================================================================

E:\Tai Lieu Hoc Tap\CS 445 AM\Project\CafebookModel\Model\ModelApp\NhanVien\GiaoHangDto.cs
================================================================================
﻿// Tệp: CafebookModel/Model/ModelApp/NhanVien/GiaoHangDto.cs
using System;
using System.Collections.Generic;

namespace CafebookModel.Model.ModelApp.NhanVien
{
    /// <summary>
    /// DTO chính để tải trang Giao Hàng
    /// </summary>
    public class GiaoHangViewDto
    {
        public List<GiaoHangItemDto> DonGiaoHang { get; set; } = new List<GiaoHangItemDto>();
        public List<NguoiGiaoHangDto> NguoiGiaoHangSanSang { get; set; } = new List<NguoiGiaoHangDto>();
    }

    /// <summary>
    /// DTO đại diện cho một dòng (hóa đơn) trong danh sách giao hàng
    /// </summary>
    public class GiaoHangItemDto
    {
        public int IdHoaDon { get; set; }
        public DateTime ThoiGianTao { get; set; }
        public string? TenKhachHang { get; set; }
        public string? SoDienThoaiGiaoHang { get; set; }
        public string? DiaChiGiaoHang { get; set; }
        public decimal ThanhTien { get; set; }

        /// <summary>
        /// Trạng thái thanh toán (ví dụ: "Chưa thanh toán", "Đã thanh toán")
        /// </summary>
        public string TrangThaiThanhToan { get; set; } = string.Empty;

        /// <summary>
        /// Trạng thái giao hàng (ví dụ: "Chờ xác nhận", "Đang giao", "Hoàn thành")
        /// </summary>
        public string? TrangThaiGiaoHang { get; set; }

        public int? IdNguoiGiaoHang { get; set; }
        public string? TenNguoiGiaoHang { get; set; }
    }

    /// <summary>
    /// DTO cho ComboBox chọn người giao hàng
    /// </summary>
    public class NguoiGiaoHangDto
    {
        public int IdNguoiGiaoHang { get; set; }
        public string TenNguoiGiaoHang { get; set; } = string.Empty;
    }

    /// <summary>
    /// DTO để gửi cập nhật từ DataGrid
    /// </summary>
    public class GiaoHangUpdateRequestDto
    {
        public string? TrangThaiGiaoHang { get; set; }
        public int? IdNguoiGiaoHang { get; set; }
    }
}
================================================================================

E:\Tai Lieu Hoc Tap\CS 445 AM\Project\CafebookModel\Model\ModelApp\NhanVien\GoiMonDto.cs
================================================================================
﻿// Tập tin: CafebookModel/Model/ModelApp/NhanVien/GoiMonDto.cs
using System;
using System.Collections.Generic;

namespace CafebookModel.Model.ModelApp.NhanVien
{
    // DTO chính chứa toàn bộ dữ liệu cho trang GoiMonView
    public class GoiMonViewDto
    {
        public HoaDonInfoDto HoaDonInfo { get; set; } = default!;
        public List<ChiTietDto> ChiTietItems { get; set; } = default!;
        public List<SanPhamDto> SanPhams { get; set; } = default!;
        public List<DanhMucDto> DanhMucs { get; set; } = default!;
        public List<KhuyenMaiDto> KhuyenMais { get; set; } = default!;
    }

    // Thông tin cơ bản của hóa đơn (hiển thị ở panel bên phải)
    public class HoaDonInfoDto
    {
        public int IdHoaDon { get; set; }
        public string SoBan { get; set; } = default!;
        public string LoaiHoaDon { get; set; } = default!;
        public decimal TongTienGoc { get; set; }
        public decimal GiamGia { get; set; }
        public decimal ThanhTien { get; set; }
        public int? IdKhuyenMai { get; set; }
    }

    // DTO cho một dòng trong DataGrid (ChiTietHoaDon)
    public class ChiTietDto
    {
        public int IdChiTietHoaDon { get; set; }
        public int IdSanPham { get; set; }
        public string TenSanPham { get; set; } = default!;
        public int SoLuong { get; set; }
        public decimal DonGia { get; set; }
        public decimal ThanhTien { get; set; }
        public string? GhiChu { get; set; } // <-- NÂNG CẤP
    }

    // DTO cho một thẻ Sản Phẩm
    public class SanPhamDto
    {
        public int IdSanPham { get; set; }
        public string TenSanPham { get; set; } = default!;
        public decimal DonGia { get; set; }
        public string HinhAnh { get; set; } = default!;
        public int IdDanhMuc { get; set; }
    }

    // DTO cho Danh Mục (Sidebar trái)
    public class DanhMucDto
    {
        public int IdDanhMuc { get; set; }
        public string TenLoaiSP { get; set; } = default!;
    }

    // DTO cho ComboBox Khuyến mãi
    public class KhuyenMaiDto
    {
        public int IdKhuyenMai { get; set; }
        public string TenKhuyenMai { get; set; } = default!;
        public string LoaiGiamGia { get; set; } = default!;
        public decimal GiaTriGiam { get; set; }
    }

    // === CÁC DTO DÙNG ĐỂ GỬI YÊU CẦU LÊN API ===

    public class AddItemRequest
    {
        public int IdHoaDon { get; set; }
        public int IdSanPham { get; set; }
        public int SoLuong { get; set; }
        public string? GhiChu { get; set; } // <-- NÂNG CẤP
    }

    public class UpdateSoLuongRequest
    {
        public int IdChiTietHoaDon { get; set; }
        public int SoLuongMoi { get; set; }
    }

    public class ThanhToanRequest
    {
        public int IdHoaDon { get; set; }
        public int? IdKhuyenMai { get; set; }
        public string PhuongThucThanhToan { get; set; } = default!;
    }

    public class ApplyPromotionRequest
    {
        public int IdHoaDon { get; set; }
        public int? IdKhuyenMai { get; set; }
    }

    // DTO này dùng chung cho cả Phiếu Tạm Tính và Phiếu Bếp
    public class PhieuGoiMonPrintDto
    {
        public string IdPhieu { get; set; } = string.Empty;
        public string TenQuan { get; set; } = string.Empty;
        public string DiaChiQuan { get; set; } = string.Empty;
        public string SdtQuan { get; set; } = string.Empty;
        public DateTime NgayTao { get; set; }
        public string TenNhanVien { get; set; } = string.Empty;
        public string SoBan { get; set; } = string.Empty;
        public string? GhiChu { get; set; } // Ghi chú chung của HĐ
        public List<ChiTietDto> ChiTiet { get; set; } = new List<ChiTietDto>();
        public decimal TongTienGoc { get; set; }
        public decimal GiamGia { get; set; }
        public decimal ThanhTien { get; set; }
    }
}
================================================================================

E:\Tai Lieu Hoc Tap\CS 445 AM\Project\CafebookModel\Model\ModelApp\NhanVien\KhuyenMaiHienThiDto.cs
================================================================================
﻿namespace CafebookModel.Model.ModelApp.NhanVien
{
    // DTO này được API sử dụng để gửi về cửa sổ ChonKhuyenMaiWindow
    public class KhuyenMaiHienThiDto
    {
        public int IdKhuyenMai { get; set; }
        public string MaKhuyenMai { get; set; } = string.Empty;
        public string TenChuongTrinh { get; set; } = string.Empty;
        public string? DieuKienApDung { get; set; } // Hiển thị cho nhân viên
        public string LoaiGiamGia { get; set; } = string.Empty; // PhanTram, SoTien
        public decimal GiaTriGiam { get; set; }
        public decimal? GiamToiDa { get; set; }

        // === Các trường tính toán từ API ===
        public bool IsEligible { get; set; } // Đủ điều kiện
        public string? IneligibilityReason { get; set; } // Lý do không đủ điều kiện

        // === THÊM DÒNG NÀY ĐỂ SỬA LỖI BUILD ===
        public decimal CalculatedDiscount { get; set; } // Giá trị giảm thực tế để sắp xếp
    }
}
================================================================================

E:\Tai Lieu Hoc Tap\CS 445 AM\Project\CafebookModel\Model\ModelApp\NhanVien\LichLamViecDto.cs
================================================================================
﻿// Tệp: CafebookModel/Model/ModelApp/NhanVien/LichLamViecDto.cs
using System;
using System.Collections.Generic;

namespace CafebookModel.Model.ModelApp.NhanVien
{
    /// <summary>
    /// DTO cho chế độ xem Ngày (Day) và Tuần (Week)
    /// </summary>
    public class LichLamViecViewDto
    {
        public DateTime NgayBatDauTuan { get; set; }
        public DateTime NgayKetThucTuan { get; set; }
        public List<LichLamViecItemDto> LichLamViecTrongTuan { get; set; } = new List<LichLamViecItemDto>();
        public List<LichNghiItemDto> DonNghiTrongTuan { get; set; } = new List<LichNghiItemDto>();
    }

    /// <summary>
    /// DTO cho 1 ca làm (event có giờ)
    /// </summary>
    public class LichLamViecItemDto
    {
        public int IdLichLamViec { get; set; }
        public string TenCa { get; set; } = string.Empty;
        public DateTime NgayLam { get; set; }
        public TimeSpan GioBatDau { get; set; }
        public TimeSpan GioKetThuc { get; set; }
    }

    /// <summary>
    /// DTO cho 1 đơn nghỉ (event cả ngày)
    /// </summary>
    public class LichNghiItemDto
    {
        public string LoaiDon { get; set; } = string.Empty;
        public DateTime NgayBatDau { get; set; }
        public DateTime NgayKetThuc { get; set; }
    }


    // === THÊM MỚI CHO CHẾ ĐỘ XEM THÁNG ===

    /// <summary>
    /// DTO cho chế độ xem Tháng (Month)
    /// </summary>
    public class LichLamViecThangDto
    {
        // Danh sách các ngày trong tháng có sự kiện
        public List<LichLamViecNgayDto> NgayCoSuKien { get; set; } = new List<LichLamViecNgayDto>();
    }

    /// <summary>
    /// Đại diện cho 1 ngày trong ô lịch tháng
    /// </summary>
    public class LichLamViecNgayDto
    {
        public DateTime Ngay { get; set; }
        // Danh sách tên các sự kiện, ví dụ: "Ca Sáng (8h-12h)", "Nghỉ phép"
        public List<string> SuKien { get; set; } = new List<string>();
    }
}
================================================================================

E:\Tai Lieu Hoc Tap\CS 445 AM\Project\CafebookModel\Model\ModelApp\NhanVien\PhieuLuongDto.cs
================================================================================
﻿// Tệp: CafebookModel/Model/ModelApp/NhanVien/PhieuLuongDto.cs
using System;
using System.Collections.Generic;

namespace CafebookModel.Model.ModelApp.NhanVien
{
    /// <summary>
    /// DTO tổng quan, chứa danh sách các phiếu lương
    /// </summary>
    public class PhieuLuongViewDto
    {
        public List<PhieuLuongItemDto> DanhSachPhieuLuong { get; set; } = new List<PhieuLuongItemDto>();
    }

    /// <summary>
    /// DTO cho một mục trong danh sách (cột bên trái)
    /// </summary>
    public class PhieuLuongItemDto
    {
        public int IdPhieuLuong { get; set; }
        public int Thang { get; set; }
        public int Nam { get; set; }
        public decimal ThucLanh { get; set; }
        public string TrangThai { get; set; } = string.Empty;
        public string TieuDe => $"Phiếu lương tháng {Thang}/{Nam}";
    }

    /// <summary>
    /// DTO chi tiết cho một phiếu lương (cột bên phải)
    /// </summary>
    public class PhieuLuongChiTietDto
    {
        public int IdPhieuLuong { get; set; }
        public int Thang { get; set; }
        public int Nam { get; set; }
        public decimal LuongCoBan { get; set; }
        public decimal TongGioLam { get; set; }
        public decimal TienLuongTheoGio { get; set; } // (LuongCoBan * TongGioLam)
        public decimal TongTienThuong { get; set; }
        public decimal TongKhauTru { get; set; }
        public decimal ThucLanh { get; set; }
        public string TrangThai { get; set; } = string.Empty;
        public DateTime? NgayPhatLuong { get; set; }
        public string? TenNguoiPhat { get; set; }

        public List<PhieuThuongPhatItemDto> DanhSachThuong { get; set; } = new List<PhieuThuongPhatItemDto>();
        public List<PhieuThuongPhatItemDto> DanhSachPhat { get; set; } = new List<PhieuThuongPhatItemDto>();
    }

    /// <summary>
    /// DTO cho một dòng thưởng/phạt chi tiết
    /// </summary>
    public class PhieuThuongPhatItemDto
    {
        public DateTime NgayTao { get; set; }
        public decimal SoTien { get; set; }
        public string LyDo { get; set; } = string.Empty;
        public string TenNguoiTao { get; set; } = string.Empty;
    }
}
================================================================================

E:\Tai Lieu Hoc Tap\CS 445 AM\Project\CafebookModel\Model\ModelApp\NhanVien\PhieuThueSachDto.cs
================================================================================
﻿using System;
using System.Collections.Generic;
using CafebookModel.Model.ModelApp;

namespace CafebookModel.Model.ModelApp.NhanVien
{
    /// <summary>
    /// DTO chứa các cài đặt cấu hình phí thuê sách
    /// </summary>
    public class CaiDatThueSachDto
    {
        public decimal PhiThue { get; set; }
        public decimal PhiTraTreMoiNgay { get; set; }
        public int SoNgayMuonToiDa { get; set; }
        public int DiemPhieuThue { get; set; } // Thay thế cho VNDToPoint
        public decimal PointToVND { get; set; }
    }

    /// <summary>
    /// DTO an toàn cho tìm kiếm Khách Hàng
    /// </summary>
    public class KhachHangSearchDto
    {
        public int IdKhachHang { get; set; }
        public string HoTen { get; set; } = string.Empty;
        public string? SoDienThoai { get; set; }
        public int DiemTichLuy { get; set; }
        public string? Email { get; set; }
    }

    /// <summary>
    /// DTO thông tin nhân viên nhập vào
    /// </summary>
    public class KhachHangInfoDto
    {
        public string HoTen { get; set; } = string.Empty;
        public string? SoDienThoai { get; set; }
        public string? Email { get; set; }
    }

    /// <summary>
    /// DTO hiển thị trên DataGrid chính (danh sách đang thuê)
    /// </summary>
    public class PhieuThueGridDto
    {
        public int IdPhieuThueSach { get; set; }
        public string HoTenKH { get; set; } = string.Empty;
        public string? SoDienThoaiKH { get; set; }
        public DateTime NgayThue { get; set; }
        public DateTime NgayHenTra { get; set; }
        public int SoLuongSach { get; set; }
        public decimal TongTienCoc { get; set; }
        public string TrangThai { get; set; } = string.Empty;
        public string TinhTrang { get; set; } = string.Empty;
    }

    /// <summary>
    /// DTO chi tiết một cuốn sách trong phiếu thuê
    /// </summary>
    public class ChiTietSachThueDto
    {
        public int IdPhieuThueSach { get; set; }
        public int IdSach { get; set; }
        public string TenSach { get; set; } = string.Empty;
        public DateTime NgayHenTra { get; set; }
        public decimal TienCoc { get; set; }
        public string TinhTrang { get; set; } = string.Empty;
        public decimal TienPhat { get; set; } // Tính toán
    }

    /// <summary>
    /// DTO chứa đầy đủ chi tiết của 1 phiếu (khi click vào grid)
    /// </summary>
    public class PhieuThueChiTietDto
    {
        public int IdPhieuThueSach { get; set; }
        public string HoTenKH { get; set; } = string.Empty;
        public string? SoDienThoaiKH { get; set; }
        public string? EmailKH { get; set; }
        public int DiemTichLuyKH { get; set; }
        public DateTime NgayThue { get; set; }
        public string TrangThaiPhieu { get; set; } = string.Empty;
        public List<ChiTietSachThueDto> SachDaThue { get; set; } = new();
    }

    /// <summary>
    /// DTO cho form tìm kiếm sách
    /// </summary>
    public class SachTimKiemDto
    {
        public int IdSach { get; set; }
        public string TenSach { get; set; } = string.Empty;
        public string TacGia { get; set; } = string.Empty;
        public int SoLuongHienCo { get; set; }
        public decimal GiaBia { get; set; }
    }

    // --- DTOs cho Yêu Cầu (Request) ---

    /// <summary>
    /// DTO để tạo phiếu thuê mới
    /// </summary>
    public class PhieuThueRequestDto
    {
        public KhachHangInfoDto KhachHangInfo { get; set; } = new();
        public List<SachThueRequestDto> SachCanThue { get; set; } = new();
        public DateTime NgayHenTra { get; set; }
        public int IdNhanVien { get; set; }
    }

    public class SachThueRequestDto
    {
        public int IdSach { get; set; }
        public decimal TienCoc { get; set; }
    }

    /// <summary>
    /// DTO để thực hiện trả sách
    /// </summary>
    public class TraSachRequestDto
    {
        public int IdPhieuThueSach { get; set; }
        public List<int> IdSachs { get; set; } = new();
        public int IdNhanVien { get; set; }
    }

    /// <summary>
    /// DTO kết quả trả về sau khi trả sách
    /// </summary>
    public class TraSachResponseDto
    {
        public int IdPhieuTra { get; set; }
        public int SoSachDaTra { get; set; }
        public decimal TongPhiThue { get; set; }
        public decimal TongTienPhat { get; set; }
        public decimal TongTienCoc { get; set; }
        public decimal TongHoanTra { get; set; }
        public int DiemTichLuy { get; set; }
    }

    /// <summary>
    /// DTO Dữ liệu để in phiếu (Thuê)
    /// </summary>
    public class PhieuThuePrintDto
    {
        public string IdPhieu { get; set; } = string.Empty;
        public string TenQuan { get; set; } = string.Empty;
        public string DiaChiQuan { get; set; } = string.Empty;
        public string SdtQuan { get; set; } = string.Empty;
        public DateTime NgayTao { get; set; }
        public string TenNhanVien { get; set; } = string.Empty;
        public string TenKhachHang { get; set; } = string.Empty;
        public string SdtKhachHang { get; set; } = string.Empty;
        public DateTime NgayHenTra { get; set; }
        public List<ChiTietPrintDto> ChiTiet { get; set; } = new();
        public decimal TongPhiThue { get; set; }
        public decimal TongTienCoc { get; set; }
    }

    public class ChiTietPrintDto
    {
        public string TenSach { get; set; } = string.Empty;
        public decimal TienCoc { get; set; }
    }

    /// <summary>
    /// DTO cho Tab Lịch Sử Trả Sách
    /// </summary>
    public class PhieuTraGridDto
    {
        public int IdPhieuTra { get; set; }
        public int IdPhieuThueSach { get; set; }
        public DateTime NgayTra { get; set; }
        public string TenNhanVien { get; set; } = string.Empty;
        public decimal TongHoanTra { get; set; }
    }

    /// <summary>
    /// DTO Dữ liệu để in phiếu (Trả)
    /// </summary>
    public class PhieuTraPrintDto
    {
        public string IdPhieuTra { get; set; } = string.Empty;
        public string IdPhieuThue { get; set; } = string.Empty;
        public string TenQuan { get; set; } = string.Empty;
        public string DiaChiQuan { get; set; } = string.Empty;
        public string SdtQuan { get; set; } = string.Empty;
        public DateTime NgayTra { get; set; }
        public string TenNhanVien { get; set; } = string.Empty;
        public string TenKhachHang { get; set; } = string.Empty;
        public string SdtKhachHang { get; set; } = string.Empty;
        public int DiemTichLuy { get; set; }

        public List<ChiTietTraPrintDto> ChiTiet { get; set; } = new();

        public decimal TongTienCoc { get; set; }
        public decimal TongPhiThue { get; set; }
        public decimal TongTienPhat { get; set; }
        public decimal TongHoanTra { get; set; }
    }

    /// <summary>
    /// DTO chi tiết cho phiếu trả
    /// </summary>
    public class ChiTietTraPrintDto
    {
        public string TenSach { get; set; } = string.Empty;
        public decimal TienCoc { get; set; }
        public decimal TienPhat { get; set; }
    }
}
================================================================================

E:\Tai Lieu Hoc Tap\CS 445 AM\Project\CafebookModel\Model\ModelApp\NhanVien\SoDoBanDto.cs
================================================================================
﻿using System.Collections.Generic;

namespace CafebookModel.Model.ModelApp.NhanVien
{
    /// <summary>
    /// DTO để hiển thị một thẻ 'Bàn' trên sơ đồ
    /// </summary>
    public class BanSoDoDto
    {
        public int IdBan { get; set; }
        public string SoBan { get; set; } = string.Empty;
        public string TrangThai { get; set; } = string.Empty;
        public string? GhiChu { get; set; }
        public decimal TongTienHienTai { get; set; }
        public int? IdHoaDonHienTai { get; set; }

        // --- ĐÃ THÊM ---
        public int? IdKhuVuc { get; set; }
        public string? ThongTinDatBan { get; set; }
    }

    /// <summary>
    /// DTO dùng để báo cáo sự cố (Khóa bàn)
    /// </summary>
    public class BaoCaoSuCoRequestDto
    {
        public string GhiChuSuCo { get; set; } = string.Empty;
    }

    /// <summary>
    // DTO cho các thao tác phức tạp (Chuyển/Gộp bàn)
    /// </summary>
    public class BanActionRequestDto
    {
        public int IdHoaDonNguon { get; set; } // Hóa đơn/Bàn gốc
        public int IdBanDich { get; set; }     // Bàn chuyển đến
        public int? IdHoaDonDich { get; set; } // Hóa đơn (nếu gộp)
    }
}
================================================================================

E:\Tai Lieu Hoc Tap\CS 445 AM\Project\CafebookModel\Model\ModelApp\NhanVien\ThanhToanDto.cs
================================================================================
﻿using CafebookModel.Model.Entities;
using System.Collections.Generic;
using System; // Thêm

namespace CafebookModel.Model.ModelApp.NhanVien
{
    // DTO cho một dòng Phụ Thu
    public class PhuThuDto
    {
        public int IdPhuThu { get; set; }
        public string TenPhuThu { get; set; } = string.Empty;
        public decimal SoTien { get; set; }
        public string LoaiGiaTri { get; set; } = "VND";
        public decimal GiaTri { get; set; }
    }

    // DTO cho ComboBox tìm kiếm khách hàng
    public class KhachHangTimKiemDto
    {
        public int IdKhachHang { get; set; }
        public string DisplayText { get; set; } = string.Empty;
        public KhachHang KhachHangData { get; set; } = null!;
        public bool IsNew { get; set; } // <-- THÊM DÒNG NÀY
    }

    /// <summary>
    /// DTO chứa dữ liệu cho cửa sổ In Hóa Đơn (Tạm tính hoặc Cuối cùng)
    /// </summary>
    public class HoaDonPreviewDto
    {
        // Thông tin Cửa hàng
        public string TenQuan { get; set; } = "CafeBook";
        public string DiaChi { get; set; } = "N/A";
        public string SoDienThoai { get; set; } = "N/A";
        public string WifiMatKhau { get; set; } = "N/A";

        // Thông tin Hóa đơn
        public int IdHoaDon { get; set; }
        public string SoBan { get; set; } = "Mang về";
        public DateTime ThoiGianTao { get; set; }
        public string TenNhanVien { get; set; } = "Nhân viên";
        public string TenKhachHang { get; set; } = "Khách vãng lai";
        public bool IsProvisional { get; set; } = true; // Là hóa đơn Tạm tính?

        // Chi tiết
        public List<ChiTietDto> Items { get; set; } = new List<ChiTietDto>();
        public List<PhuThuDto> Surcharges { get; set; } = new List<PhuThuDto>();

        // Tổng tiền
        public decimal TongTienGoc { get; set; }
        public decimal GiamGiaKM { get; set; }
        public decimal GiamGiaDiem { get; set; }
        public decimal TongPhuThu { get; set; }
        public decimal ThanhTien { get; set; }

        // ### THÊM MỚI (YÊU CẦU 06/11) ###
        public string PhuongThucThanhToan { get; set; } = "Tiền mặt";
        public decimal KhachDua { get; set; }
        public decimal TienThoi { get; set; }
    }

    /// <summary>
    /// DTO tải dữ liệu ban đầu cho trang ThanhToanView
    /// </summary>
    public class ThanhToanViewDto
    {
        public HoaDonInfoDto HoaDonInfo { get; set; } = null!;
        public List<ChiTietDto> ChiTietItems { get; set; } = new List<ChiTietDto>();
        public int? IdKhuyenMaiDaApDung { get; set; }
        public List<PhuThuDto> PhuThusDaApDung { get; set; } = new List<PhuThuDto>();
        public List<PhuThu> PhuThusKhaDung { get; set; } = new List<PhuThu>();
        public KhachHang? KhachHang { get; set; }
        public List<KhachHangTimKiemDto> KhachHangsList { get; set; } = new List<KhachHangTimKiemDto>();
        public decimal DiemTichLuy_DoiVND { get; set; }
        public decimal DiemTichLuy_NhanVND { get; set; }
        public string TenQuan { get; set; } = string.Empty;
        public string DiaChi { get; set; } = string.Empty;
        public string SoDienThoai { get; set; } = string.Empty;
        public string WifiMatKhau { get; set; } = string.Empty;
    }

    /// <summary>
    /// DTO gửi lên API để xác nhận thanh toán
    /// </summary>
    public class ThanhToanRequestDto
    {
        public int IdHoaDonGoc { get; set; }
        public List<int> IdChiTietTach { get; set; } = new List<int>();
        public List<int> IdPhuThuTach { get; set; } = new List<int>();
        public int? IdKhuyenMai { get; set; }
        public string PhuongThucThanhToan { get; set; } = string.Empty;
        public decimal KhachDua { get; set; }
        public int DiemSuDung { get; set; }
        public int? IdKhachHang { get; set; }
    }
}
================================================================================

E:\Tai Lieu Hoc Tap\CS 445 AM\Project\CafebookModel\Model\ModelApp\NhanVien\ThongTinCaNhanDto.cs
================================================================================
﻿using System;
using System.Collections.Generic;

namespace CafebookModel.Model.ModelApp.NhanVien
{
    // Dùng để hiển thị thông tin chung
    public class ThongTinCaNhanViewDto
    {
        public NhanVienInfoDto NhanVien { get; set; } = null!;
        public LichLamViecDto? LichLamViecHomNay { get; set; }

        // SỬA: Thay thế List bằng 2 thuộc tính mới
        public int SoLanXinNghiThangNay { get; set; }
        public List<LichLamViecChiTietDto> LichLamViecThangNay { get; set; } = new List<LichLamViecChiTietDto>();
    }

    // THÊM MỚI: DTO cho bảng Lịch Làm Việc
    public class LichLamViecChiTietDto
    {
        public DateTime NgayLam { get; set; }
        public string TenCa { get; set; } = string.Empty;
        public TimeSpan GioBatDau { get; set; }
        public TimeSpan GioKetThuc { get; set; }
    }

    // Thông tin cơ bản của nhân viên
    public class NhanVienInfoDto
    {
        public int IdNhanVien { get; set; }
        public string HoTen { get; set; } = string.Empty;
        public string SoDienThoai { get; set; } = string.Empty;
        public string? Email { get; set; }
        public string? DiaChi { get; set; }
        public string? AnhDaiDien { get; set; }
    }

    // Thông tin lịch làm việc
    public class LichLamViecDto
    {
        public string TenCa { get; set; } = string.Empty; // Khởi tạo
        public TimeSpan GioBatDau { get; set; }
        public TimeSpan GioKetThuc { get; set; }
    }

    // Thông tin đơn xin nghỉ
    public class DonXinNghiDto
    {
        public int IdDonXinNghi { get; set; }
        public string LoaiDon { get; set; } = string.Empty; // Khởi tạo
        public string LyDo { get; set; } = string.Empty; // Khởi tạo
        public DateTime NgayBatDau { get; set; }
        public DateTime NgayKetThuc { get; set; }
        public string TrangThai { get; set; } = string.Empty; // Khởi tạo
        public string? GhiChuPheDuyet { get; set; } // Cho phép null
    }

    /// <summary>
    /// Dùng để cập nhật thông tin
    /// </summary>
    public class CapNhatThongTinDto
    {
        public string HoTen { get; set; } = string.Empty; // Khởi tạo
        public string SoDienThoai { get; set; } = string.Empty; // Khởi tạo
        public string? Email { get; set; } // Cho phép null
        public string? DiaChi { get; set; } // Cho phép null
    }

    // Dùng để đổi mật khẩu
    public class DoiMatKhauRequestDto
    {
        public string MatKhauCu { get; set; } = string.Empty; // Khởi tạo
        public string MatKhauMoi { get; set; } = string.Empty; // Khởi tạo
    }

    // Dùng để tạo đơn xin nghỉ
    public class DonXinNghiRequestDto
    {
        public string LoaiDon { get; set; } = string.Empty; // Khởi tạo
        public string LyDo { get; set; } = string.Empty; // Khởi tạo
        public DateTime NgayBatDau { get; set; }
        public DateTime NgayKetThuc { get; set; }
    }
}
================================================================================

E:\Tai Lieu Hoc Tap\CS 445 AM\Project\CafebookModel\Model\ModelWeb\ChinhSachDto.cs
================================================================================
﻿// Tập tin: CafebookModel/Model/ModelWeb/ChinhSachDto.cs
namespace CafebookModel.Model.ModelWeb
{
    /// <summary>
    /// DTO riêng cho Trang Chính Sách
    /// </summary>
    public class ChinhSachDto
    {
        // Sử dụng decimal cho các giá trị tiền tệ
        public decimal PhiThue { get; set; } = 15000;
        public decimal PhiTraTreMoiNgay { get; set; } = 5000;

        // Tỉ lệ tích điểm
        public decimal DiemNhanVND { get; set; } = 10000;
        public decimal DiemDoiVND { get; set; } = 1000;
    }
}
================================================================================

E:\Tai Lieu Hoc Tap\CS 445 AM\Project\CafebookModel\Model\ModelWeb\DangKyRequestModel.cs
================================================================================
﻿// Tập tin: CafebookModel/Model/ModelWeb/DangKyRequestModel.cs
namespace CafebookModel.Model.ModelWeb
{
    public class DangKyRequestModel
    {
        // Đã xóa HoTen
        public string SoDienThoai { get; set; } = string.Empty;
        public string Email { get; set; } = string.Empty;
        // Đã xóa TenDangNhap
        public string Password { get; set; } = string.Empty;
    }
}
================================================================================

E:\Tai Lieu Hoc Tap\CS 445 AM\Project\CafebookModel\Model\ModelWeb\DanhGiaWebDtos.cs
================================================================================
﻿using System.ComponentModel.DataAnnotations;

namespace CafebookModel.Model.ModelWeb
{
    // DTO dùng khi khách hàng GỬI một đánh giá mới
    public class TaoDanhGiaDto
    {
        [Required]
        public int idHoaDon { get; set; }

        [Required]
        public int idSanPham { get; set; }

        [Required(ErrorMessage = "Vui lòng chọn số sao.")]
        [Range(1, 5, ErrorMessage = "Vui lòng chọn số sao.")]
        public int SoSao { get; set; }

        // <<< SỬA LỖI TẠI ĐÂY >>>
        [Required(ErrorMessage = "Vui lòng nhập bình luận của bạn.")]
        [MinLength(10, ErrorMessage = "Bình luận cần ít nhất 10 ký tự.")]
        public string BinhLuan { get; set; } = string.Empty; // Xóa '?' để
    }

    // DTO dùng để HIỂN THỊ SP trên trang đánh giá
    public class SanPhamChoDanhGiaDto
    {
        public int IdSanPham { get; set; }
        public string TenSanPham { get; set; } = "";
        public string? HinhAnhUrl { get; set; }
        public bool DaDanhGia { get; set; }
    }

    // DTO dùng để HIỂN THỊ đánh giá trên trang chi tiết
    public class DanhGiaWebDto
    {
        public int IdDanhGia { get; set; }
        public string TenKhachHang { get; set; } = "";
        public string? AvatarKhachHang { get; set; }
        public int SoSao { get; set; }
        public string? BinhLuan { get; set; }
        public string? HinhAnhUrl { get; set; }
        public DateTime NgayTao { get; set; }
        public PhanHoiWebDto? PhanHoi { get; set; }
    }

    // DTO cho Phản Hồi
    public class PhanHoiWebDto
    {
        public string TenNhanVien { get; set; } = "";
        public string NoiDung { get; set; } = "";
        public DateTime NgayTao { get; set; }
    }
}
================================================================================

E:\Tai Lieu Hoc Tap\CS 445 AM\Project\CafebookModel\Model\ModelWeb\DatBanWebDto.cs
================================================================================
﻿/* KHÔNG THAY ĐỔI */
/* Các DTO đã được định nghĩa chính xác. */

using System;
using System.Collections.Generic;
using System.ComponentModel.DataAnnotations;

namespace CafebookModel.Model.ModelWeb
{
    /// <summary>
    /// DTO dùng để tìm kiếm bàn trống
    /// </summary>
    public class TimBanRequestDto
    {
        [Required]
        public DateTime NgayDat { get; set; }

        [Required]
        public TimeSpan GioDat { get; set; }

        [Range(1, 50, ErrorMessage = "Số lượng khách phải từ 1 đến 50")]
        public int SoNguoi { get; set; }
    }

    /// <summary>
    /// DTO hiển thị kết quả bàn trống
    /// </summary>
    public class BanTrongDto
    {
        public int IdBan { get; set; }
        public string SoBan { get; set; } = string.Empty;
        public int SoGhe { get; set; }
        public string KhuVuc { get; set; } = string.Empty;
        public string? MoTa { get; set; }
    }

    /// <summary>
    /// DTO gửi yêu cầu đặt bàn từ Web
    /// </summary>
    public class DatBanWebRequestDto
    {
        // Thông tin khách (nếu chưa đăng nhập hoặc đặt hộ)
        public string? HoTen { get; set; }
        public string? SoDienThoai { get; set; }
        public string? Email { get; set; }

        [Required]
        public int IdBan { get; set; }

        [Required]
        public DateTime NgayDat { get; set; }

        [Required]
        public TimeSpan GioDat { get; set; }

        [Required]
        public int SoLuongKhach { get; set; }

        public string? GhiChu { get; set; }
    }

    /// <summary>
    /// DTO mới để trả về danh sách bàn nhóm theo khu vực
    /// </summary>
    public class KhuVucBanDto
    {
        public int IdKhuVuc { get; set; }
        public string TenKhuVuc { get; set; } = string.Empty;
        public List<BanTrongDto> BanList { get; set; } = new();
    }

    /// <summary>
    /// DTO mới để trả về giờ mở/đóng cửa
    /// </summary>
    public class OpeningHoursDto
    {
        public TimeSpan Open { get; set; }
        public TimeSpan Close { get; set; }
    }
}
================================================================================

E:\Tai Lieu Hoc Tap\CS 445 AM\Project\CafebookModel\Model\ModelWeb\GioHangDto.cs
================================================================================
﻿// Tập tin: CafebookModel/Model/ModelWeb/GioHangDto.cs
using System.Collections.Generic;
using System.Linq;

namespace CafebookModel.Model.ModelWeb
{
    /// <summary>
    /// DTO cơ bản đại diện cho một món hàng trong giỏ.
    /// SỬA: Đã xóa "Loai". Giờ đây Id mặc định là IdSanPham.
    /// </summary>
    public class CartItemDto
    {
        public int Id { get; set; } // IdSanPham
        public int SoLuong { get; set; }
    }

    /// <summary>
    /// Model đầy đủ thông tin của một món hàng ĐỂ HIỂN THỊ ra View.
    /// SỬA: Đã xóa "Loai".
    /// </summary>
    public class GioHangItemViewModel
    {
        public int Id { get; set; }
        public string TenHienThi { get; set; } = string.Empty;
        public string? HinhAnhUrl { get; set; }
        public decimal DonGia { get; set; }
        public int SoLuong { get; set; }
        public decimal ThanhTien => DonGia * SoLuong;
    }

    /// <summary>
    /// ViewModel chính cho trang GioHangView (Không đổi).
    /// </summary>
    public class GioHangViewModel
    {
        public List<GioHangItemViewModel> Items { get; set; } = new();
        public decimal TongTien => Items.Sum(item => item.ThanhTien);
    }
}
================================================================================

E:\Tai Lieu Hoc Tap\CS 445 AM\Project\CafebookModel\Model\ModelWeb\HoTroDto.cs
================================================================================
﻿// Tập tin: CafebookModel/Model/ModelWeb/HoTroDto.cs
using System;
using System.Collections.Generic;
using System.ComponentModel.DataAnnotations;
using System.Text.Json.Serialization; // <-- THÊM DÒNG NÀY

namespace CafebookModel.Model.ModelWeb
{
    /// <summary>
    /// DTO chính cho trang Hỗ trợ
    /// </summary>
    public class HoTroViewDto
    {
        public List<ChatMessageDto> LichSuChat { get; set; } = new List<ChatMessageDto>();
        public int IdKhachHang { get; set; } // Sẽ = 0 nếu là khách vãng lai
        public string? GuestSessionId { get; set; } // Sẽ có giá trị nếu là khách vãng lai
        public string TenKhachHang { get; set; } = string.Empty;
    }

    /// <summary>
    /// DTO cho một tin nhắn (cả của khách, AI và NV)
    /// </summary>
    public class ChatMessageDto
    {
        public long IdChat { get; set; }
        public string NoiDung { get; set; } = string.Empty;
        public DateTime ThoiGian { get; set; }

        public string LoaiTinNhan { get; set; } = "KhachHang";
        public int? IdThongBaoHoTro { get; set; }
        // === SỬA LỖI: Thêm [JsonIgnore] ===
        // Những thuộc tính này chỉ dùng cho Razor, không dùng cho API
        [JsonIgnore]
        public bool IsUser => LoaiTinNhan == "KhachHang";
        [JsonIgnore]
        public bool IsBot => LoaiTinNhan == "AI" || LoaiTinNhan == "NhanVien";
        [JsonIgnore]
        public string AvatarCssClass => IsBot ? "avatar-bot" : "avatar-user";
        // === KẾT THÚC SỬA LỖI ===
    }

    /// <summary>
    /// DTO khi khách hàng gửi tin nhắn mới
    /// </summary>
    public class SendChatRequestDto
    {
        [Required(ErrorMessage = "Vui lòng nhập nội dung")]
        [MaxLength(1000)]
        public string NoiDung { get; set; } = string.Empty;

        // Thêm trường này để JS gửi lên
        public string? GuestSessionId { get; set; }
    }

    /// <summary>
    /// DTO API trả về (gồm 1 hoặc 2 tin nhắn)
    /// </summary>
    public class SendChatResponseDto
    {
        public ChatMessageDto TinNhanCuaKhach { get; set; } = null!;
        public ChatMessageDto? TinNhanPhanHoi { get; set; } // Có thể null nếu AI chuyển tiếp
        public bool DaChuyenNhanVien { get; set; } = false;
        public int? IdThongBaoHoTro { get; set; } // Để JS biết khi nào kích hoạt SignalR
    }
}
================================================================================

E:\Tai Lieu Hoc Tap\CS 445 AM\Project\CafebookModel\Model\ModelWeb\KhachHangDto.cs
================================================================================
﻿namespace CafebookModel.Model.ModelWeb
{
    public class KhachHangDto
    {
        public int IdKhachHang { get; set; }
        public string HoTen { get; set; } = string.Empty; // <-- SỬA LỖI CS8618
        public string? SoDienThoai { get; set; }
        public string? Email { get; set; }
        public string? TenDangNhap { get; set; }
        public string? AnhDaiDienUrl { get; set; }
    }
}
================================================================================

E:\Tai Lieu Hoc Tap\CS 445 AM\Project\CafebookModel\Model\ModelWeb\KhachHangProfileDto.cs
================================================================================
﻿// Tập tin: CafebookModel/Model/ModelWeb/KhachHangProfileDto.cs
using System.ComponentModel.DataAnnotations;
using System.Collections.Generic;
using System;

namespace CafebookModel.Model.ModelWeb
{
    // ... (Các DTO KhachHangTongQuanDto, KhachHangProfileDto, ProfileUpdateModel, PasswordChangeModel giữ nguyên) ...

    /// <summary>
    /// DTO cho trang TỔNG QUAN
    /// </summary>
    public class KhachHangTongQuanDto
    {
        public int DiemTichLuy { get; set; }
        public int TongHoaDon { get; set; }
        public decimal TongChiTieu { get; set; }
        public DateTime NgayTao { get; set; }
    }

    /// <summary>
    /// DTO dùng để TẢI thông tin trang HỒ SƠ
    /// </summary>
    public class KhachHangProfileDto
    {
        public int IdKhachHang { get; set; }
        public string HoTen { get; set; } = string.Empty;
        public string? SoDienThoai { get; set; }
        public string? Email { get; set; }
        public string? DiaChi { get; set; }
        public string? TenDangNhap { get; set; }
        public string? AnhDaiDienUrl { get; set; }
    }

    /// <summary>
    /// Model dùng để CẬP NHẬT thông tin hồ sơ
    /// </summary>
    public class ProfileUpdateModel
    {
        [Required(ErrorMessage = "Họ tên không được để trống")]
        public string HoTen { get; set; } = string.Empty;

        [Phone(ErrorMessage = "Số điện thoại không hợp lệ")]
        public string? SoDienThoai { get; set; }

        [EmailAddress(ErrorMessage = "Email không hợp lệ")]
        public string? Email { get; set; }

        public string? DiaChi { get; set; }

        [Required(ErrorMessage = "Tên đăng nhập không được để trống")]
        [StringLength(100, ErrorMessage = "Tên đăng nhập phải dài từ 6 đến 100 ký tự.", MinimumLength = 6)]
        public string TenDangNhap { get; set; } = string.Empty;
    }

    /// <summary>
    /// Model dùng để ĐỔI MẬT KHẨU
    /// </summary>
    public class PasswordChangeModel
    {
        [Required(ErrorMessage = "Vui lòng nhập mật khẩu cũ")]
        [DataType(DataType.Password)]
        public string MatKhauCu { get; set; } = string.Empty;

        [Required(ErrorMessage = "Vui lòng nhập mật khẩu mới")]
        [StringLength(100, ErrorMessage = "Mật khẩu mới phải dài ít nhất 6 ký tự.", MinimumLength = 6)]
        [DataType(DataType.Password)]
        public string MatKhauMoi { get; set; } = string.Empty;

        [DataType(DataType.Password)]
        [Compare("MatKhauMoi", ErrorMessage = "Mật khẩu mới và mật khẩu xác nhận không khớp.")]
        public string XacNhanMatKhauMoi { get; set; } = string.Empty;
    }

    // ==========================================================
    // === DTO CHO LỊCH SỬ ĐƠN HÀNG (Đã di chuyển vào đây) ===
    // ==========================================================

    /// <summary>
    /// DTO cho một món hàng trong thẻ lịch sử (Trang List & Trang Detail)
    /// </summary>
    public class DonHangItemWebDto
    {
        public int IdSanPham { get; set; }
        public string TenSanPham { get; set; } = string.Empty;
        public string? HinhAnhUrl { get; set; }
        public int SoLuong { get; set; }
        public decimal DonGia { get; set; }
        public decimal ThanhTien => DonGia * SoLuong;
    }

    /// <summary>
    /// DTO cho một thẻ (card) trên trang LỊCH SỬ (List)
    /// </summary>
    public class LichSuDonHangWebDto
    {
        public int IdHoaDon { get; set; }
        public DateTime ThoiGianTao { get; set; }
        public string TrangThaiThanhToan { get; set; } = string.Empty;
        public string? TrangThaiGiaoHang { get; set; }
        public decimal ThanhTien { get; set; }
        public List<DonHangItemWebDto> Items { get; set; } = new();
    }

    /// <summary>
    /// DTO MỚI: Cho một sự kiện trong timeline vận chuyển
    /// </summary>
    public class TrackingEventDto
    {
        public DateTime Timestamp { get; set; }
        public string Status { get; set; } = string.Empty;
        public string Description { get; set; } = string.Empty;
        public bool IsCurrent { get; set; } = false;
    }

    /// <summary>
    /// DTO MỚI: DTO chính cho trang CHI TIẾT ĐƠN HÀNG
    /// </summary>
    public class DonHangChiTietWebDto
    {
        // Thông tin cơ bản
        public int IdHoaDon { get; set; }
        public string MaDonHang { get; set; } = string.Empty; // "HD00097"
        public string TrangThaiGiaoHang { get; set; } = string.Empty;
        public string TrangThaiThanhToan { get; set; } = string.Empty;
        public DateTime ThoiGianTao { get; set; }

        // Địa chỉ
        public string HoTen { get; set; } = string.Empty;
        public string SoDienThoai { get; set; } = string.Empty;
        public string DiaChiGiaoHang { get; set; } = string.Empty;

        // Timeline
        public List<TrackingEventDto> TrackingEvents { get; set; } = new();

        // Món hàng
        public List<DonHangItemWebDto> Items { get; set; } = new();

        // Thanh toán
        public decimal TongTienHang { get; set; } // (Tổng tiền gốc)
        public decimal GiamGia { get; set; } // (GiamGia + Diem)
        public decimal ThanhTien { get; set; }
        public string PhuongThucThanhToan { get; set; } = string.Empty;
        public string? AnhXacNhanGiaoHangUrl { get; set; }
    }
}
================================================================================

E:\Tai Lieu Hoc Tap\CS 445 AM\Project\CafebookModel\Model\ModelWeb\LichSuDatBanDto.cs
================================================================================
﻿// Tập tin: CafebookModel/Model/ModelWeb/LichSuDatBanDto.cs
using System;

namespace CafebookModel.Model.ModelWeb
{
    public class LichSuDatBanDto
    {
        public int IdPhieuDatBan { get; set; }
        public string TenBan { get; set; } = string.Empty;
        public DateTime ThoiGianDat { get; set; }
        public int SoLuongKhach { get; set; }
        public string TrangThai { get; set; } = string.Empty;
        public string? GhiChu { get; set; }
    }
}
================================================================================

E:\Tai Lieu Hoc Tap\CS 445 AM\Project\CafebookModel\Model\ModelWeb\LichSuPhieuThueDto.cs
================================================================================
﻿// Tập tin: CafebookModel/Model/ModelWeb/LichSuPhieuThueDto.cs
using System;

namespace CafebookModel.Model.ModelWeb
{
    public class LichSuPhieuThueDto
    {
        public int IdPhieuThueSach { get; set; }
        public DateTime NgayThue { get; set; }
        public string TrangThai { get; set; } = string.Empty;
        public int SoLuongSach { get; set; }
        public decimal TongTienCoc { get; set; }

        // Thông tin từ PhieuTraSach (nếu đã trả)
        public DateTime? NgayTra { get; set; }
        public decimal? TongPhiThue { get; set; }
        public decimal? TongTienPhat { get; set; }
        public decimal? TongTienCocHoan { get; set; }
    }
}
================================================================================

E:\Tai Lieu Hoc Tap\CS 445 AM\Project\CafebookModel\Model\ModelWeb\LienHeDto.cs
================================================================================
﻿// Tập tin: CafebookModel/Model/ModelWeb/LienHeDto.cs
namespace CafebookModel.Model.ModelWeb
{
    /// <summary>
    /// DTO riêng cho Trang Liên Hệ
    /// </summary>
    public class LienHeDto
    {
        public string? GioiThieu { get; set; }
        public string? DiaChi { get; set; }
        public string? SoDienThoai { get; set; }
        public string? EmailLienHe { get; set; }
        public string? GioMoCua { get; set; }
        public string? LinkFacebook { get; set; }
        public string? LinkInstagram { get; set; }
        public string? LinkGoogleMapsEmbed { get; set; }
        public string? LinkZalo { get; set; }
        public string? LinkYoutube { get; set; }
    }
}
================================================================================

E:\Tai Lieu Hoc Tap\CS 445 AM\Project\CafebookModel\Model\ModelWeb\PasswordResetDto.cs
================================================================================
﻿namespace CafebookModel.Model.ModelWeb
{
    public class CheckEmailRequestDto
    {
        public string Email { get; set; } = string.Empty;
    }

    public class ResetPasswordRequestDto
    {
        public string Email { get; set; } = string.Empty;
        public string NewPassword { get; set; } = string.Empty;
    }
}
================================================================================

E:\Tai Lieu Hoc Tap\CS 445 AM\Project\CafebookModel\Model\ModelWeb\ThanhToanDto.cs
================================================================================
﻿// Tập tin: CafebookModel/Model/ModelWeb/ThanhToanDto.cs
// (*** KHÔNG CẦN THAY ĐỔI - MÃ NGUỒN ĐÃ CHÍNH XÁC ***)

using System;
using System.Collections.Generic;
using System.ComponentModel.DataAnnotations;

namespace CafebookModel.Model.ModelWeb
{
    // --- DTO 1: DÙNG ĐỂ TẢI DỮ LIỆU LÊN TRANG (API -> RAZOR) ---

    public class ThanhToanLoadDto
    {
        public KhachHangThanhToanDto KhachHang { get; set; } = new();
        public List<KhuyenMaiThanhToanDto> KhuyenMaisHopLe { get; set; } = new();
        public decimal TiLeDoiDiemVND { get; set; } = 1000;

        [System.Text.Json.Serialization.JsonIgnore]
        public List<GioHangItemViewModel> SanPhamItems { get; set; } = new();
        [System.Text.Json.Serialization.JsonIgnore]
        public List<GioHangItemViewModel> SachItems { get; set; } = new();
        [System.Text.Json.Serialization.JsonIgnore]
        public decimal TongTienHang { get; set; }
    }

    public class KhachHangThanhToanDto
    {
        public int IdKhachHang { get; set; }
        [Required(ErrorMessage = "Vui lòng nhập họ tên")]
        public string HoTen { get; set; } = string.Empty;
        [Required(ErrorMessage = "Vui lòng nhập SĐT")]
        public string SoDienThoai { get; set; } = string.Empty;
        [Required(ErrorMessage = "Vui lòng nhập Email")]
        [EmailAddress]
        public string Email { get; set; } = string.Empty;
        [Required(ErrorMessage = "Vui lòng nhập địa chỉ giao hàng")]
        public string DiaChi { get; set; } = string.Empty;
        public int DiemTichLuy { get; set; }
    }

    /// <summary>
    /// SỬA: Thêm các trường kiểm tra thời gian
    /// </summary>
    public class KhuyenMaiThanhToanDto
    {
        public int IdKhuyenMai { get; set; }
        public string TenChuongTrinh { get; set; } = string.Empty;
        public string MaKhuyenMai { get; set; } = string.Empty;
        public string LoaiGiamGia { get; set; } = string.Empty;
        public decimal GiaTriGiam { get; set; }
        public decimal? GiamToiDa { get; set; }
        public int? IdSanPhamApDung { get; set; }
        public string? DieuKienApDung { get; set; }
        public decimal? HoaDonToiThieu { get; set; }

        // =======================================
        // === THÊM MỚI 3 TRƯỜNG TẠI ĐÂY ===
        // =======================================
        public string? NgayTrongTuan { get; set; }
        public TimeSpan? GioBatDau { get; set; }
        public TimeSpan? GioKetThuc { get; set; }
    }


    // --- DTO 2: DÙNG ĐỂ GỬI ĐƠN HÀNG (RAZOR -> API) ---

    public class ThanhToanSubmitDto
    {
        [Required(ErrorMessage = "Vui lòng nhập họ tên")]
        public string HoTen { get; set; } = string.Empty;
        [Required(ErrorMessage = "Vui lòng nhập SĐT")]
        public string SoDienThoai { get; set; } = string.Empty;
        [Required(ErrorMessage = "Vui lòng nhập địa chỉ giao hàng")]
        public string DiaChiGiaoHang { get; set; } = string.Empty;
        [EmailAddress]
        public string Email { get; set; } = string.Empty;
        [Required(ErrorMessage = "Vui lòng chọn phương thức thanh toán")]
        public string PhuongThucThanhToan { get; set; } = "COD";
        public int? IdKhuyenMai { get; set; }
        [Range(0, int.MaxValue, ErrorMessage = "Điểm sử dụng không hợp lệ")]
        public int DiemSuDung { get; set; } = 0;
        public string? GhiChu { get; set; }
        public List<CartItemDto> ItemsToPurchase { get; set; } = new();
    }


    // --- DTO 3: PHẢN HỒI SAU KHI TẠO ĐƠN (API -> RAZOR) ---

    public class ThanhToanResponseDto
    {
        public bool Success { get; set; }
        public string Message { get; set; } = string.Empty;
        public int? IdHoaDonMoi { get; set; }
        public int? IdPhieuThueMoi { get; set; }
    }

    /// <summary>
    /// DTO tóm tắt đơn hàng cho trang ThanhToanThanhCongView
    /// </summary>
    public class ThanhToanThanhCongDto
    {
        public int IdHoaDonMoi { get; set; }
        public DateTime ThoiGianTao { get; set; }
        public string TrangThai { get; set; } = string.Empty;
        public string PhuongThucThanhToan { get; set; } = string.Empty;
        public string DiaChiGiaoHang { get; set; } = string.Empty;
        public string SoDienThoai { get; set; } = string.Empty;

        public List<GioHangItemViewModel> Items { get; set; } = new();

        public decimal TongTienHang { get; set; }
        public decimal GiamGia { get; set; }
        public decimal ThanhTien { get; set; }
    }
}
================================================================================

E:\Tai Lieu Hoc Tap\CS 445 AM\Project\CafebookModel\Model\ModelWeb\ThucDonDto.cs
================================================================================
﻿// Tập tin: CafebookModel/Model/ModelWeb/ThucDonDto.cs
using CafebookModel.Model.ModelApp; // Để dùng chung FilterLookupDto
using System.Collections.Generic;

namespace CafebookModel.Model.ModelWeb
{
    /// <summary>
    /// DTO cho một sản phẩm hiển thị trên lưới thực đơn
    /// </summary>
    public class SanPhamThucDonDto
    {
        public int IdSanPham { get; set; }
        public string TenSanPham { get; set; } = string.Empty;
        public string? TenLoaiSP { get; set; } // Tên danh mục
        public decimal DonGia { get; set; }
        public string? AnhSanPhamUrl { get; set; } // Sửa: Dùng URL
    }

    /// <summary>
    /// DTO chứa kết quả trả về (bao gồm phân trang)
    /// </summary>
    public class ThucDonDto
    {
        public List<SanPhamThucDonDto> Items { get; set; } = new();
        public int TotalPages { get; set; }
        public int CurrentPage { get; set; }
    }

    /// <summary>
    /// DTO cho trang Chi Tiết Sản Phẩm
    /// </summary>
    public class SanPhamChiTietDto
    {
        public int IdSanPham { get; set; }
        public string TenSanPham { get; set; } = string.Empty;
        public string? TenLoaiSP { get; set; }
        public decimal DonGia { get; set; }
        public string? HinhAnhUrl { get; set; }
        public string? MoTa { get; set; }
        public List<CongThucDto> CongThucs { get; set; } = new();

        // THÊM MỚI: Danh sách sản phẩm gợi ý
        public List<SanPhamThucDonDto> GoiY { get; set; } = new();
    }

    /// <summary>
    /// DTO con cho công thức/định lượng
    /// </summary>
    public class CongThucDto
    {
        public string TenNguyenLieu { get; set; } = string.Empty;
    }
}
================================================================================

E:\Tai Lieu Hoc Tap\CS 445 AM\Project\CafebookModel\Model\ModelWeb\ThuVienSachDto.cs
================================================================================
﻿// Tập tin: CafebookModel/Model/ModelWeb/ThuVienSachDto.cs
using CafebookModel.Model.ModelApp; // Dùng chung FilterLookupDto
using System.Collections.Generic;

namespace CafebookModel.Model.ModelWeb
{
    // DTO cho các thẻ sách (dùng chung)
    public class SachCardDto
    {
        public int IdSach { get; set; }
        public string TieuDe { get; set; } = string.Empty;
        public string? TacGia { get; set; } // Dùng cho trang thư viện chính
        public decimal GiaBia { get; set; }
        public int SoLuongCoSan { get; set; }
        public string? AnhBiaUrl { get; set; }
    }

    // DTO cho Tác giả (để hiển thị link)
    public class TacGiaDto
    {
        public int IdTacGia { get; set; }
        public string TenTacGia { get; set; } = string.Empty;
    }

    // DTO cho Thể loại (để hiển thị link)
    public class TheLoaiDto
    {
        public int IdTheLoai { get; set; }
        public string TenTheLoai { get; set; } = string.Empty;
    }

    // DTO cho Nhà xuất bản (để hiển thị link)
    public class NhaXuatBanDto
    {
        public int IdNhaXuatBan { get; set; }
        public string TenNhaXuatBan { get; set; } = string.Empty;
    }

    // DTO cho trang Chi Tiết Sách (ĐÃ SỬA)
    public class SachChiTietDto
    {
        public int IdSach { get; set; }
        public string TieuDe { get; set; } = string.Empty;
        public decimal GiaBia { get; set; }
        public string? AnhBiaUrl { get; set; }
        public string? MoTa { get; set; }
        public string? ViTri { get; set; }
        public int TongSoLuong { get; set; }
        public int SoLuongCoSan { get; set; }

        // === SỬA: Đổi từ string sang List DTO ===
        public List<TacGiaDto> TacGias { get; set; } = new();
        public List<TheLoaiDto> TheLoais { get; set; } = new();
        public List<NhaXuatBanDto> NhaXuatBans { get; set; } = new();

        public List<SachCardDto> GoiY { get; set; } = new();
    }

    // DTO cho trang Kết quả tìm kiếm (MỚI)
    public class SachKetQuaTimKiemDto
    {
        public string TieuDeTrang { get; set; } = "Tất cả Sách của";
        public string? MoTaTrang { get; set; }
        public List<SachCardDto> SachList { get; set; } = new List<SachCardDto>();
    }

    /// <summary>
    /// DTO chứa kết quả trả về (bao gồm phân trang)
    /// </summary>
    public class SachPhanTrangDto
    {
        public List<SachCardDto> Items { get; set; } = new();
        public int TotalPages { get; set; }
        public int CurrentPage { get; set; }
    }
    /// <summary>
    /// DTO chứa các bộ lọc (filters) cho trang thư viện
    /// </summary>
    public class SachFiltersDto
    {
        public List<FilterLookupDto> TheLoais { get; set; } = new();
    }
}
================================================================================

E:\Tai Lieu Hoc Tap\CS 445 AM\Project\CafebookModel\Model\ModelWeb\TrangChuDto.cs
================================================================================
﻿// Tập tin: CafebookModel/Model/ModelWeb/TrangChuDto.cs
namespace CafebookModel.Model.ModelWeb
{
    // Lớp cha chứa tất cả
    public class TrangChuDto
    {
        public ThongTinChungDto? Info { get; set; }
        public List<KhuyenMaiDto> Promotions { get; set; } = new();
        public List<SanPhamDto> MonNoiBat { get; set; } = new();
        public List<SachDto> SachNoiBat { get; set; } = new();
    }

    // Lớp cho Model.Info (SỬA ĐỔI)
    public class ThongTinChungDto
    {
        public string TenQuan { get; set; } = "Cafebook";
        public string? GioiThieu { get; set; }
        public string? BannerImageUrl { get; set; }
        public int SoBanTrong { get; set; }
        public int SoSachSanSang { get; set; }
        public string? DiaChi { get; set; }
        public string? SoDienThoai { get; set; }

        // THÊM MỚI (từ CSDL CaiDat)
        public string? EmailLienHe { get; set; }
        public string? GioMoCua { get; set; }
    }

    // Lớp cho Model.Promotions
    public class KhuyenMaiDto
    {
        public string TenKhuyenMai { get; set; } = string.Empty;
        public string? MoTa { get; set; }
        public string? dieuKienApDung { get; set; }
    }

    // Lớp cho Model.MonNoiBat (SỬA ĐỔI)
    public class SanPhamDto
    {
        // THÊM MỚI:
        public int IdSanPham { get; set; }
        public string TenSanPham { get; set; } = string.Empty;
        public string? AnhSanPhamUrl { get; set; }
        public decimal DonGia { get; set; }
    }

    // Lớp cho Model.SachNoiBat
    public class SachDto
    {
        public int IdSach { get; set; }
        public string TieuDe { get; set; } = string.Empty;
        public string? TacGia { get; set; }
        public string? AnhBiaUrl { get; set; }
    }
}
================================================================================

E:\Tai Lieu Hoc Tap\CS 445 AM\Project\CafebookModel\Model\ModelWeb\WebLoginResponseModel.cs
================================================================================
﻿using CafebookModel.Model.Data; // Cho NhanVienDto
using CafebookModel.Model.ModelWeb; // Cho KhachHangDto

namespace CafebookModel.Model.ModelApi
{
    public class WebLoginResponseModel
    {
        public bool Success { get; set; }
        public string Message { get; set; } = string.Empty;
        public string? Token { get; set; } // Thêm thuộc tính để chứa JWT
        public KhachHangDto? KhachHangData { get; set; }
        public NhanVienDto? NhanVienData { get; set; } // Tận dụng NhanVienDto từ WPF
    }
}
================================================================================

E:\Tai Lieu Hoc Tap\CS 445 AM\Project\CafebookModel\Model\ModelWeb\WebQuanLyDashboardDto.cs
================================================================================
﻿// Tập tin: CafebookModel/Model/ModelWeb/WebQuanLyDashboardDto.cs
namespace CafebookModel.Model.ModelWeb
{
    /// <summary>
    /// DTO chứa dữ liệu cho trang Dashboard của Nhân viên trên Web
    /// </summary>
    public class WebQuanLyDashboardDto
    {
        public string? HoTen { get; set; }
        public string? VaiTro { get; set; }
        public string? AnhDaiDienUrl { get; set; }
        public string? CaHienTai { get; set; }
        public int TongBanDangPhucVu { get; set; }
        public int TongDonDangXuLy { get; set; }
    }
}
================================================================================

E:\Tai Lieu Hoc Tap\CS 445 AM\Project\CafebookModel\Model\ModelWeb\QuanLy\GiaoHangDto.cs
================================================================================
﻿using Microsoft.AspNetCore.Http;
using System;
using System.Collections.Generic;
using System.Text.Json.Serialization;

namespace CafebookModel.Model.ModelWeb.QuanLy
{
    public class GiaoHangViewDto
    {
        public List<GiaoHangItemDto> DonGiaoHang { get; set; } = new List<GiaoHangItemDto>();
        public List<NguoiGiaoHangDto> NguoiGiaoHangSanSang { get; set; } = new List<NguoiGiaoHangDto>();
    }

    public class GiaoHangItemDto
    {
        public int IdHoaDon { get; set; }
        public DateTime ThoiGianTao { get; set; }
        public string? TenKhachHang { get; set; }
        public string? SoDienThoaiGiaoHang { get; set; }
        public string? DiaChiGiaoHang { get; set; }
        public decimal ThanhTien { get; set; }
        public string TrangThaiThanhToan { get; set; } = string.Empty;
        public string? TrangThaiGiaoHang { get; set; }
        public int? IdNguoiGiaoHang { get; set; }
        public string? TenNguoiGiaoHang { get; set; }
        public string? GhiChu { get; set; }

        // --- THÊM MỚI: Để biết đơn này của nhân viên nào ---
        public int? IdNhanVien { get; set; }
    }

    public class NguoiGiaoHangDto
    {
        public int IdNguoiGiaoHang { get; set; }
        public string TenNguoiGiaoHang { get; set; } = string.Empty;
    }

    public class GiaoHangUpdateRequestDto
    {
        public string? TrangThaiGiaoHang { get; set; }
        public int? IdNguoiGiaoHang { get; set; }

        // --- THÊM MỚI: Để lưu ID Shipper ---
        public int? IdNhanVien { get; set; }

        [JsonIgnore]
        public IFormFile? HinhAnhXacNhan { get; set; }
    }

    /// <summary>
    /// DTO thống kê lịch sử chạy đơn trong ngày của Shipper
    /// </summary>
    public class ShipperHistorySummaryDto
    {
        public decimal TongTienMatCam { get; set; } // Chỉ tính đơn COD
        public int TongDonHoanThanh { get; set; }
        public int TongDonHuy { get; set; }
        public List<GiaoHangItemDto> LichSuDonHang { get; set; } = new List<GiaoHangItemDto>();
    }
}
================================================================================

E:\Tai Lieu Hoc Tap\CS 445 AM\Project\CafebookModel\Model\ModelWeb\QuanLy\GoiMonViewDto.cs
================================================================================
﻿// Tập tin: CafebookModel/Model/ModelWeb/QuanLy/GoiMonViewDto.cs
using System;
using System.Collections.Generic;

namespace CafebookModel.Model.ModelWeb.QuanLy
{
    // DTO chính chứa toàn bộ dữ liệu cho trang GoiMonView
    public class GoiMonViewDto
    {
        public HoaDonInfoDto HoaDonInfo { get; set; } = default!;
        public List<ChiTietDto> ChiTietItems { get; set; } = default!;
        public List<SanPhamDto> SanPhams { get; set; } = default!;
        public List<DanhMucDto> DanhMucs { get; set; } = default!;
        public List<KhuyenMaiDto> KhuyenMais { get; set; } = default!;
    }

    // Thông tin cơ bản của hóa đơn
    public class HoaDonInfoDto
    {
        public int IdHoaDon { get; set; }
        public string SoBan { get; set; } = default!;
        public string LoaiHoaDon { get; set; } = default!;
        public decimal TongTienGoc { get; set; }
        public decimal GiamGia { get; set; }
        public decimal ThanhTien { get; set; }
        public int? IdKhuyenMai { get; set; }
    }

    // DTO cho một dòng trong danh sách chi tiết
    public class ChiTietDto
    {
        public int IdChiTietHoaDon { get; set; }
        public int IdSanPham { get; set; }
        public string TenSanPham { get; set; } = default!;
        public int SoLuong { get; set; }
        public decimal DonGia { get; set; }
        public decimal ThanhTien { get; set; }
        public string? GhiChu { get; set; }
    }

    // DTO cho một thẻ Sản Phẩm
    public class SanPhamDto
    {
        public int IdSanPham { get; set; }
        public string TenSanPham { get; set; } = default!;
        public decimal DonGia { get; set; }
        public string HinhAnh { get; set; } = default!;
        public int IdDanhMuc { get; set; }
    }

    // DTO cho Danh Mục (Sidebar trái)
    public class DanhMucDto
    {
        public int IdDanhMuc { get; set; }
        public string TenLoaiSP { get; set; } = default!;
    }

    // DTO cho ComboBox Khuyến mãi
    public class KhuyenMaiDto
    {
        public int IdKhuyenMai { get; set; }
        public string TenKhuyenMai { get; set; } = default!;
        public string LoaiGiamGia { get; set; } = default!;
        public decimal GiaTriGiam { get; set; }
    }

    // === CÁC DTO DÙNG ĐỂ GỬI YÊU CẦU LÊN API ===

    public class AddItemRequest
    {
        public int IdHoaDon { get; set; }
        public int IdSanPham { get; set; }
        public int SoLuong { get; set; }
        public string? GhiChu { get; set; }
    }

    public class UpdateSoLuongRequest
    {
        public int IdChiTietHoaDon { get; set; }
        public int SoLuongMoi { get; set; }
    }

    public class ApplyPromotionRequest
    {
        public int IdHoaDon { get; set; }
        public int? IdKhuyenMai { get; set; }
    }

    // DTO trả về khi thêm món
    public class AddItemResponseDto
    {
        public HoaDonInfoDto updatedHoaDonInfo { get; set; } = default!;
        public ChiTietDto newItem { get; set; } = default!;
    }
}
================================================================================

E:\Tai Lieu Hoc Tap\CS 445 AM\Project\CafebookModel\Model\ModelWeb\QuanLy\HoTroKhachHangDto.cs
================================================================================
﻿// Tập tin: CafebookModel/Model/ModelWeb/QuanLy/HoTroKhachHangDto.cs
using CafebookModel.Model.ModelWeb; // Để tái sử dụng ChatMessageDto
using System;
using System.Collections.Generic;

namespace CafebookModel.Model.ModelWeb.QuanLy
{
    /// <summary>
    /// DTO cho danh sách phiếu hỗ trợ (dùng cho trang dashboard của nhân viên)
    /// </summary>
    public class HoTroKhachHangListDto
    {
        public int IdThongBao { get; set; }
        public string TenKhachHang { get; set; } = string.Empty; // Sẽ là "Khách vãng lai (GuestId)" nếu chưa đăng nhập
        public string? NoiDungYeuCau { get; set; }
        public DateTime ThoiGianTao { get; set; }
        public string TrangThai { get; set; } = string.Empty;
        public string? GhiChuTuAI { get; set; }
    }

    /// <summary>
    /// DTO chi tiết cho một phiếu hỗ trợ (dùng cho trang trả lời)
    /// </summary>
    public class HoTroKhachHangDetailDto
    {
        public int IdThongBao { get; set; }
        public string TenKhachHang { get; set; } = string.Empty;
        public int? IdKhachHang { get; set; }
        public string? GuestSessionId { get; set; }
        public string? NoiDungYeuCau { get; set; }
        public DateTime ThoiGianTao { get; set; }
        public string TrangThai { get; set; } = string.Empty;
        public string? GhiChuTuAI { get; set; }

        // Tái sử dụng DTO từ HoTroDto.cs
        public List<ChatMessageDto> LichSuChat { get; set; } = new List<ChatMessageDto>();
    }

    /// <summary>
    /// DTO khi nhân viên gửi phản hồi
    /// </summary>
    public class HoTroKhachHangReplyDto
    {
        public int IdThongBao { get; set; }
        public string NoiDungTraLoi { get; set; } = string.Empty;
    }
}
================================================================================

E:\Tai Lieu Hoc Tap\CS 445 AM\Project\CafebookModel\Model\ModelWeb\QuanLy\SoDoBanDto.cs
================================================================================
﻿// Tập tin: CafebookModel/Model/ModelWeb/QuanLy/SoDoBanDto.cs
using System.Collections.Generic;

namespace CafebookModel.Model.ModelWeb.QuanLy
{
    /// <summary>
    /// DTO cho một Bàn (hiển thị trên lưới)
    /// </summary>
    public class BanDto
    {
        public int IdBan { get; set; }
        public string SoBan { get; set; } = string.Empty;
        public string TrangThai { get; set; } = string.Empty;
        public string? GhiChu { get; set; }
        public int IdKhuVuc { get; set; }
        public decimal TongTien { get; set; }

        // --- BỔ SUNG MỚI (Từ logic WPF) ---
        public int? IdHoaDonHienTai { get; set; }
        public string? ThongTinDatBan { get; set; }
    }

    /// <summary>
    /// DTO cho một Khu Vực (hiển thị trên tab)
    /// </summary>
    public class KhuVucDto
    {
        public int IdKhuVuc { get; set; }
        public string TenKhuVuc { get; set; } = string.Empty;
        public List<BanDto> Bans { get; set; } = new();
    }

    // --- BỔ SUNG MỚI (DTO cho các hành động) ---

    /// <summary>
    /// DTO để tạo Hóa đơn / Mở bàn
    /// </summary>
    public class CreateOrderRequestDto
    {
        public int IdBan { get; set; }
        public int IdNhanVien { get; set; }
    }

    /// <summary>
    /// DTO trả về ID hóa đơn vừa tạo
    /// </summary>
    public class CreateOrderResponseDto
    {
        public int IdHoaDon { get; set; }
    }

    /// <summary>
    /// DTO để báo cáo sự cố
    /// </summary>
    public class ReportProblemRequestDto
    {
        public int IdBan { get; set; }
        public int IdNhanVien { get; set; }
        public string GhiChu { get; set; } = string.Empty;
    }

    /// <summary>
    /// DTO để Chuyển bàn hoặc Gộp bàn
    /// </summary>
    public class BanActionRequestDto
    {
        public int IdHoaDonNguon { get; set; }
        public int IdBanDich { get; set; } // Dùng cho Chuyển Bàn
        public int? IdHoaDonDich { get; set; } // Dùng cho Gộp Bàn
    }
}
================================================================================

E:\Tai Lieu Hoc Tap\CS 445 AM\Project\CafebookModel\Utils\HinhAnhPaths.cs
================================================================================
﻿// Tập tin: CafebookModel/Utils/HinhAnhPaths.cs
using System.IO; // Thêm

namespace CafebookModel.Utils
{
    public static class HinhAnhPaths
    {
        // --- WPF Pack URIs (Defaults/Fallbacks) ---
        public const string DefaultAvatar = "/Assets/Images/default-avatar.png";
        public const string DefaultBookCover = "/Assets/Images/default-book-cover.png";
        public const string DefaultFoodIcon = "/Assets/Images/default-food-icon.png";

        // --- Server Relative URL Paths (Dùng /) ---
        public const string UrlAvatarNV = "/images/avatars/avatarNV";
        public const string UrlAvatarKH = "/images/avatars/avatarKH";
        public const string UrlBooks = "/images/books";
        public const string UrlFoods = "/images/foods";
    }
}
================================================================================

E:\Tai Lieu Hoc Tap\CS 445 AM\Project\CafebookModel\Utils\SlugifyUtil.cs
================================================================================
﻿// Tập tin: CafebookModel/Utils/SlugifyUtil.cs
using System.Globalization;
using System.Text;
using System.Text.RegularExpressions;

namespace CafebookModel.Utils
{
    public static class SlugifyUtil
    {
        // Hàm này sẽ chuyển "Cà Phê Sữa Đá" -> "ca-phe-sua-da"
        public static string GenerateSlug(this string phrase)
        {
            if (string.IsNullOrEmpty(phrase)) return "file";

            // 1. Chuyển đổi ký tự có dấu thành không dấu
            string str = phrase.ToLower().Trim();
            str = str.RemoveDiacritics();

            // 2. Thay thế khoảng trắng và ký tự đặc biệt
            str = Regex.Replace(str, @"[^a-z0-9\s-]", ""); // Xóa ký tự lạ
            str = Regex.Replace(str, @"\s+", "-"); // Thay khoảng trắng bằng -
            str = Regex.Replace(str, @"-+", "-"); // Gộp nhiều dấu -
            str = str.Trim('-');

            if (string.IsNullOrEmpty(str)) return "file";

            return str;
        }

        // Hàm helper để bỏ dấu tiếng Việt
        private static string RemoveDiacritics(this string text)
        {
            var normalizedString = text.Normalize(NormalizationForm.FormD);
            var stringBuilder = new StringBuilder();

            foreach (var c in normalizedString)
            {
                var unicodeCategory = CharUnicodeInfo.GetUnicodeCategory(c);
                if (unicodeCategory != UnicodeCategory.NonSpacingMark)
                {
                    stringBuilder.Append(c);
                }
            }
            return stringBuilder.ToString().Normalize(NormalizationForm.FormC);
        }
    }
}
================================================================================

